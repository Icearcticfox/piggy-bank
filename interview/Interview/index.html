
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../devops/clouds/Basic%20questions/">
      
      
        <link rel="next" href="../Troubleshooting%20Guide/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Interview - Piggy bank</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Piggy bank" class="md-header__button md-logo" aria-label="Piggy bank" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Piggy bank
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Interview
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Piggy bank" class="md-nav__button md-logo" aria-label="Piggy bank" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Piggy bank
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Welcome to Piggy bank
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Devops
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Devops
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/Ansible/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ansible
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Gitlab
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Gitlab
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/Gitlab/Artifacts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Artifacts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/Gitlab/Runners/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Runners
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/Gitlab/Security%20In%20CI-CD/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Security In CI CD
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Kubernetes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Kubernetes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/Kubernetes/Autoscailing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Autoscailing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/Kubernetes/Security/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Security
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Terraform
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Terraform
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/Terraform/Terraform%20state/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Terraform state
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/Terraform/Workspace/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Workspace
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Clouds
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            Clouds
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/clouds/Basic%20questions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Basic questions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Interview
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Interview
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Interview
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Interview
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      Общее
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Общее">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      У вас есть компьютер. Вы нажали на кнопку включения. Расскажите максимально подробно, что происходит, до загрузки ОС.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linux-curl-wwwtinkoffru-" class="md-nav__link">
    <span class="md-ellipsis">
      Открыли linux консоль, ввели curl www.tinkoff.ru - нажали энтер. Что происходит, максимально подробно.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      Зачем маска подсети на клиентском компьютере
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#loadaverage" class="md-nav__link">
    <span class="md-ellipsis">
      Что такое LoadAverage?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linux" class="md-nav__link">
    <span class="md-ellipsis">
      Упрощенная модель состояний процесса в Linux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      Кто и при каких условиях может менять группу у файла?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Кто и при каких условиях может менять группу у файла?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      Пример:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      Свободное место #1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      Свободное место #2
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Свободное место #2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#inodes" class="md-nav__link">
    <span class="md-ellipsis">
      Пояснение: файловые дескрипторы и inodes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      Гипервизор
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      Как работает контейнеризация и чем отличается от виртуализации?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#linux_1" class="md-nav__link">
    <span class="md-ellipsis">
      Linux
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Linux">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      Виды памяти
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Виды памяти">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      Основные термины
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      💡 Как использовать это на практике:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#namespaces-and-cgroups" class="md-nav__link">
    <span class="md-ellipsis">
      Namespaces and Cgroups
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Namespaces and Cgroups">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#linux-namespaces" class="md-nav__link">
    <span class="md-ellipsis">
      🧱 Что такое Linux namespaces?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🧱 Что такое Linux namespaces?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#namespace" class="md-nav__link">
    <span class="md-ellipsis">
      📦 Основные типы namespace
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linux-cgroups" class="md-nav__link">
    <span class="md-ellipsis">
      🔒 Что такое Linux cgroups?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      📦 Как работают вместе
    </span>
  </a>
  
    <nav class="md-nav" aria-label="📦 Как работают вместе">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#docker" class="md-nav__link">
    <span class="md-ellipsis">
      🐳 Пример: как работает Docker контейнер под капотом
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      ✅ Сравнение:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bash-0-1" class="md-nav__link">
    <span class="md-ellipsis">
      Bash переменные $?, $0, $1, $@, $\$
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Bash переменные $?, $0, $1, $@, $\$">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      $\$
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#special-variables-short" class="md-nav__link">
    <span class="md-ellipsis">
      Special variables short
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zombie" class="md-nav__link">
    <span class="md-ellipsis">
      Что такое zombie процесс и чем это плохо, как его убить?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      Чем опасно хранение большого количества маленьких файлов на файловой системе?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#git" class="md-nav__link">
    <span class="md-ellipsis">
      GIT
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GIT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      Как внести изменения в последний коммит?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      Как добавить забытые файлы в последний коммит?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#git-revert-git-reset" class="md-nav__link">
    <span class="md-ellipsis">
      Чем отличается git revert от git reset?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      Сеть
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Сеть">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#osi" class="md-nav__link">
    <span class="md-ellipsis">
      OSI
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#l4l7-lb" class="md-nav__link">
    <span class="md-ellipsis">
      L4/L7 LB
    </span>
  </a>
  
    <nav class="md-nav" aria-label="L4/L7 LB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#l4-" class="md-nav__link">
    <span class="md-ellipsis">
      ✅ L4-балансировка (транспортный уровень)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#l7-" class="md-nav__link">
    <span class="md-ellipsis">
      ✅ L7-балансировка (прикладной уровень)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#l3-" class="md-nav__link">
    <span class="md-ellipsis">
      ✅ L3-балансировка (сетевой уровень)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#l2-" class="md-nav__link">
    <span class="md-ellipsis">
      ✅ L2-балансировка (канальный уровень)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      🧠 Сравнение коротко
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kubernetes" class="md-nav__link">
    <span class="md-ellipsis">
      🧪 В Kubernetes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🧪 В Kubernetes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    <span class="md-ellipsis">
      🧭 Кратко: как трафик проходит от клиента к приложению
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    <span class="md-ellipsis">
      🧪 Пример трафика:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#service-mesh-istio" class="md-nav__link">
    <span class="md-ellipsis">
      🤓 А если Service Mesh (например, Istio)?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    <span class="md-ellipsis">
      🧠 Резюме
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tcp-vs-udp" class="md-nav__link">
    <span class="md-ellipsis">
      TCP vs UDP. Разница
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tcp-handshake" class="md-nav__link">
    <span class="md-ellipsis">
      Как происходит TCP-handshake?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#https" class="md-nav__link">
    <span class="md-ellipsis">
      Как работают сертификаты? Как подтверждается соединение? (https соединение)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ssl-" class="md-nav__link">
    <span class="md-ellipsis">
      Опиши принцип работы ssl-шифрования
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    <span class="md-ellipsis">
      Симметричное шифрование
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Симметричное шифрование">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    <span class="md-ellipsis">
      Как работает?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    <span class="md-ellipsis">
      Примеры алгоритмов:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_25" class="md-nav__link">
    <span class="md-ellipsis">
      Плюсы
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_26" class="md-nav__link">
    <span class="md-ellipsis">
      Минусы
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_27" class="md-nav__link">
    <span class="md-ellipsis">
      Асимметричное шифрование
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Асимметричное шифрование">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_28" class="md-nav__link">
    <span class="md-ellipsis">
      Как работает?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_29" class="md-nav__link">
    <span class="md-ellipsis">
      Примеры алгоритмов:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_30" class="md-nav__link">
    <span class="md-ellipsis">
      Плюсы
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_31" class="md-nav__link">
    <span class="md-ellipsis">
      Минусы
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_32" class="md-nav__link">
    <span class="md-ellipsis">
      Основные отличия
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_33" class="md-nav__link">
    <span class="md-ellipsis">
      Вывод
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_34" class="md-nav__link">
    <span class="md-ellipsis">
      Что такое таблица маршрутизации?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iptables-snat-dnat" class="md-nav__link">
    <span class="md-ellipsis">
      IPTables: SNAT, DNAT, Маскарадинг
    </span>
  </a>
  
    <nav class="md-nav" aria-label="IPTables: SNAT, DNAT, Маскарадинг">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-filter-table" class="md-nav__link">
    <span class="md-ellipsis">
      1. Filter Table
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-nat-table" class="md-nav__link">
    <span class="md-ellipsis">
      2. NAT Table
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-mangle-table" class="md-nav__link">
    <span class="md-ellipsis">
      3. Mangle Table
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-raw-table" class="md-nav__link">
    <span class="md-ellipsis">
      4. Raw Table
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iptables" class="md-nav__link">
    <span class="md-ellipsis">
      Цепочки IPTables:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1012153522" class="md-nav__link">
    <span class="md-ellipsis">
      Что означает запись 10.12.15.35/22?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dns" class="md-nav__link">
    <span class="md-ellipsis">
      DNS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DNS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_35" class="md-nav__link">
    <span class="md-ellipsis">
      Рекурсивный и не рекурсивный запрос
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_36" class="md-nav__link">
    <span class="md-ellipsis">
      Сетевые утилиты
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Сетевые утилиты">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_37" class="md-nav__link">
    <span class="md-ellipsis">
      Проверка открытых портов и сокетов
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_38" class="md-nav__link">
    <span class="md-ellipsis">
      Проверка сетевых интерфейсов
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_39" class="md-nav__link">
    <span class="md-ellipsis">
      Проверка маршрутов
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#netcat-nc" class="md-nav__link">
    <span class="md-ellipsis">
      NetCat (nc)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nmap" class="md-nav__link">
    <span class="md-ellipsis">
      Nmap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tcpdump" class="md-nav__link">
    <span class="md-ellipsis">
      Tcpdump
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#docker_1" class="md-nav__link">
    <span class="md-ellipsis">
      Docker
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Docker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#docker-docker" class="md-nav__link">
    <span class="md-ellipsis">
      Как внутри Docker понять что ты в Docker?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Как внутри Docker понять что ты в Docker?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-dockerenv" class="md-nav__link">
    <span class="md-ellipsis">
      1. Проверка файла /.dockerenv
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-cgroup" class="md-nav__link">
    <span class="md-ellipsis">
      2. Чтение cgroup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-hostname" class="md-nav__link">
    <span class="md-ellipsis">
      3. Проверка hostname
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-cgroups" class="md-nav__link">
    <span class="md-ellipsis">
      ⚠️ 4. Проверка ограничений cgroups
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_40" class="md-nav__link">
    <span class="md-ellipsis">
      🧠 Какой способ лучше?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmd-entrypoint" class="md-nav__link">
    <span class="md-ellipsis">
      В чем отличие CMD и ENTRYPOINT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker_2" class="md-nav__link">
    <span class="md-ellipsis">
      Что такое Docker? Как он устроен? На каких технологиях основывается?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker_3" class="md-nav__link">
    <span class="md-ellipsis">
      Пространства имён, используемые Docker:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker-vmware" class="md-nav__link">
    <span class="md-ellipsis">
      Разница между Docker и VMware
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker_4" class="md-nav__link">
    <span class="md-ellipsis">
      Зачем нужен Docker? Какие проблемы решает?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dockerfile" class="md-nav__link">
    <span class="md-ellipsis">
      Основные директивы Dockerfile
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dockerfile-docker-compose" class="md-nav__link">
    <span class="md-ellipsis">
      Разница между Dockerfile и docker-compose
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker-image-registry" class="md-nav__link">
    <span class="md-ellipsis">
      Как перенести docker image с одной машины на другую без registry?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#best-practices-dockerfile" class="md-nav__link">
    <span class="md-ellipsis">
      Best practices по написанию Dockerfile и безопасности контейнеров
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker_5" class="md-nav__link">
    <span class="md-ellipsis">
      Сетевые драйверы Docker
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arg-env" class="md-nav__link">
    <span class="md-ellipsis">
      В чем отличие ARG от ENV?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker_6" class="md-nav__link">
    <span class="md-ellipsis">
      🧱 Как работают слои в Docker
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🧱 Как работают слои в Docker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_41" class="md-nav__link">
    <span class="md-ellipsis">
      🧠 Почему это важно на собеседовании
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bash" class="md-nav__link">
    <span class="md-ellipsis">
      Bash
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Bash">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#access-csv-timestamp-status-url-user-agent" class="md-nav__link">
    <span class="md-ellipsis">
      Обработка access логов (CSV): timestamp, status, url, user-agent
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Обработка access логов (CSV): timestamp, status, url, user-agent">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#url" class="md-nav__link">
    <span class="md-ellipsis">
      Количество уникальных URL:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#url_1" class="md-nav__link">
    <span class="md-ellipsis">
      Количество запросов на каждый URL:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#400-404-url" class="md-nav__link">
    <span class="md-ellipsis">
      Количество 400-404 по каждому URL:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-eu-o-pipefail" class="md-nav__link">
    <span class="md-ellipsis">
      Что делает set -eu -o pipefail?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#50" class="md-nav__link">
    <span class="md-ellipsis">
      Как выполнить одну и ту же команду на 50 серверах?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_42" class="md-nav__link">
    <span class="md-ellipsis">
      Балансировщики нагрузки
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Балансировщики нагрузки">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_43" class="md-nav__link">
    <span class="md-ellipsis">
      Зачем нужны?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nginx" class="md-nav__link">
    <span class="md-ellipsis">
      Nginx
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Nginx">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#-" class="md-nav__link">
    <span class="md-ellipsis">
      Ошибки по статус-кодам
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#http-" class="md-nav__link">
    <span class="md-ellipsis">
      HTTP-методы, изменяющие состояние
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nginx-c10k" class="md-nav__link">
    <span class="md-ellipsis">
      Как Nginx решает проблему C10K?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_44" class="md-nav__link">
    <span class="md-ellipsis">
      Важные параметры
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#location" class="md-nav__link">
    <span class="md-ellipsis">
      Как выбирается location?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#location_1" class="md-nav__link">
    <span class="md-ellipsis">
      Как дебажить location?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_45" class="md-nav__link">
    <span class="md-ellipsis">
      Что реально приходит на приложение?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nginx-apache" class="md-nav__link">
    <span class="md-ellipsis">
      Преимущества Nginx перед Apache
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_46" class="md-nav__link">
    <span class="md-ellipsis">
      Могут ли работать вместе?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#haproxy" class="md-nav__link">
    <span class="md-ellipsis">
      HAProxy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#envoy" class="md-nav__link">
    <span class="md-ellipsis">
      Envoy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#google-cloud-load-balancer" class="md-nav__link">
    <span class="md-ellipsis">
      Google Cloud Load Balancer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aws-load-balancers" class="md-nav__link">
    <span class="md-ellipsis">
      AWS Load Balancers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AWS Load Balancers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#classic-load-balancer-clb" class="md-nav__link">
    <span class="md-ellipsis">
      Classic Load Balancer (CLB)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#application-load-balancer-alb" class="md-nav__link">
    <span class="md-ellipsis">
      Application Load Balancer (ALB)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network-load-balancer-nlb" class="md-nav__link">
    <span class="md-ellipsis">
      Network Load Balancer (NLB)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vs-" class="md-nav__link">
    <span class="md-ellipsis">
      Прокси vs Реверс-прокси
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Прокси vs Реверс-прокси">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#forward-proxy" class="md-nav__link">
    <span class="md-ellipsis">
      Что такое прокси (forward proxy)?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-reverse-proxy" class="md-nav__link">
    <span class="md-ellipsis">
      Что такое реверс-прокси (reverse proxy)?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_47" class="md-nav__link">
    <span class="md-ellipsis">
      Сравнение
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Architecture
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kubectl-apply" class="md-nav__link">
    <span class="md-ellipsis">
      Что происходит при kubectl apply
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qos-pod-quality-of-service-classes" class="md-nav__link">
    <span class="md-ellipsis">
      QOS (Pod Quality of Service Classes)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="QOS (Pod Quality of Service Classes)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-guaranteed" class="md-nav__link">
    <span class="md-ellipsis">
      1. Guaranteed
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-burstable" class="md-nav__link">
    <span class="md-ellipsis">
      2. Burstable
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-besteffort" class="md-nav__link">
    <span class="md-ellipsis">
      3. BestEffort
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kubernetes-tolerations-affinity-labels-pod" class="md-nav__link">
    <span class="md-ellipsis">
      Управление шедулингом в Kubernetes: Tolerations, Affinity, Labels и назначение Pod'ов на ноды
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Управление шедулингом в Kubernetes: Tolerations, Affinity, Labels и назначение Pod&#39;ов на ноды">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-labels" class="md-nav__link">
    <span class="md-ellipsis">
      1. Labels (лейблы)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-taints-tolerations" class="md-nav__link">
    <span class="md-ellipsis">
      2. Taints и Tolerations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-node-affinity" class="md-nav__link">
    <span class="md-ellipsis">
      3. Node Affinity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-pod-affinity-anti-affinity" class="md-nav__link">
    <span class="md-ellipsis">
      4. Pod Affinity / Anti-Affinity
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Pod Affinity / Anti-Affinity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pod-affinity" class="md-nav__link">
    <span class="md-ellipsis">
      Pod Affinity (соседство):
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pod-anti-affinity" class="md-nav__link">
    <span class="md-ellipsis">
      Pod Anti-Affinity (разделение):
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pod-lifecycle" class="md-nav__link">
    <span class="md-ellipsis">
      Pod Lifecycle
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Pod Lifecycle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pod-" class="md-nav__link">
    <span class="md-ellipsis">
      🚦 Жизненный цикл Pod-а
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🚦 Жизненный цикл Pod-а">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#podphase" class="md-nav__link">
    <span class="md-ellipsis">
      📌 Основные состояния (PodPhase):
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#containerstate" class="md-nav__link">
    <span class="md-ellipsis">
      📌 Состояния контейнеров (ContainerState)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restart-policy" class="md-nav__link">
    <span class="md-ellipsis">
      🔁 Restart Policy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#termination-grace-period" class="md-nav__link">
    <span class="md-ellipsis">
      ⏱ Termination Grace Period
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prestop-finalizer" class="md-nav__link">
    <span class="md-ellipsis">
      preStop &amp;&amp; finalizer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="preStop &amp;&amp; finalizer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_48" class="md-nav__link">
    <span class="md-ellipsis">
      🔍 Примеры сценариев
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#probes" class="md-nav__link">
    <span class="md-ellipsis">
      🩺 Probes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🩺 Probes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-livenessprobe" class="md-nav__link">
    <span class="md-ellipsis">
      🔍 1. livenessProbe
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-readinessprobe" class="md-nav__link">
    <span class="md-ellipsis">
      🕒 2. readinessProbe
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-startupprobe" class="md-nav__link">
    <span class="md-ellipsis">
      🐢 3. startupProbe
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#initcontainers" class="md-nav__link">
    <span class="md-ellipsis">
      InitContainers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#service-mesh" class="md-nav__link">
    <span class="md-ellipsis">
      Service Mesh
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Service Mesh">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_49" class="md-nav__link">
    <span class="md-ellipsis">
      🔧 Как работает?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#service-mesh_1" class="md-nav__link">
    <span class="md-ellipsis">
      🛠 Примеры популярных Service Mesh
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🛠 Примеры популярных Service Mesh">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#istio-" class="md-nav__link">
    <span class="md-ellipsis">
      Istio (де-факто стандарт, мощный, но тяжеловат)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mtls" class="md-nav__link">
    <span class="md-ellipsis">
      🔐 MTLS — всё шифруется автоматически
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#observability" class="md-nav__link">
    <span class="md-ellipsis">
      📊 Observability из коробки
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#service" class="md-nav__link">
    <span class="md-ellipsis">
      🔧 Service
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🔧 Service">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#clusterip" class="md-nav__link">
    <span class="md-ellipsis">
      🧱 ClusterIP (по умолчанию)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nodeport" class="md-nav__link">
    <span class="md-ellipsis">
      🌐 NodePort
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#loadbalancer" class="md-nav__link">
    <span class="md-ellipsis">
      🌎 LoadBalancer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#externalname" class="md-nav__link">
    <span class="md-ellipsis">
      🔗 ExternalName
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#headless-service" class="md-nav__link">
    <span class="md-ellipsis">
      🧪 Headless Service
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_50" class="md-nav__link">
    <span class="md-ellipsis">
      🔧 Дополнительные сценарии
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#istio-virtualservice" class="md-nav__link">
    <span class="md-ellipsis">
      🕹 Istio VirtualService
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ingress" class="md-nav__link">
    <span class="md-ellipsis">
      Ingress
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ingress">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ingress-controller" class="md-nav__link">
    <span class="md-ellipsis">
      🎮 Ingress Controller — что это?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ingress_1" class="md-nav__link">
    <span class="md-ellipsis">
      📌 Что делает Ingress:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ingress-controller_1" class="md-nav__link">
    <span class="md-ellipsis">
      📌 Что делает Ingress Controller:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_51" class="md-nav__link">
    <span class="md-ellipsis">
      🧠 Кратко:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#replicaset" class="md-nav__link">
    <span class="md-ellipsis">
      ReplicaSet (низкоуровневый)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deployment-stateless" class="md-nav__link">
    <span class="md-ellipsis">
      Deployment (стандарт для stateless приложений)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#daemonset" class="md-nav__link">
    <span class="md-ellipsis">
      DaemonSet
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#statefulset" class="md-nav__link">
    <span class="md-ellipsis">
      StatefulSet
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#job" class="md-nav__link">
    <span class="md-ellipsis">
      Job
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cronjob" class="md-nav__link">
    <span class="md-ellipsis">
      CronJob
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pod-controllers-comparation" class="md-nav__link">
    <span class="md-ellipsis">
      Pod controllers comparation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pvc" class="md-nav__link">
    <span class="md-ellipsis">
      PVC
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gitops-vs-helm" class="md-nav__link">
    <span class="md-ellipsis">
      GitOps vs Helm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rbac" class="md-nav__link">
    <span class="md-ellipsis">
      RBAC
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RBAC">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_52" class="md-nav__link">
    <span class="md-ellipsis">
      🧱 Основные сущности
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🧱 Основные сущности">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-role-rolebinding" class="md-nav__link">
    <span class="md-ellipsis">
      📌 Пример 1: Простой Role и RoleBinding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-clusterrole-clusterrolebinding" class="md-nav__link">
    <span class="md-ellipsis">
      📌 Пример 2: ClusterRole + ClusterRoleBinding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rules" class="md-nav__link">
    <span class="md-ellipsis">
      🧠 Что можно указывать в rules?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rbac-" class="md-nav__link">
    <span class="md-ellipsis">
      ⚠️ RBAC и сервис-аккаунты
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_53" class="md-nav__link">
    <span class="md-ellipsis">
      🎯 Частые паттерны:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🎯 Частые паттерны:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-view-edit-admin" class="md-nav__link">
    <span class="md-ellipsis">
      🔐 1. Предустановленные роли: view, edit, admin
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-least-privilege" class="md-nav__link">
    <span class="md-ellipsis">
      🧃 2. Least Privilege (минимально необходимые права)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-serviceaccount-rolebinding-pod" class="md-nav__link">
    <span class="md-ellipsis">
      🧬 3. ServiceAccount + RoleBinding: доступ только Pod’ам
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-aggregated-clusterroles" class="md-nav__link">
    <span class="md-ellipsis">
      🧩 4. Aggregated ClusterRoles — комбинация нескольких
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-dynamic-access-gitops" class="md-nav__link">
    <span class="md-ellipsis">
      🧪 5. Dynamic access (например, через GitOps)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-namespace-rbac" class="md-nav__link">
    <span class="md-ellipsis">
      📁 6. Мульти-Namespace RBAC
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_54" class="md-nav__link">
    <span class="md-ellipsis">
      🧠 Финальные советы:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#terraform" class="md-nav__link">
    <span class="md-ellipsis">
      Terraform
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Terraform">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ansible-terraform" class="md-nav__link">
    <span class="md-ellipsis">
      Отличие ansible и terraform
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Отличие ansible и terraform">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#terraform-state" class="md-nav__link">
    <span class="md-ellipsis">
      Что такое Terraform state?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#terraform_1" class="md-nav__link">
    <span class="md-ellipsis">
      Что такое провайдер в terraform
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#terraform_2" class="md-nav__link">
    <span class="md-ellipsis">
      Что такое ресурс в terraform
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ansible" class="md-nav__link">
    <span class="md-ellipsis">
      Ansible
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ansible">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ansible_1" class="md-nav__link">
    <span class="md-ellipsis">
      Основные примитивы Ansible
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Основные примитивы Ansible">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#inventory" class="md-nav__link">
    <span class="md-ellipsis">
      Инвентарь (Inventory)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task" class="md-nav__link">
    <span class="md-ellipsis">
      Задание (Task)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#play-playbook" class="md-nav__link">
    <span class="md-ellipsis">
      Сценарий (Play или Плейбук (Playbook)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#role" class="md-nav__link">
    <span class="md-ellipsis">
      Роль (Role)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#facts" class="md-nav__link">
    <span class="md-ellipsis">
      Факты (Facts)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ansible_2" class="md-nav__link">
    <span class="md-ellipsis">
      Порядок приоритета переменных в Ansible
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Порядок приоритета переменных в Ansible">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_55" class="md-nav__link">
    <span class="md-ellipsis">
      📊 Порядок от низшего к высшему:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_56" class="md-nav__link">
    <span class="md-ellipsis">
      🧩 Примеры по уровням
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🧩 Примеры по уровням">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-defaults" class="md-nav__link">
    <span class="md-ellipsis">
      1. defaults в ролях (самый низкий приоритет)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_1" class="md-nav__link">
    <span class="md-ellipsis">
      2. Инвентарь
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-group_vars-host_vars" class="md-nav__link">
    <span class="md-ellipsis">
      3. group_vars/ и host_vars/
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-ansible_facts-set_fact" class="md-nav__link">
    <span class="md-ellipsis">
      4. ansible_facts (в том числе set_fact)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-vars-playbook" class="md-nav__link">
    <span class="md-ellipsis">
      5. vars в playbook
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-vars-task" class="md-nav__link">
    <span class="md-ellipsis">
      6. vars в task
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-register" class="md-nav__link">
    <span class="md-ellipsis">
      7. register
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-extra-vars" class="md-nav__link">
    <span class="md-ellipsis">
      8. --extra-vars (наивысший приоритет)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_57" class="md-nav__link">
    <span class="md-ellipsis">
      🧠 Заключение
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handlers" class="md-nav__link">
    <span class="md-ellipsis">
      Для чего нужны хендлеры, handlers?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iac-and" class="md-nav__link">
    <span class="md-ellipsis">
      IAC and Идемпотентность
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ad-hoc-ansible" class="md-nav__link">
    <span class="md-ellipsis">
      Для чего нужен ad hoc в ansible?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Troubleshooting%20Guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Troubleshooting Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Questions
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Questions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../questions/Terraform/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Terraform
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../questions/clouds/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Clouds
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../questions/gitlab/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gitlab
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../questions/kubernetes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kubernetes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../questions/linux/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Linux
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../questions/network/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Network
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Programming
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Programming
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../programming/Common/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    🧠 Наследование, инкапсуляция, полиморфизм
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Topics
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Topics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ACID%20and%20BASE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ACID and BASE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Ansible%20vs%20Terraform/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ansible vs Terraform
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/CAP%20and%20PACELC/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CAP and PACELC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Configuring%20a%20Kubernetes%20Cluster/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Configuring a Kubernetes Cluster
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Deploying%20VictoriaMetrics%20in%20Cluster%20Mode%20%28by%20Components%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Deploying VictoriaMetrics in Cluster Mode (by Components)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Docker%20layots/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Docker layots
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Git%20merge%20kinds/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Git merge kinds
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/HTTPv3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HTTPv3
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Hard%20Links%20vs%20Symbolic%20Links/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hard Links vs Symbolic Links
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ICMP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ICMP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Inode%20and%20Descriptors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Inode and Descriptors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Kube%20cluster%20architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kube cluster architecture
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Linux%20Namespaces%20and%20Cgroups/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Linux Namespaces and Cgroups
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/OIDC%20vs%20OAuth/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OIDC vs OAuth
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Redis%20vs%20RabbitMQ%20vs%20Kafka/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Redis vs RabbitMQ vs Kafka
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Sticky%20bit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sticky bit
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Symmetrical%20and%20assimetrical%20decrypt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Symmetrical and assimetrical decrypt
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Thanos%20vs%20VictoriaMetrics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Thanos vs VictoriaMetrics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/du%20how%20it%20work%3F/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Du how it work?
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/envoy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Envoy
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Utilities
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Utilities
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilities/CheatSheet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CheatSheet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilities/Disk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Disk
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilities/Git/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Git
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilities/Iptables/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Iptables
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilities/Memory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Memory
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilities/Network/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Network
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilities/Text%20files/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Text files
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilities/crontab/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Crontab
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilities/pre-commit-hook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pre commit hook
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilities/psql/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Psql
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilities/rediscli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Rediscli
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilities/shell/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Shell
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_13" >
        
          
          <label class="md-nav__link" for="__nav_6_13" id="__nav_6_13_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Virtualization
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_13">
            <span class="md-nav__icon md-icon"></span>
            Virtualization
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilities/Virtualization/Docker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Docker
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilities/Virtualization/VirtualBox/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    VirtualBox
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_14" >
        
          
          <label class="md-nav__link" for="__nav_6_14" id="__nav_6_14_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Consul
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_14">
            <span class="md-nav__icon md-icon"></span>
            Consul
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilities/consul/KV/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    KV
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_15" >
        
          
          <label class="md-nav__link" for="__nav_6_15" id="__nav_6_15_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    K8s
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_15">
            <span class="md-nav__icon md-icon"></span>
            K8s
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilities/k8s/helm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Helm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilities/k8s/kubectl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kubectl
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilities/k8s/operator-sdk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Operator sdk
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_16" >
        
          
          <label class="md-nav__link" for="__nav_6_16" id="__nav_6_16_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Processes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_16_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_16">
            <span class="md-nav__icon md-icon"></span>
            Processes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilities/processes/lsof/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lsof
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilities/processes/ps/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ps
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilities/processes/sar/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sar
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilities/processes/ss/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ss
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilities/processes/strace/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Strace
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_17" >
        
          
          <label class="md-nav__link" for="__nav_6_17" id="__nav_6_17_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Services
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_17_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_17">
            <span class="md-nav__icon md-icon"></span>
            Services
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilities/services/System%20management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    System management
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilities/services/Systemd%20service/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Systemd service
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilities/services/supervisord/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Managing Processes and Services
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      Общее
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Общее">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      У вас есть компьютер. Вы нажали на кнопку включения. Расскажите максимально подробно, что происходит, до загрузки ОС.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linux-curl-wwwtinkoffru-" class="md-nav__link">
    <span class="md-ellipsis">
      Открыли linux консоль, ввели curl www.tinkoff.ru - нажали энтер. Что происходит, максимально подробно.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      Зачем маска подсети на клиентском компьютере
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#loadaverage" class="md-nav__link">
    <span class="md-ellipsis">
      Что такое LoadAverage?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linux" class="md-nav__link">
    <span class="md-ellipsis">
      Упрощенная модель состояний процесса в Linux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      Кто и при каких условиях может менять группу у файла?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Кто и при каких условиях может менять группу у файла?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      Пример:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      Свободное место #1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      Свободное место #2
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Свободное место #2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#inodes" class="md-nav__link">
    <span class="md-ellipsis">
      Пояснение: файловые дескрипторы и inodes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      Гипервизор
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      Как работает контейнеризация и чем отличается от виртуализации?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#linux_1" class="md-nav__link">
    <span class="md-ellipsis">
      Linux
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Linux">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      Виды памяти
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Виды памяти">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      Основные термины
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      💡 Как использовать это на практике:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#namespaces-and-cgroups" class="md-nav__link">
    <span class="md-ellipsis">
      Namespaces and Cgroups
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Namespaces and Cgroups">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#linux-namespaces" class="md-nav__link">
    <span class="md-ellipsis">
      🧱 Что такое Linux namespaces?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🧱 Что такое Linux namespaces?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#namespace" class="md-nav__link">
    <span class="md-ellipsis">
      📦 Основные типы namespace
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linux-cgroups" class="md-nav__link">
    <span class="md-ellipsis">
      🔒 Что такое Linux cgroups?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      📦 Как работают вместе
    </span>
  </a>
  
    <nav class="md-nav" aria-label="📦 Как работают вместе">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#docker" class="md-nav__link">
    <span class="md-ellipsis">
      🐳 Пример: как работает Docker контейнер под капотом
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      ✅ Сравнение:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bash-0-1" class="md-nav__link">
    <span class="md-ellipsis">
      Bash переменные $?, $0, $1, $@, $\$
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Bash переменные $?, $0, $1, $@, $\$">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      $\$
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#special-variables-short" class="md-nav__link">
    <span class="md-ellipsis">
      Special variables short
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zombie" class="md-nav__link">
    <span class="md-ellipsis">
      Что такое zombie процесс и чем это плохо, как его убить?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      Чем опасно хранение большого количества маленьких файлов на файловой системе?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#git" class="md-nav__link">
    <span class="md-ellipsis">
      GIT
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GIT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      Как внести изменения в последний коммит?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      Как добавить забытые файлы в последний коммит?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#git-revert-git-reset" class="md-nav__link">
    <span class="md-ellipsis">
      Чем отличается git revert от git reset?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      Сеть
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Сеть">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#osi" class="md-nav__link">
    <span class="md-ellipsis">
      OSI
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#l4l7-lb" class="md-nav__link">
    <span class="md-ellipsis">
      L4/L7 LB
    </span>
  </a>
  
    <nav class="md-nav" aria-label="L4/L7 LB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#l4-" class="md-nav__link">
    <span class="md-ellipsis">
      ✅ L4-балансировка (транспортный уровень)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#l7-" class="md-nav__link">
    <span class="md-ellipsis">
      ✅ L7-балансировка (прикладной уровень)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#l3-" class="md-nav__link">
    <span class="md-ellipsis">
      ✅ L3-балансировка (сетевой уровень)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#l2-" class="md-nav__link">
    <span class="md-ellipsis">
      ✅ L2-балансировка (канальный уровень)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      🧠 Сравнение коротко
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kubernetes" class="md-nav__link">
    <span class="md-ellipsis">
      🧪 В Kubernetes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🧪 В Kubernetes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    <span class="md-ellipsis">
      🧭 Кратко: как трафик проходит от клиента к приложению
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    <span class="md-ellipsis">
      🧪 Пример трафика:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#service-mesh-istio" class="md-nav__link">
    <span class="md-ellipsis">
      🤓 А если Service Mesh (например, Istio)?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    <span class="md-ellipsis">
      🧠 Резюме
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tcp-vs-udp" class="md-nav__link">
    <span class="md-ellipsis">
      TCP vs UDP. Разница
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tcp-handshake" class="md-nav__link">
    <span class="md-ellipsis">
      Как происходит TCP-handshake?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#https" class="md-nav__link">
    <span class="md-ellipsis">
      Как работают сертификаты? Как подтверждается соединение? (https соединение)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ssl-" class="md-nav__link">
    <span class="md-ellipsis">
      Опиши принцип работы ssl-шифрования
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    <span class="md-ellipsis">
      Симметричное шифрование
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Симметричное шифрование">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    <span class="md-ellipsis">
      Как работает?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    <span class="md-ellipsis">
      Примеры алгоритмов:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_25" class="md-nav__link">
    <span class="md-ellipsis">
      Плюсы
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_26" class="md-nav__link">
    <span class="md-ellipsis">
      Минусы
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_27" class="md-nav__link">
    <span class="md-ellipsis">
      Асимметричное шифрование
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Асимметричное шифрование">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_28" class="md-nav__link">
    <span class="md-ellipsis">
      Как работает?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_29" class="md-nav__link">
    <span class="md-ellipsis">
      Примеры алгоритмов:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_30" class="md-nav__link">
    <span class="md-ellipsis">
      Плюсы
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_31" class="md-nav__link">
    <span class="md-ellipsis">
      Минусы
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_32" class="md-nav__link">
    <span class="md-ellipsis">
      Основные отличия
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_33" class="md-nav__link">
    <span class="md-ellipsis">
      Вывод
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_34" class="md-nav__link">
    <span class="md-ellipsis">
      Что такое таблица маршрутизации?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iptables-snat-dnat" class="md-nav__link">
    <span class="md-ellipsis">
      IPTables: SNAT, DNAT, Маскарадинг
    </span>
  </a>
  
    <nav class="md-nav" aria-label="IPTables: SNAT, DNAT, Маскарадинг">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-filter-table" class="md-nav__link">
    <span class="md-ellipsis">
      1. Filter Table
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-nat-table" class="md-nav__link">
    <span class="md-ellipsis">
      2. NAT Table
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-mangle-table" class="md-nav__link">
    <span class="md-ellipsis">
      3. Mangle Table
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-raw-table" class="md-nav__link">
    <span class="md-ellipsis">
      4. Raw Table
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iptables" class="md-nav__link">
    <span class="md-ellipsis">
      Цепочки IPTables:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1012153522" class="md-nav__link">
    <span class="md-ellipsis">
      Что означает запись 10.12.15.35/22?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dns" class="md-nav__link">
    <span class="md-ellipsis">
      DNS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DNS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_35" class="md-nav__link">
    <span class="md-ellipsis">
      Рекурсивный и не рекурсивный запрос
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_36" class="md-nav__link">
    <span class="md-ellipsis">
      Сетевые утилиты
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Сетевые утилиты">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_37" class="md-nav__link">
    <span class="md-ellipsis">
      Проверка открытых портов и сокетов
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_38" class="md-nav__link">
    <span class="md-ellipsis">
      Проверка сетевых интерфейсов
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_39" class="md-nav__link">
    <span class="md-ellipsis">
      Проверка маршрутов
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#netcat-nc" class="md-nav__link">
    <span class="md-ellipsis">
      NetCat (nc)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nmap" class="md-nav__link">
    <span class="md-ellipsis">
      Nmap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tcpdump" class="md-nav__link">
    <span class="md-ellipsis">
      Tcpdump
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#docker_1" class="md-nav__link">
    <span class="md-ellipsis">
      Docker
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Docker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#docker-docker" class="md-nav__link">
    <span class="md-ellipsis">
      Как внутри Docker понять что ты в Docker?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Как внутри Docker понять что ты в Docker?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-dockerenv" class="md-nav__link">
    <span class="md-ellipsis">
      1. Проверка файла /.dockerenv
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-cgroup" class="md-nav__link">
    <span class="md-ellipsis">
      2. Чтение cgroup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-hostname" class="md-nav__link">
    <span class="md-ellipsis">
      3. Проверка hostname
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-cgroups" class="md-nav__link">
    <span class="md-ellipsis">
      ⚠️ 4. Проверка ограничений cgroups
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_40" class="md-nav__link">
    <span class="md-ellipsis">
      🧠 Какой способ лучше?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmd-entrypoint" class="md-nav__link">
    <span class="md-ellipsis">
      В чем отличие CMD и ENTRYPOINT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker_2" class="md-nav__link">
    <span class="md-ellipsis">
      Что такое Docker? Как он устроен? На каких технологиях основывается?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker_3" class="md-nav__link">
    <span class="md-ellipsis">
      Пространства имён, используемые Docker:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker-vmware" class="md-nav__link">
    <span class="md-ellipsis">
      Разница между Docker и VMware
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker_4" class="md-nav__link">
    <span class="md-ellipsis">
      Зачем нужен Docker? Какие проблемы решает?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dockerfile" class="md-nav__link">
    <span class="md-ellipsis">
      Основные директивы Dockerfile
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dockerfile-docker-compose" class="md-nav__link">
    <span class="md-ellipsis">
      Разница между Dockerfile и docker-compose
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker-image-registry" class="md-nav__link">
    <span class="md-ellipsis">
      Как перенести docker image с одной машины на другую без registry?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#best-practices-dockerfile" class="md-nav__link">
    <span class="md-ellipsis">
      Best practices по написанию Dockerfile и безопасности контейнеров
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker_5" class="md-nav__link">
    <span class="md-ellipsis">
      Сетевые драйверы Docker
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arg-env" class="md-nav__link">
    <span class="md-ellipsis">
      В чем отличие ARG от ENV?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker_6" class="md-nav__link">
    <span class="md-ellipsis">
      🧱 Как работают слои в Docker
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🧱 Как работают слои в Docker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_41" class="md-nav__link">
    <span class="md-ellipsis">
      🧠 Почему это важно на собеседовании
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bash" class="md-nav__link">
    <span class="md-ellipsis">
      Bash
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Bash">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#access-csv-timestamp-status-url-user-agent" class="md-nav__link">
    <span class="md-ellipsis">
      Обработка access логов (CSV): timestamp, status, url, user-agent
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Обработка access логов (CSV): timestamp, status, url, user-agent">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#url" class="md-nav__link">
    <span class="md-ellipsis">
      Количество уникальных URL:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#url_1" class="md-nav__link">
    <span class="md-ellipsis">
      Количество запросов на каждый URL:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#400-404-url" class="md-nav__link">
    <span class="md-ellipsis">
      Количество 400-404 по каждому URL:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-eu-o-pipefail" class="md-nav__link">
    <span class="md-ellipsis">
      Что делает set -eu -o pipefail?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#50" class="md-nav__link">
    <span class="md-ellipsis">
      Как выполнить одну и ту же команду на 50 серверах?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_42" class="md-nav__link">
    <span class="md-ellipsis">
      Балансировщики нагрузки
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Балансировщики нагрузки">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_43" class="md-nav__link">
    <span class="md-ellipsis">
      Зачем нужны?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nginx" class="md-nav__link">
    <span class="md-ellipsis">
      Nginx
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Nginx">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#-" class="md-nav__link">
    <span class="md-ellipsis">
      Ошибки по статус-кодам
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#http-" class="md-nav__link">
    <span class="md-ellipsis">
      HTTP-методы, изменяющие состояние
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nginx-c10k" class="md-nav__link">
    <span class="md-ellipsis">
      Как Nginx решает проблему C10K?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_44" class="md-nav__link">
    <span class="md-ellipsis">
      Важные параметры
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#location" class="md-nav__link">
    <span class="md-ellipsis">
      Как выбирается location?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#location_1" class="md-nav__link">
    <span class="md-ellipsis">
      Как дебажить location?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_45" class="md-nav__link">
    <span class="md-ellipsis">
      Что реально приходит на приложение?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nginx-apache" class="md-nav__link">
    <span class="md-ellipsis">
      Преимущества Nginx перед Apache
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_46" class="md-nav__link">
    <span class="md-ellipsis">
      Могут ли работать вместе?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#haproxy" class="md-nav__link">
    <span class="md-ellipsis">
      HAProxy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#envoy" class="md-nav__link">
    <span class="md-ellipsis">
      Envoy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#google-cloud-load-balancer" class="md-nav__link">
    <span class="md-ellipsis">
      Google Cloud Load Balancer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aws-load-balancers" class="md-nav__link">
    <span class="md-ellipsis">
      AWS Load Balancers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AWS Load Balancers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#classic-load-balancer-clb" class="md-nav__link">
    <span class="md-ellipsis">
      Classic Load Balancer (CLB)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#application-load-balancer-alb" class="md-nav__link">
    <span class="md-ellipsis">
      Application Load Balancer (ALB)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network-load-balancer-nlb" class="md-nav__link">
    <span class="md-ellipsis">
      Network Load Balancer (NLB)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vs-" class="md-nav__link">
    <span class="md-ellipsis">
      Прокси vs Реверс-прокси
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Прокси vs Реверс-прокси">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#forward-proxy" class="md-nav__link">
    <span class="md-ellipsis">
      Что такое прокси (forward proxy)?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-reverse-proxy" class="md-nav__link">
    <span class="md-ellipsis">
      Что такое реверс-прокси (reverse proxy)?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_47" class="md-nav__link">
    <span class="md-ellipsis">
      Сравнение
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Architecture
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kubectl-apply" class="md-nav__link">
    <span class="md-ellipsis">
      Что происходит при kubectl apply
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qos-pod-quality-of-service-classes" class="md-nav__link">
    <span class="md-ellipsis">
      QOS (Pod Quality of Service Classes)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="QOS (Pod Quality of Service Classes)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-guaranteed" class="md-nav__link">
    <span class="md-ellipsis">
      1. Guaranteed
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-burstable" class="md-nav__link">
    <span class="md-ellipsis">
      2. Burstable
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-besteffort" class="md-nav__link">
    <span class="md-ellipsis">
      3. BestEffort
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kubernetes-tolerations-affinity-labels-pod" class="md-nav__link">
    <span class="md-ellipsis">
      Управление шедулингом в Kubernetes: Tolerations, Affinity, Labels и назначение Pod'ов на ноды
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Управление шедулингом в Kubernetes: Tolerations, Affinity, Labels и назначение Pod&#39;ов на ноды">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-labels" class="md-nav__link">
    <span class="md-ellipsis">
      1. Labels (лейблы)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-taints-tolerations" class="md-nav__link">
    <span class="md-ellipsis">
      2. Taints и Tolerations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-node-affinity" class="md-nav__link">
    <span class="md-ellipsis">
      3. Node Affinity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-pod-affinity-anti-affinity" class="md-nav__link">
    <span class="md-ellipsis">
      4. Pod Affinity / Anti-Affinity
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Pod Affinity / Anti-Affinity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pod-affinity" class="md-nav__link">
    <span class="md-ellipsis">
      Pod Affinity (соседство):
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pod-anti-affinity" class="md-nav__link">
    <span class="md-ellipsis">
      Pod Anti-Affinity (разделение):
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pod-lifecycle" class="md-nav__link">
    <span class="md-ellipsis">
      Pod Lifecycle
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Pod Lifecycle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pod-" class="md-nav__link">
    <span class="md-ellipsis">
      🚦 Жизненный цикл Pod-а
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🚦 Жизненный цикл Pod-а">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#podphase" class="md-nav__link">
    <span class="md-ellipsis">
      📌 Основные состояния (PodPhase):
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#containerstate" class="md-nav__link">
    <span class="md-ellipsis">
      📌 Состояния контейнеров (ContainerState)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restart-policy" class="md-nav__link">
    <span class="md-ellipsis">
      🔁 Restart Policy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#termination-grace-period" class="md-nav__link">
    <span class="md-ellipsis">
      ⏱ Termination Grace Period
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prestop-finalizer" class="md-nav__link">
    <span class="md-ellipsis">
      preStop &amp;&amp; finalizer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="preStop &amp;&amp; finalizer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_48" class="md-nav__link">
    <span class="md-ellipsis">
      🔍 Примеры сценариев
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#probes" class="md-nav__link">
    <span class="md-ellipsis">
      🩺 Probes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🩺 Probes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-livenessprobe" class="md-nav__link">
    <span class="md-ellipsis">
      🔍 1. livenessProbe
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-readinessprobe" class="md-nav__link">
    <span class="md-ellipsis">
      🕒 2. readinessProbe
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-startupprobe" class="md-nav__link">
    <span class="md-ellipsis">
      🐢 3. startupProbe
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#initcontainers" class="md-nav__link">
    <span class="md-ellipsis">
      InitContainers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#service-mesh" class="md-nav__link">
    <span class="md-ellipsis">
      Service Mesh
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Service Mesh">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_49" class="md-nav__link">
    <span class="md-ellipsis">
      🔧 Как работает?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#service-mesh_1" class="md-nav__link">
    <span class="md-ellipsis">
      🛠 Примеры популярных Service Mesh
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🛠 Примеры популярных Service Mesh">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#istio-" class="md-nav__link">
    <span class="md-ellipsis">
      Istio (де-факто стандарт, мощный, но тяжеловат)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mtls" class="md-nav__link">
    <span class="md-ellipsis">
      🔐 MTLS — всё шифруется автоматически
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#observability" class="md-nav__link">
    <span class="md-ellipsis">
      📊 Observability из коробки
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#service" class="md-nav__link">
    <span class="md-ellipsis">
      🔧 Service
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🔧 Service">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#clusterip" class="md-nav__link">
    <span class="md-ellipsis">
      🧱 ClusterIP (по умолчанию)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nodeport" class="md-nav__link">
    <span class="md-ellipsis">
      🌐 NodePort
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#loadbalancer" class="md-nav__link">
    <span class="md-ellipsis">
      🌎 LoadBalancer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#externalname" class="md-nav__link">
    <span class="md-ellipsis">
      🔗 ExternalName
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#headless-service" class="md-nav__link">
    <span class="md-ellipsis">
      🧪 Headless Service
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_50" class="md-nav__link">
    <span class="md-ellipsis">
      🔧 Дополнительные сценарии
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#istio-virtualservice" class="md-nav__link">
    <span class="md-ellipsis">
      🕹 Istio VirtualService
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ingress" class="md-nav__link">
    <span class="md-ellipsis">
      Ingress
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ingress">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ingress-controller" class="md-nav__link">
    <span class="md-ellipsis">
      🎮 Ingress Controller — что это?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ingress_1" class="md-nav__link">
    <span class="md-ellipsis">
      📌 Что делает Ingress:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ingress-controller_1" class="md-nav__link">
    <span class="md-ellipsis">
      📌 Что делает Ingress Controller:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_51" class="md-nav__link">
    <span class="md-ellipsis">
      🧠 Кратко:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#replicaset" class="md-nav__link">
    <span class="md-ellipsis">
      ReplicaSet (низкоуровневый)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deployment-stateless" class="md-nav__link">
    <span class="md-ellipsis">
      Deployment (стандарт для stateless приложений)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#daemonset" class="md-nav__link">
    <span class="md-ellipsis">
      DaemonSet
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#statefulset" class="md-nav__link">
    <span class="md-ellipsis">
      StatefulSet
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#job" class="md-nav__link">
    <span class="md-ellipsis">
      Job
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cronjob" class="md-nav__link">
    <span class="md-ellipsis">
      CronJob
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pod-controllers-comparation" class="md-nav__link">
    <span class="md-ellipsis">
      Pod controllers comparation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pvc" class="md-nav__link">
    <span class="md-ellipsis">
      PVC
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gitops-vs-helm" class="md-nav__link">
    <span class="md-ellipsis">
      GitOps vs Helm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rbac" class="md-nav__link">
    <span class="md-ellipsis">
      RBAC
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RBAC">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_52" class="md-nav__link">
    <span class="md-ellipsis">
      🧱 Основные сущности
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🧱 Основные сущности">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-role-rolebinding" class="md-nav__link">
    <span class="md-ellipsis">
      📌 Пример 1: Простой Role и RoleBinding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-clusterrole-clusterrolebinding" class="md-nav__link">
    <span class="md-ellipsis">
      📌 Пример 2: ClusterRole + ClusterRoleBinding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rules" class="md-nav__link">
    <span class="md-ellipsis">
      🧠 Что можно указывать в rules?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rbac-" class="md-nav__link">
    <span class="md-ellipsis">
      ⚠️ RBAC и сервис-аккаунты
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_53" class="md-nav__link">
    <span class="md-ellipsis">
      🎯 Частые паттерны:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🎯 Частые паттерны:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-view-edit-admin" class="md-nav__link">
    <span class="md-ellipsis">
      🔐 1. Предустановленные роли: view, edit, admin
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-least-privilege" class="md-nav__link">
    <span class="md-ellipsis">
      🧃 2. Least Privilege (минимально необходимые права)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-serviceaccount-rolebinding-pod" class="md-nav__link">
    <span class="md-ellipsis">
      🧬 3. ServiceAccount + RoleBinding: доступ только Pod’ам
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-aggregated-clusterroles" class="md-nav__link">
    <span class="md-ellipsis">
      🧩 4. Aggregated ClusterRoles — комбинация нескольких
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-dynamic-access-gitops" class="md-nav__link">
    <span class="md-ellipsis">
      🧪 5. Dynamic access (например, через GitOps)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-namespace-rbac" class="md-nav__link">
    <span class="md-ellipsis">
      📁 6. Мульти-Namespace RBAC
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_54" class="md-nav__link">
    <span class="md-ellipsis">
      🧠 Финальные советы:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#terraform" class="md-nav__link">
    <span class="md-ellipsis">
      Terraform
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Terraform">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ansible-terraform" class="md-nav__link">
    <span class="md-ellipsis">
      Отличие ansible и terraform
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Отличие ansible и terraform">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#terraform-state" class="md-nav__link">
    <span class="md-ellipsis">
      Что такое Terraform state?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#terraform_1" class="md-nav__link">
    <span class="md-ellipsis">
      Что такое провайдер в terraform
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#terraform_2" class="md-nav__link">
    <span class="md-ellipsis">
      Что такое ресурс в terraform
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ansible" class="md-nav__link">
    <span class="md-ellipsis">
      Ansible
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ansible">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ansible_1" class="md-nav__link">
    <span class="md-ellipsis">
      Основные примитивы Ansible
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Основные примитивы Ansible">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#inventory" class="md-nav__link">
    <span class="md-ellipsis">
      Инвентарь (Inventory)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task" class="md-nav__link">
    <span class="md-ellipsis">
      Задание (Task)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#play-playbook" class="md-nav__link">
    <span class="md-ellipsis">
      Сценарий (Play или Плейбук (Playbook)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#role" class="md-nav__link">
    <span class="md-ellipsis">
      Роль (Role)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#facts" class="md-nav__link">
    <span class="md-ellipsis">
      Факты (Facts)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ansible_2" class="md-nav__link">
    <span class="md-ellipsis">
      Порядок приоритета переменных в Ansible
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Порядок приоритета переменных в Ansible">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_55" class="md-nav__link">
    <span class="md-ellipsis">
      📊 Порядок от низшего к высшему:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_56" class="md-nav__link">
    <span class="md-ellipsis">
      🧩 Примеры по уровням
    </span>
  </a>
  
    <nav class="md-nav" aria-label="🧩 Примеры по уровням">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-defaults" class="md-nav__link">
    <span class="md-ellipsis">
      1. defaults в ролях (самый низкий приоритет)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_1" class="md-nav__link">
    <span class="md-ellipsis">
      2. Инвентарь
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-group_vars-host_vars" class="md-nav__link">
    <span class="md-ellipsis">
      3. group_vars/ и host_vars/
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-ansible_facts-set_fact" class="md-nav__link">
    <span class="md-ellipsis">
      4. ansible_facts (в том числе set_fact)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-vars-playbook" class="md-nav__link">
    <span class="md-ellipsis">
      5. vars в playbook
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-vars-task" class="md-nav__link">
    <span class="md-ellipsis">
      6. vars в task
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-register" class="md-nav__link">
    <span class="md-ellipsis">
      7. register
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-extra-vars" class="md-nav__link">
    <span class="md-ellipsis">
      8. --extra-vars (наивысший приоритет)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_57" class="md-nav__link">
    <span class="md-ellipsis">
      🧠 Заключение
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handlers" class="md-nav__link">
    <span class="md-ellipsis">
      Для чего нужны хендлеры, handlers?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iac-and" class="md-nav__link">
    <span class="md-ellipsis">
      IAC and Идемпотентность
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ad-hoc-ansible" class="md-nav__link">
    <span class="md-ellipsis">
      Для чего нужен ad hoc в ansible?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>Interview</h1>

<p>Preparing to Interview</p>
<p>Resources:
1. https://github.com/Swfuse/devops-interview?tab=readme-ov-file
2. https://github.com/rmntrvn/adm_linux_ops_questions</p>
<hr />
<h2 id="_1">Общее</h2>
<h3 id="_2">У вас есть компьютер. Вы нажали на кнопку включения. Расскажите максимально подробно, что происходит, до загрузки ОС.</h3>
<p>Подается сигнал о подаче питания, запускается BIOS/UEFI (программа подготовки к загрузке ОС). Загрузчик проверяет целостность своей программы, инициализирует устройства. После успешного прохождения тестов BIOS ищет загрузчик ОС:</p>
<ul>
<li>ищется загрузочный сектор (MBR)</li>
<li>считывается код из этого раздела и управление передается ему,</li>
<li>этот код ищет активный раздел ("system partition"), в первом разделе которого находится загрузочный код GRUB,</li>
<li>GRUB загружает и выполняет образы ядра и initrd,</li>
<li>передает управление ядру,</li>
<li>ядро монтируется в файловую систему и выполняет процесс init,</li>
<li>init загружает программы уровней выполнения (runlevel) из <code>/etc/rc.d/rc*.d/</code>.</li>
</ul>
<p>Пример программ:</p>
<ul>
<li><code>S12syslog</code> — запуск демона syslog,</li>
<li><code>S80sendmail</code> — запуск демона sendmail.</li>
</ul>
<p>Таким образом, syslog будет запущен перед sendmail.</p>
<p>Источник: https://habr.com/ru/post/518972/</p>
<h3 id="linux-curl-wwwtinkoffru-">Открыли linux консоль, ввели curl www.tinkoff.ru - нажали энтер. Что происходит, максимально подробно.</h3>
<p>curl — утилита для взаимодействия с хостами по протоколам: FTP, FTPS, HTTP, HTTPS, TFTP, SCP, SFTP, Telnet, DICT, LDAP, POP3, IMAP и SMTP.</p>
<p>Без дополнительных параметров curl выполняется с методом GET по протоколу HTTP (уровень L7). Перед этим:</p>
<ol>
<li>происходит разрешение DNS имени в IP-адрес по протоколу DNS,<ul>
<li>Протокол: DNS</li>
<li>Уровни OSI:<ul>
<li>Прикладной (7) — DNS</li>
<li>Транспортный (4) — UDP (или TCP)</li>
<li>Сетевой (3) — IP</li>
</ul>
</li>
</ul>
</li>
<li>запрос уходит на DNS-сервер, далее по цепочке — к корневым DNS и авторитетным,<ul>
<li>Протоколы: DNS → через UDP или TCP (53 порт)</li>
<li>Уровни OSI:<ul>
<li>Прикладной (7) — DNS</li>
<li>Транспортный (4) — UDP/TCP</li>
<li>Сетевой (3) — IP</li>
<li>Канальный (2) — Ethernet/Wi-Fi</li>
<li>Физический (1)</li>
</ul>
</li>
</ul>
</li>
<li>получив IP, устанавливается соединение по TCP (трехстороннее рукопожатие),<ul>
<li>TCP (3-way handshake: SYN, SYN-ACK, ACK)</li>
<li>Уровни OSI:<ul>
<li>Транспортный (4) — TCP</li>
<li>Сетевой (3) — IP</li>
<li>Канальный (2), Физический (1)</li>
</ul>
</li>
</ul>
</li>
<li>используется стек TCP/IP и таблицы маршрутизации,<ul>
<li>Протоколы: IP (routing), TCP (session)</li>
<li>Уровни OSI:<ul>
<li>Сетевой (3) — IP</li>
<li>Транспортный (4) — TCP</li>
<li>Канальный (2), Физический (1)</li>
</ul>
</li>
</ul>
</li>
<li>далее отправляется HTTP-запрос на порт 80,<ul>
<li>Протоколы: HTTP</li>
<li>Уровни OSI:<ul>
<li>Прикладной (7) — HTTP</li>
<li>Транспортный (4) — TCP</li>
<li>Сетевой (3) — IP</li>
</ul>
</li>
</ul>
</li>
<li>получаем ответ от сервера.<ul>
<li>Протоколы: HTTP (ответ), TCP (доставка)</li>
<li>Уровни OSI:<ul>
<li>Прикладной (7) — HTTP</li>
<li>Транспортный (4) — TCP</li>
<li>Сетевой (3) — IP</li>
</ul>
</li>
</ul>
</li>
</ol>
<h3 id="_3">Зачем маска подсети на клиентском компьютере</h3>
<p>Маска подсети нужна, чтобы определить, будет ли передача данных происходить на канальном уровне (L2) напрямую, или нужно использовать маршрутизацию на сетевом уровне (L3).</p>
<hr />
<p><strong>Как это работает:</strong></p>
<ol>
<li>
<p><strong>Компьютер сравнивает свой IP и IP назначения через маску подсети (битовая операция AND).</strong></p>
</li>
<li>
<p><strong>Если результат одинаковый (одна сеть):</strong></p>
<ul>
<li>
<p>Узел считается “локальным”</p>
</li>
<li>
<p>Передача идёт на <strong>уровне L2 (Ethernet, ARP)</strong></p>
</li>
<li>
<p>Пакет отправляется <strong>напрямую адресату</strong>, без маршрутизатора используется широковещание (broadcast) для всех устройств в сети</p>
</li>
</ul>
</li>
<li>
<p><strong>Если результат разный (другая сеть):</strong></p>
<ul>
<li>
<p>Узел считается внешним</p>
</li>
<li>
<p>Передача идёт через <strong>маршрутизатор (gateway)</strong> на <strong>уровне L3</strong></p>
</li>
<li>
<p>Применяется IP-маршрутизация, NAT и т.д.</p>
</li>
</ul>
</li>
</ol>
<hr />
<blockquote>
<p>Маска подсети определяет границы локальной сети. Клиентское устройство использует её, чтобы понять, к какому уровню обращаться для доставки пакета:</p>
</blockquote>
<ul>
<li>
<blockquote>
<p>если получатель внутри той же подсети → L2-коммуникация через ARP и прямую отправку;</p>
</blockquote>
</li>
<li>
<blockquote>
<p>если в другой подсети → пакет отправляется на маршрутизатор (gateway), и далее обрабатывается на уровне L3 и выше.</p>
</blockquote>
</li>
</ul>
<hr />
<blockquote>
<p>Это позволяет устройству избежать лишней маршрутизации, минимизировать задержки и правильно формировать ARP-запросы только внутри локального сегмента.</p>
</blockquote>
<h3 id="loadaverage">Что такое LoadAverage?</h3>
<p>LoadAverage — средняя загрузка CPU за 1, 5 и 15 минут.</p>
<ul>
<li><strong>Что означает?</strong> Процент утилизируемого времени от общего времени простоя.</li>
<li><strong>В чем измеряется?</strong> Измеряется в тиках (единицы времени CPU), сколько тиков отдано на выполнение процессов. Если &gt; 100%, значит есть очередь из ожидающих процессов.</li>
<li><strong>Какое нормальное значение?</strong> До 1 на 1 CPU (1.0 на одно ядро).</li>
<li><strong>Если LA = 1000 — это нормально?</strong> Нет, это плохо, если только не 1000 ядер в системе.</li>
<li><strong>Что влияет на LA?</strong> Например, iowait.</li>
</ul>
<p>Высокие значения wa (wait I/O) и LA часто говорят о D-state (ожидание ввода/вывода), может быть связано с дисками, сетью, USB, сокетами и др.</p>
<h3 id="linux">Упрощенная модель состояний процесса в Linux</h3>
<ul>
<li><strong>D</strong> — ожидание ввода/вывода</li>
<li><strong>R</strong> — выполняется</li>
<li><strong>S</strong> — спящий, ждет события</li>
<li><strong>T</strong> — остановлен</li>
<li><strong>Z</strong> — зомби</li>
</ul>
<p>Посмотреть процессы: <code>ps aux</code></p>
<p>Если wa (wait I/O) &gt; 10-30%, желательно найти причину.</p>
<p>Источник: https://firstvds.ru/technology/nagruzka-na-server-opredelenie-prichin</p>
<h3 id="_4">Кто и при каких условиях может менять группу у файла?</h3>
<p>Команда: <code>chown</code></p>
<ul>
<li><strong>Требуется:</strong> либо быть владельцем файла, либо иметь права root.</li>
</ul>
<h4 id="_5">Пример:</h4>
<pre><code>-rw------- 1 user1 user1 147746 мар 27 12:19 somefile
</code></pre>
<ul>
<li>
<p><code>chown user1:user2 somefile</code></p>
</li>
<li>
<p><code>chown user1:www-data somefile</code></p>
</li>
<li>
<p><strong>Если не root:</strong> сработает, если user1 состоит в этих группах.</p>
</li>
<li>
<p><strong>Если root:</strong> сработает, если группы и пользователи существуют.</p>
</li>
</ul>
<h3 id="1">Свободное место #1</h3>
<p><strong>df</strong> <strong>(disk free)</strong>
- Показывает <strong>использование файловой системы в целом</strong>, на уровне блочного устройства.
- Смотрит на <strong>таблицу inodes и блоков</strong>, чтобы узнать, сколько данных физически занято.
- Учитывает <strong>все данные</strong>, включая:
    - удалённые, но всё ещё открытые файлы;
    - данные в сокетах, pipes, tmpfs и т.п.
🔸 <strong>Типичный источник правды — ядро, через системные вызовы statfs().</strong></p>
<p><strong>du</strong> <strong>(disk usage)</strong>
- Считает <strong>файлы и папки</strong>, доступные в <strong>текущем namespace</strong>.
- Обходит файловую систему и суммирует <strong>размеры только доступных (видимых) файлов</strong>.
- Не считает:
    - удалённые, но ещё открытые файлы;
    - tmpfs, сокеты, pipes и другие неклассические файловые объекты.
🔸 <strong>Типичный источник правды — просмотр содержимого директорий.</strong></p>
<p><strong>lsof</strong> <strong>(List Open Files)</strong> — это утилита в Linux/Unix, которая показывает <strong>все открытые файлы и сокеты в системе</strong>. В Linux <strong>всё — это файл</strong>, включая:</p>
<ul>
<li>обычные файлы (/var/log/...)</li>
<li>директории</li>
<li>устройства (/dev/sda)</li>
<li>сокеты (/tmp/.X11-unix)</li>
<li>каналы (pipes)</li>
<li>сетевые соединения (TCP, UDP)</li>
</ul>
<hr />
<p><code>df -Th</code> показывает, что место есть. Но <code>touch file</code> — ошибка "No space left on device".</p>
<p>Причины:</p>
<ul>
<li>
<p>Файлы были удалены, но заняты процессами.</p>
</li>
<li>
<p>Проверка: <code>sudo lsof / | grep deleted</code></p>
</li>
<li>
<p>Исчерпаны <strong>inodes</strong> — <code>df -i</code></p>
</li>
<li>
<p>Плохие блоки — использовать <code>fsck -vcck /dev/sdX</code></p>
</li>
<li>
<p>Ограничения файловой системы (например, FAT — макс. файл 4GB)</p>
</li>
</ul>
<p>Источник: https://rtfm.co.ua/unix-df-i-du-raznye-znacheniya/ https://zalinux.ru/?p=3001</p>
<h3 id="2">Свободное место #2</h3>
<p>Корень 100ГБ, <code>df</code> показывает занято всё, а <code>du -sh /*</code> — только 10ГБ.</p>
<p>Возможные причины:</p>
<ul>
<li>Файлы удалены, но заняты процессами.</li>
<li>Найти процессы: <code>lsof | grep deleted</code></li>
</ul>
<h4 id="inodes">Пояснение: файловые дескрипторы и inodes</h4>
<ul>
<li>
<p><strong>inode</strong> — уникальный ID файла, метаданные.</p>
</li>
<li>
<p><strong>fd (file descriptor)</strong> — "билет" на доступ к файлу для конкретного процесса, с конкретными правами.</p>
</li>
<li>
<p>Один файл может быть открыт многими fd.</p>
</li>
<li>
<p>После закрытия fd доступ к файлу теряется (если нет других открытых).</p>
</li>
</ul>
<h3 id="_6">Гипервизор</h3>
<p>Гипервизор — это низкоуровневая оболочка (программа или аппаратная схема), обеспечивающая параллельное выполнение нескольких ОС на одном хост-компьютере.</p>
<p>Функции:
- изоляция ОС,
- безопасность и защита,
- управление и разделение ресурсов,
- виртуализация оборудования,
- включение/перезагрузка/выключение ВМ,
- взаимодействие между ОС (например, по сети).</p>
<p>Гипервизор можно считать микроядром — минимальной ОС, управляющей виртуальными машинами.</p>
<h3 id="_7">Как работает контейнеризация и чем отличается от виртуализации?</h3>
<p><strong>Контейнеризация:</strong> изоляция приложений с использованием общего ядра ОС (через <code>namespaces</code>, <code>cgroups</code>). Контейнер — это изолированный процесс, а не отдельная ОС.</p>
<p><strong>Виртуализация:</strong> запуск полноценной ОС поверх гипервизора. Каждая виртуальная машина имеет собственное ядро и ресурсы.</p>
<p><strong>Контейнеры легче, запускаются быстрее, используют меньше ресурсов.</strong></p>
<hr />
<h2 id="linux_1">Linux</h2>
<h3 id="_8">Виды памяти</h3>
<h4 id="_9">Основные термины</h4>
<table>
<thead>
<tr>
<th><strong>Вид памяти</strong></th>
<th><strong>Что это такое</strong></th>
<th><strong>Где смотрим</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>VSS (VSZ)</strong> – Virtual Set Size</td>
<td>Вся виртуальная память процесса (вкл. библиотеки, mmap, кэш, зарезервированную).</td>
<td>ps, top, smem</td>
</tr>
<tr>
<td><strong>RSS</strong> – Resident Set Size</td>
<td>Реально загруженная в RAM память процесса (без свопа).</td>
<td>ps, top, smem, /proc/[pid]/statm</td>
</tr>
<tr>
<td><strong>PSS</strong> – Proportional Set Size</td>
<td>RSS, но shared-страницы делятся пропорционально между процессами.</td>
<td>smem, /proc/[pid]/smaps</td>
</tr>
<tr>
<td><strong>USS</strong> – Unique Set Size</td>
<td>Только та память, которую использует <strong>только данный</strong> процесс.</td>
<td>smem, /proc/[pid]/smaps</td>
</tr>
<tr>
<td><strong>Shared memory</strong></td>
<td>Общая память, используемая несколькими процессами (например, библиотеки).</td>
<td>smem, pmap, /proc/[pid]/maps</td>
</tr>
<tr>
<td><strong>Swap</strong></td>
<td>Страницы, выгруженные на диск (в swap).</td>
<td>free, vmstat, top, smem</td>
</tr>
<tr>
<td><strong>Page Cache</strong></td>
<td>Кэш файловых данных, недавно прочитанных с диска. Используется ядром.</td>
<td>free, vmstat, /proc/meminfo</td>
</tr>
<tr>
<td><strong>Buffers</strong></td>
<td>Кэш метаданных файловой системы и блочных устройств.</td>
<td>free, vmstat, /proc/meminfo</td>
</tr>
<tr>
<td><strong>Slab</strong></td>
<td>Кэш структур ядра (inode, dentry, файловые дескрипторы и пр.).</td>
<td>/proc/meminfo, slabtop</td>
</tr>
<tr>
<td><strong>PageTables</strong></td>
<td>Память, занимаемая таблицами страниц виртуальной памяти процессов.</td>
<td>/proc/meminfo, smem, top</td>
</tr>
<tr>
<td><strong>KernelStack</strong></td>
<td>Стек ядра, выделенный для каждого потока.</td>
<td>/proc/meminfo, smem</td>
</tr>
<tr>
<td>#### Области памяти процесса</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th><strong>Область</strong></th>
<th><strong>Назначение</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Text (code)</strong></td>
<td>Исполняемый код</td>
</tr>
<tr>
<td><strong>Data</strong></td>
<td>Глобальные переменные</td>
</tr>
<tr>
<td><strong>Heap</strong></td>
<td>Динамическая память (malloc, new)</td>
</tr>
<tr>
<td><strong>Stack</strong></td>
<td>Локальные переменные, вызовы функций</td>
</tr>
<tr>
<td><strong>mmap</strong></td>
<td>Отображения файлов, shared libraries, анонимная память</td>
</tr>
<tr>
<td>Можно посмотреть с помощью:</td>
<td></td>
</tr>
</tbody>
</table>
<pre><code>cat /proc/&lt;pid&gt;/maps
</code></pre>
<p><strong>📊 Пример smem</strong></p>
<pre><code>sudo smem -r
</code></pre>
<table>
<thead>
<tr>
<th><strong>PID</strong></th>
<th><strong>User</strong></th>
<th><strong>USS</strong></th>
<th><strong>PSS</strong></th>
<th><strong>RSS</strong></th>
<th><strong>Command</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>123</td>
<td>root</td>
<td>10M</td>
<td>12M</td>
<td>14M</td>
<td>nginx</td>
</tr>
</tbody>
</table>
<h4 id="_10">💡 Как использовать это на практике:</h4>
<p>• <strong>Высокий VSS</strong> — не всегда проблема (может быть много mmap’ов, но физически не используется).
• <strong>Высокий RSS</strong> — показывает реальное использование RAM.
• <strong>PSS</strong> — хорош для понимания, сколько “в среднем” процесс реально занимает.
• <strong>USS</strong> — полезен для оценки того, что можно выгрузить без ущерба другим процессам.
• <strong>Swap &gt; 0</strong> — может сигнализировать о нехватке RAM.</p>
<h3 id="namespaces-and-cgroups">Namespaces and Cgroups</h3>
<p><strong>namespaces и cgroups</strong> — это два столпа изоляции в Linux. Они лежат в основе <strong>контейнеризации (например, Docker, Kubernetes)</strong> и вообще любой виртуализации на уровне ОС.</p>
<p>Давай разложим на понятном уровне:</p>
<hr />
<h4 id="linux-namespaces">🧱 Что такое Linux namespaces?</h4>
<p><strong>Namespaces</strong> позволяют изолировать <strong>системные ресурсы</strong> между процессами.</p>
<p>То есть каждый процесс “видит” только то, что разрешено его namespace’у.</p>
<h5 id="namespace">📦 Основные типы namespace</h5>
<table>
<thead>
<tr>
<th><strong>Namespace</strong></th>
<th><strong>Изолирует</strong></th>
<th><strong>Пример</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>mnt</td>
<td>файловую систему</td>
<td>отдельный /, /proc</td>
</tr>
<tr>
<td>pid</td>
<td>процессы и PID’ы</td>
<td>ps покажет “свои” PID</td>
</tr>
<tr>
<td>net</td>
<td>сетевые интерфейсы, IP</td>
<td>отдельный eth0</td>
</tr>
<tr>
<td>uts</td>
<td>имя хоста (hostname)</td>
<td>hostname будет разным</td>
</tr>
<tr>
<td>ipc</td>
<td>очереди сообщений, semaphors</td>
<td>ipcs</td>
</tr>
<tr>
<td>user</td>
<td>пользователей и UID/GID</td>
<td>root внутри, но не снаружи</td>
</tr>
<tr>
<td>cgroup</td>
<td>иерархию cgroups</td>
<td>отдельная область ресурсов</td>
</tr>
</tbody>
</table>
<p>📌 Каждый namespace изолирует свою подсистему.</p>
<p><strong>🔧 Пример изоляции с unshare:</strong></p>
<pre><code>sudo unshare --pid --fork --mount-proc bash
</code></pre>
<p>Теперь ты в новом PID namespace → ps покажет только текущий процесс.</p>
<hr />
<h4 id="linux-cgroups">🔒 Что такое Linux cgroups?</h4>
<p><strong>Cgroups (Control Groups)</strong> — это способ <strong>ограничить и контролировать ресурсы</strong>, которые может потреблять процесс.</p>
<p><strong>📌 Возможности cgroups:</strong></p>
<p>• Ограничение <strong>CPU, RAM, disk IO, pids</strong>
• Приоритет (через weight)
• Мониторинг использования ресурсов
• Группировка процессов в иерархию</p>
<p><strong>Примеры ресурсов:</strong></p>
<table>
<thead>
<tr>
<th><strong>Тип</strong></th>
<th><strong>Что ограничивает</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>cpu</td>
<td>использование CPU</td>
</tr>
<tr>
<td>memory</td>
<td>объём RAM</td>
</tr>
<tr>
<td>pids</td>
<td>число процессов</td>
</tr>
<tr>
<td>blkio</td>
<td>доступ к диску</td>
</tr>
<tr>
<td>devices</td>
<td>доступ к устройствам</td>
</tr>
<tr>
<td><strong>Пример ограничения памяти:</strong></td>
<td></td>
</tr>
</tbody>
</table>
<pre><code>mkdir /sys/fs/cgroup/memory/mygroup
echo 100000000 &gt; /sys/fs/cgroup/memory/mygroup/memory.limit_in_bytes
echo $$ &gt; /sys/fs/cgroup/memory/mygroup/tasks
</code></pre>
<p>📌 Теперь текущий процесс не может использовать больше 100Мб RAM.</p>
<hr />
<h4 id="_11">📦 Как работают вместе</h4>
<p>Контейнер (например, docker run) использует:</p>
<p>• <strong>Namespaces</strong> → чтобы изолировать окружение (видимость процессов, файлов, сети)
• <strong>Cgroups</strong> → чтобы ограничить, сколько он может потреблять ресурсов</p>
<hr />
<h5 id="docker">🐳 Пример: как работает Docker контейнер под капотом</h5>
<ol>
<li>Создаётся новый PID, NET, UTS, MNT, USER namespace → у контейнера “своя” ОС</li>
<li>Создаются cgroups для CPU, memory и pids</li>
<li>Монтируется overlayfs → своя корневая файловая система</li>
<li>Внутри запускается твой ENTRYPOINT в изолированной среде</li>
</ol>
<hr />
<h5 id="_12">✅ Сравнение:</h5>
<table>
<thead>
<tr>
<th></th>
<th><strong>Namespaces</strong></th>
<th><strong>Cgroups</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Что делают?</td>
<td>Изолируют</td>
<td>Ограничивают</td>
</tr>
<tr>
<td>Применение</td>
<td>Видимость ресурсов</td>
<td>Потребление ресурсов</td>
</tr>
<tr>
<td>Пример</td>
<td>свой hostname</td>
<td>максимум 512Mi памяти</td>
</tr>
</tbody>
</table>
<h3 id="bash-0-1">Bash переменные $?, $0, $1, $@, $\$</h3>
<h4 id="_13">$\$</h4>
<pre><code>echo $$
</code></pre>
<p>Это команда, которая выводит <strong>PID (Process ID)</strong> текущего shell-процесса.</p>
<hr />
<p><strong>🔍 Подробно:</strong></p>
<p>• $ — это префикс для <strong>переменной окружения</strong> в bash.</p>
<p>• $\$ — специальная переменная в bash, которая содержит <strong>PID текущего процесса</strong>, в котором выполняется команда.</p>
<hr />
<p><strong>📦 Пример:</strong></p>
<pre><code>$ echo $$
12345
</code></pre>
<p>Это означает, что оболочка (shell), в которой ты работаешь — имеет PID 12345.</p>
<hr />
<p><strong>🧠 Когда полезно?</strong></p>
<ol>
<li>Чтобы:</li>
</ol>
<p>• добавить текущий процесс в cgroup:</p>
<pre><code>echo $$ &gt; /sys/fs/cgroup/memory/mygroup/tasks
</code></pre>
<ol>
<li>Отлаживать скрипты:</li>
</ol>
<pre><code>echo &quot;This script is running with PID $$&quot;
</code></pre>
<ol>
<li>Смотреть, какие процессы запущены от конкретного shell:</li>
</ol>
<pre><code>ps -fp $$
</code></pre>
<h4 id="special-variables-short">Special variables short</h4>
<p>Иногда их также называют:</p>
<p>• <strong>параметрами окружения shell’а</strong>
• <strong>позиционными параметрами</strong> ($0, $1, $2, …, $@, $<em>)
• </em><em>встроенными переменными shell (builtin shell variables)</em>*</p>
<hr />
<p><strong>📘 Расшифровка самых важных:</strong></p>
<table>
<thead>
<tr>
<th><strong>Переменная</strong></th>
<th><strong>Значение</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>$$</td>
<td>PID текущего shell-процесса</td>
</tr>
<tr>
<td>$?</td>
<td>Код возврата последней команды (0 = успех, ≠0 = ошибка)</td>
</tr>
<tr>
<td>$0</td>
<td>Имя скрипта (или имя текущего shell)</td>
</tr>
<tr>
<td>$1, $2, …</td>
<td>Параметры, переданные скрипту или функции</td>
</tr>
<tr>
<td>$@</td>
<td>Все аргументы как список ("$1", "$2"…)</td>
</tr>
<tr>
<td>$*</td>
<td>Все аргументы как одна строка ("$1 $2 ...")</td>
</tr>
</tbody>
</table>
<hr />
<p><strong>🔍 Примеры:</strong></p>
<pre><code>#!/bin/bash
echo &quot;Script name: $0&quot;
echo &quot;First arg: $1&quot;
echo &quot;Exit code of last cmd: $?&quot;
echo &quot;All args (\$@): $@&quot;
echo &quot;All args (\$*): $*&quot;
</code></pre>
<p>Если ты вызовешь:</p>
<pre><code>./myscript.sh hello world
</code></pre>
<p>То получишь:</p>
<pre><code>Script name: ./myscript.sh
First arg: hello
Exit code of last cmd: 0
All args ($@): hello world
All args ($*): hello world
</code></pre>
<hr />
<p><strong>🧠 Резюме</strong></p>
<table>
<thead>
<tr>
<th><strong>Имя</strong></th>
<th><strong>Что делает</strong></th>
<th><strong>Категория</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>$$</td>
<td>PID текущего shell</td>
<td>спец. переменная</td>
</tr>
<tr>
<td>$?</td>
<td>Код выхода последней команды</td>
<td>спец. переменная</td>
</tr>
<tr>
<td>$0</td>
<td>Имя скрипта или shell</td>
<td>позиционный параметр</td>
</tr>
<tr>
<td>$1, $2</td>
<td>Аргументы</td>
<td>позиционные параметры</td>
</tr>
<tr>
<td>$@, $*</td>
<td>Все аргументы</td>
<td>позиционные параметры</td>
</tr>
</tbody>
</table>
<h3 id="zombie">Что такое zombie процесс и чем это плохо, как его убить?</h3>
<p><strong>Zombie (зомби)</strong> — завершившийся процесс, чья запись ещё хранится в системе (ожидает, пока родитель вызовет <code>wait()</code> для чтения exit-кода).</p>
<ul>
<li>Не использует CPU/RAM, но потребляет <strong>PID</strong>.</li>
<li>При большом числе зомби — может закончиться пул PID.</li>
</ul>
<p><strong>Убить:</strong> нельзя напрямую, нужно убить родителя:</p>
<pre><code class="language-bash">ps -ef | grep defunct
# найти родителя, затем:
sudo kill -9 &lt;PID&gt;
</code></pre>
<h3 id="_14">Чем опасно хранение большого количества маленьких файлов на файловой системе?</h3>
<ul>
<li><strong>Заканчиваются inodes</strong> — метаданные для файлов.</li>
<li>Медленное выполнение операций (поиск, open/read).</li>
<li>Проблемы с резервным копированием и производительностью.</li>
</ul>
<p><strong>Что делать:</strong>
- Использовать базы данных (например, SQLite, PostgreSQL).
- Разбивать по подпапкам (sharding по префиксу ID).
- Использовать объектное хранилище (S3, GCS).</p>
<hr />
<h2 id="git">GIT</h2>
<h3 id="_15">Как внести изменения в последний коммит?</h3>
<p>Можно использовать команду <code>git commit</code> с флагом <code>--amend</code>.</p>
<h3 id="_16">Как добавить забытые файлы в последний коммит?</h3>
<p>Если забыли включить в коммит часть файлов, можно:</p>
<pre><code>git add dir1
git commit

# забыли dir2:
git add dir2
git commit --amend --no-edit
</code></pre>
<p>Флаг <code>--no-edit</code> позволяет оставить прежнее сообщение коммита.</p>
<h3 id="git-revert-git-reset">Чем отличается git revert от git reset?</h3>
<ul>
<li><code>git revert</code> отменяет <strong>один конкретный коммит</strong>, создав новый коммит с обратными изменениями.</li>
<li><code>git reset</code> возвращает проект к прошлому состоянию, <strong>удаляя</strong> все последующие коммиты (если hard).</li>
</ul>
<hr />
<h2 id="_17">Сеть</h2>
<h3 id="osi">OSI</h3>
<p>Open Systems Interconnection</p>
<p><strong>📶 Модель OSI — 7 уровней сетевого взаимодействия</strong></p>
<table>
<thead>
<tr>
<th><strong>№</strong></th>
<th><strong>Уровень</strong></th>
<th><strong>Описание</strong></th>
<th><strong>Примеры</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>7</td>
<td><strong>Прикладной (Application)</strong></td>
<td>То, что видит пользователь</td>
<td>HTTP, FTP, DNS, SSH</td>
</tr>
<tr>
<td>6</td>
<td><strong>Представления (Presentation)</strong></td>
<td>Формат данных, кодировка, шифрование</td>
<td>TLS/SSL, JPEG, MP3</td>
</tr>
<tr>
<td>5</td>
<td><strong>Сеансовый (Session)</strong></td>
<td>Управление сессиями</td>
<td>SSH-сессия, RPC, NetBIOS</td>
</tr>
<tr>
<td>4</td>
<td><strong>Транспортный (Transport)</strong></td>
<td>Доставка данных, надёжность</td>
<td>TCP, UDP</td>
</tr>
<tr>
<td>3</td>
<td><strong>Сетевой (Network)</strong></td>
<td>Адресация и маршрутизация</td>
<td>IP, ICMP</td>
</tr>
<tr>
<td>2</td>
<td><strong>Канальный (Data Link)</strong></td>
<td>Доставка кадров между узлами</td>
<td>Ethernet, Wi-Fi, PPP</td>
</tr>
<tr>
<td>1</td>
<td><strong>Физический (Physical)</strong></td>
<td>Биты, кабели, сигналы</td>
<td>RJ-45, оптоволокно, Wi-Fi</td>
</tr>
<tr>
<td>Мнемоника:</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>🔽 <strong>Снизу вверх</strong>:</p>
<blockquote>
<p><strong>P</strong>lease <strong>D</strong>o <strong>N</strong>ot <strong>T</strong>hrow <strong>S</strong>ausage <strong>P</strong>izza <strong>A</strong>way</p>
</blockquote>
<p>(Physical, Data Link, Network, Transport, Session, Presentation, Application)</p>
<hr />
<p><strong>🔍 Пример передачи HTTP-запроса:</strong></p>
<ol>
<li><strong>HTTP-запрос</strong> (Application)</li>
<li>Шифруется в <strong>TLS</strong> (Presentation)</li>
<li>Управление <strong>сеансом TLS</strong> (Session)</li>
<li>Делится на сегменты TCP (Transport)</li>
<li>Достаётся через IP-адрес (Network)</li>
<li>Отправляется по Ethernet/Wi-Fi (Data Link)</li>
<li>Через физический кабель или сигнал (Physical)</li>
</ol>
<h3 id="l4l7-lb">L4/L7 LB</h3>
<p>Разберём <strong>L4, L7 и другие типы балансировщиков</strong>, и в чём их особенности.</p>
<p><strong>🌐 Уровни балансировки нагрузки (по OSI-модели)</strong></p>
<h4 id="l4-">✅ L4-балансировка (транспортный уровень)</h4>
<p>📌 Основана на: <strong>IP-адресах + TCP/UDP-портах</strong></p>
<p><strong>🛠 Как работает:</strong></p>
<p>• Перенаправляет трафик, <strong>не заглядывая внутрь пакета</strong>.</p>
<p>• Работает по 5-tuple: src IP, src port, dst IP, dst port, protocol.</p>
<p><strong>🔧 Примеры:</strong></p>
<p>• iptables / ipvs
• Linux LVS
• HAProxy (L4 режим)
• AWS Network Load Balancer (NLB)
• MetalLB в Kubernetes</p>
<p><strong>➕ Плюсы:</strong></p>
<p>• Быстро
• Низкие накладные расходы
• Подходит для TCP/UDP</p>
<p><strong>➖ Минусы:</strong></p>
<p>• Не видит содержимого (например, URL, cookie)
• Не может принимать решения по содержимому запроса</p>
<hr />
<h4 id="l7-">✅ L7-балансировка (прикладной уровень)</h4>
<p>📌 Основана на: <strong>содержимом HTTP/HTTPS, gRPC, WebSocket и т.д.</strong></p>
<p><strong>🛠 Как работает:</strong></p>
<p>• Анализирует <strong>запросы полностью</strong>: путь, заголовки, куки, тело и т.п.
• Может <strong>делать маршрутизацию по URL, хосту, методу</strong>, и даже по содержимому.</p>
<p><strong>🔧 Примеры:</strong></p>
<p>• NGINX, Envoy, Traefik, HAProxy (L7)
• Kubernetes Ingress Controllers
• AWS Application Load Balancer (ALB)
• Istio / Linkerd (в сервисной mesh’е)</p>
<p><strong>➕ Плюсы:</strong></p>
<p>• Гибкая маршрутизация
• Поддержка канареек, A/B, blue/green
• Можешь делать rate limiting, аутентификацию, логирование</p>
<p><strong>➖ Минусы:</strong></p>
<p>• Выше нагрузка
• Медленнее, чем L4
• Не подходит для “сырого” TCP/UDP</p>
<hr />
<p><strong>📦 Есть ли другие уровни?</strong></p>
<h4 id="l3-">✅ L3-балансировка (сетевой уровень)</h4>
<p>📌 Маршрутизация по IP без портов</p>
<p>• Очень базовая, почти не используется в приложениях напрямую
• Пример: BGP + ECMP (Equal-cost multi-path routing), IP-routing</p>
<h4 id="l2-">✅ L2-балансировка (канальный уровень)</h4>
<p>📌 Балансировка через MAC-адреса и ARP</p>
<p>• Используется в некоторых виртуализированных или железных решениях
• Пример: балансировка через L2-мосты, ARP spoofing/rewriting (редкость)</p>
<h4 id="_18">🧠 Сравнение коротко</h4>
<table>
<thead>
<tr>
<th><strong>Уровень</strong></th>
<th><strong>Что видит?</strong></th>
<th><strong>Примеры</strong></th>
<th><strong>Особенности</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>L7</strong></td>
<td>HTTP, gRPC, Headers</td>
<td>ALB, Ingress, NGINX</td>
<td>Умная маршрутизация</td>
</tr>
<tr>
<td><strong>L4</strong></td>
<td>TCP/UDP</td>
<td>NLB, LVS, iptables</td>
<td>Быстро, не читает запросы</td>
</tr>
<tr>
<td><strong>L3</strong></td>
<td>IP-адреса</td>
<td>BGP, ECMP</td>
<td>Очень низкий уровень, routing</td>
</tr>
<tr>
<td><strong>L2</strong></td>
<td>MAC-адреса</td>
<td>ARP proxy, мосты</td>
<td>Почти не используется в клауде</td>
</tr>
</tbody>
</table>
<hr />
<h4 id="kubernetes">🧪 В Kubernetes</h4>
<p>• <strong>Service type: LoadBalancer</strong> — обычно L4 (NLB или аналог)
• <strong>Ingress Controller</strong> — L7 (работает с HTTP)
• <strong>Service Mesh (Istio, Linkerd)</strong> — L7 прокси с deep inspection</p>
<p>В <strong>Kubernetes</strong> уровни <strong>L4 и L7</strong> <strong>чаще всего используются вместе</strong>, потому что они решают <strong>разные задачи</strong> на пути трафика к приложению. Давай разберём <strong>пошагово и наглядно</strong>, как они сочетаются.</p>
<h6 id="_19">🧭 Кратко: как трафик проходит от клиента к приложению</h6>
<pre><code>Client → L4 LoadBalancer → NodePort / ClusterIP (L4) → Ingress Controller (L7) → App
</code></pre>
<hr />
<p><strong>🔷 1. L4 в Kubernetes</strong></p>
<p>L4 балансировка основана на <strong>IP + TCP/UDP портах</strong>. В Kubernetes это:</p>
<p><strong>✅ Примеры L4-объектов:</strong></p>
<table>
<thead>
<tr>
<th><strong>Тип объекта</strong></th>
<th><strong>Что делает</strong></th>
<th><strong>Уровень</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Service: ClusterIP</td>
<td>L4 внутри кластера</td>
<td>L4</td>
</tr>
<tr>
<td>Service: NodePort</td>
<td>Открывает порт на всех нодах</td>
<td>L4</td>
</tr>
<tr>
<td>Service: LoadBalancer</td>
<td>Интеграция с внешним L4 балансером (например, NLB)</td>
<td>L4</td>
</tr>
</tbody>
</table>
<p>📌 Важно: LoadBalancer — это <strong>внешний L4-балансер</strong>, например, AWS NLB или GCP TCP balancer, который умеет “раздавать” трафик на NodePort сервиса.</p>
<hr />
<p><strong>🔶 2. L7 в Kubernetes</strong></p>
<p><strong>✅ Как только L4-трафик доходит до Ingress Controller (например, NGINX, Traefik, Envoy):</strong></p>
<p>• Начинается <strong>L7-балансировка</strong>:</p>
<p>Разбор HTTP-запросов → маршрутизация по:</p>
<p>• host (например, api.example.com)</p>
<p>• path (например, /v1/ → один сервис, /admin → другой)</p>
<p>• заголовкам, методам, и т.п.</p>
<p><strong>✅ Примеры L7:</strong></p>
<p>• Ingress ресурс</p>
<p>• IngressRoute (Traefik CRD)</p>
<p>• VirtualService (в Istio)</p>
<hr />
<h6 id="_20">🧪 Пример трафика:</h6>
<p><strong>👉 Ты открываешь браузер:</strong></p>
<pre><code>https://app.example.com/login
</code></pre>
<p>Что происходит:</p>
<ol>
<li>
<p>🌍 Запрос уходит на <strong>внешний IP LoadBalancer’а</strong> (например, AWS NLB) — <strong>L4</strong></p>
</li>
<li>
<p>🚪 Он перенаправляет трафик на NodePort внутри кластера (все ноды слушают нужный порт) — <strong>L4</strong></p>
</li>
<li>
<p>📦 Попадает на pod с <strong>Ingress Controller’ом (например, NGINX)</strong> — теперь включается <strong>L7</strong></p>
</li>
<li>
<p>🧠 NGINX смотрит:</p>
</li>
</ol>
<p>• Host: app.example.com</p>
<p>• Path: /login</p>
<ol>
<li>🛣 Направляет трафик на нужный backend-сервис (например, auth-service) — уже внутри кластера</li>
</ol>
<hr />
<p><strong>🔁 Схема</strong></p>
<pre><code>    [ Client ]
        |
    [ L4 LoadBalancer ]  ← external (AWS NLB, GCP LB)
        |
    [ NodePort Service ] ← kube-proxy, iptables (L4)
        |
    [ Ingress Controller Pod ] ← nginx, envoy (L7)
        |
    [ Target App Service / Pod ]
</code></pre>
<hr />
<h6 id="service-mesh-istio">🤓 А если Service Mesh (например, Istio)?</h6>
<p>• Istio <strong>вставляет L7-прокси (Envoy)</strong> <em>перед каждым pod’ом</em></p>
<p>• Трафик идёт:</p>
<p>• L4 → Ingress Gateway (L7)</p>
<p>• Потом между подами тоже L7 → полный контроль, трассировка, канареечные релизы и т.п.</p>
<hr />
<h6 id="_21">🧠 Резюме</h6>
<table>
<thead>
<tr>
<th><strong>Компонент</strong></th>
<th><strong>Уровень</strong></th>
<th><strong>Назначение</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>LoadBalancer Service</td>
<td>L4</td>
<td>Доступ снаружи кластера</td>
</tr>
<tr>
<td>NodePort / ClusterIP</td>
<td>L4</td>
<td>Роутинг на pod’ы внутри</td>
</tr>
<tr>
<td>Ingress Controller</td>
<td>L7</td>
<td>HTTP/HTTPS маршрутизация</td>
</tr>
<tr>
<td>Service Mesh</td>
<td>L7</td>
<td>Продвинутая маршрутизация между подами</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="tcp-vs-udp">TCP vs UDP. Разница</h3>
<ul>
<li><strong>TCP</strong> — протокол с гарантией доставки, устанавливает соединение перед передачей пакетов.</li>
<li><strong>UDP</strong> — не устанавливает соединение, работает быстрее, не гарантирует доставку. Используется для потокового видео, DNS и других приложений, где важна скорость.</li>
</ul>
<h3 id="tcp-handshake">Как происходит TCP-handshake?</h3>
<p><strong>Кратко:</strong>
1. Клиент отправляет SYN с seq=A.
2. Сервер отвечает SYN+ACK с seq=B и ack=A+1.
3. Клиент отправляет ACK с seq=A+1 и ack=B+1.</p>
<p><strong>Подробно:</strong>
1. Клиент отправляет сегмент с SYN и случайным seq (A).
2. Сервер запоминает seq клиента, выделяет сокет, отправляет SYN+ACK (seq=B, ack=A+1) и переходит в SYN-RECEIVED. При ошибке — RST.
3. Клиент получает SYN+ACK, запоминает seq сервера и отправляет ACK. Переходит в ESTABLISHED. Если получил RST — завершает попытку. При таймауте — повтор.
4. Сервер при получении ACK переходит в ESTABLISHED. Если нет ACK — закрывает соединение.</p>
<h3 id="https">Как работают сертификаты? Как подтверждается соединение? (https соединение)</h3>
<p>Процесс работает следующим образом:</p>
<ol>
<li>Браузер или сервер пытается подключиться к веб-сайту (веб-серверу), защищенному с помощью SSL.</li>
<li>Браузер или сервер запрашивает идентификацию у веб-сервера.</li>
<li>В ответ веб-сервер отправляет браузеру или серверу копию своего SSL-сертификата и публичный ключ.</li>
<li>Браузер или сервер проверяет, является ли этот SSL-сертификат доверенным. У него уже зашиты сервера с помощью которых нужно производить проверку, с помощью центров сертификации. Если это так, он сообщает об этом веб-серверу. Генерирует сенасовый ключ, шифрует пебличным ключом и отправляет на сервер.</li>
<li>Сеервер расшифровывает сообщение и сохраняет сеансовый ключ. Затем веб-сервер возвращает подтверждение с цифровой подписью и начинает сеанс, зашифрованный с использованием SSL.</li>
<li>Зашифрованные данные используются совместно браузером или сервером и веб-сервером.</li>
</ol>
<h3 id="ssl-">Опиши принцип работы ssl-шифрования</h3>
<p>В основе любого метода шифрования лежит ключ. Ключ — это способ зашифровать или расшифровать сообщение. В работе SSL-сертификата участвуют три ключа: публичный, приватный и сеансовый.</p>
<p><strong>Публичный</strong> ключ зашифровывает сообщение.</p>
<p>Браузер использует его, когда нужно отправить пользовательские данные серверу. Например, после того как вы ввели данные банковской карты и нажали «Оплатить». Этот ключ виден всем, браузер прикрепляет его к сообщению.</p>
<p><strong>Приватный</strong> ключ расшифровывает сообщение.</p>
<p>Его использует сервер, когда получает сообщение от браузера. Этот ключ хранится на сервере и никогда не передаётся вместе с сообщением.</p>
<p><strong>Сеансовый</strong> ключ одновременно зашифровывает и расшифровывает сообщения.</p>
<p>Браузер генерирует его на время, которое пользователь проводит на сайте. Стоит пользователю закрыть вкладку, сеанс закончится и ключ перестанет работать.</p>
<p>Публичный и приватный ключи генерируются один раз при создании запроса на выпуск сертификата. Поэтому приватный ключ нужно хранить осторожно. Если ключ попадёт в руки другому человеку, он сможет расшифровывать сообщения, а вам придётся переустанавливать сертификат.</p>
<p><strong>Шифрование с двумя разными ключами называют асимметричным.</strong> Использовать такой метод более безопасно, но медленно. Поэтому браузер и сервер используют его один раз: чтобы создать сеансовый ключ.</p>
<p><strong>Шифрование с одним ключом называют симметричным.</strong> Этот метод удобен, но не так безопасен. Поэтому браузер и делает уникальный ключ для каждого сеанса вместо того, чтобы хранить его на сервере.</p>
<p>Симметричное и асимметричное шифрование — это два основных метода шифрования данных. Они отличаются механизмом использования ключей, безопасностью и производительностью.</p>
<h3 id="_22">Симметричное шифрование</h3>
<p>🔑 <strong>Один ключ для шифрования и дешифрования</strong></p>
<p>В симметричном шифровании используется <strong>один и тот же ключ</strong> для шифрования и дешифрования данных.</p>
<h4 id="_23">Как работает?</h4>
<ol>
<li>Отправитель и получатель <strong>обмениваются секретным ключом</strong>.</li>
<li>Отправитель <strong>шифрует сообщение</strong> с помощью этого ключа.</li>
<li>Получатель <strong>расшифровывает сообщение</strong>, используя тот же ключ.</li>
</ol>
<h4 id="_24">Примеры алгоритмов:</h4>
<p>• <strong>AES (Advanced Encryption Standard)</strong> – широко используется в современных системах.
• <strong>DES (Data Encryption Standard)</strong> – устарел, но был стандартом в прошлом.
• <strong>3DES (Triple DES)</strong> – улучшенная версия DES.
• <strong>RC4</strong> – потоковый алгоритм, сейчас считается небезопасным.</p>
<h4 id="_25">Плюсы</h4>
<p>✅ Быстрое шифрование и дешифрование.
✅ Эффективно при работе с большими объемами данных.</p>
<h4 id="_26">Минусы</h4>
<p>❌ Необходимо <strong>безопасно передавать ключ</strong> между отправителем и получателем.
❌ Если ключ украдут, <strong>злоумышленник сможет расшифровать данные</strong>.</p>
<h3 id="_27">Асимметричное шифрование</h3>
<p>🔑 <strong>Два разных ключа: публичный и приватный</strong></p>
<p>В асимметричном шифровании используются <strong>пара ключей</strong>:</p>
<p>• <strong>Публичный ключ</strong> – используется для шифрования.
• <strong>Приватный ключ</strong> – используется для дешифрования.</p>
<h4 id="_28">Как работает?</h4>
<ol>
<li><strong>Отправитель получает публичный ключ</strong> получателя.</li>
<li>Отправитель <strong>шифрует данные</strong> с помощью <strong>публичного ключа</strong>.</li>
<li>Получатель <strong>дешифрует данные</strong> с помощью <strong>приватного ключа</strong>.</li>
</ol>
<h4 id="_29">Примеры алгоритмов:</h4>
<p>• <strong>RSA (Rivest-Shamir-Adleman)</strong> – один из самых распространенных алгоритмов.
• <strong>ECC (Elliptic Curve Cryptography)</strong> – более безопасный при меньших размерах ключей.
• <strong>DSA (Digital Signature Algorithm)</strong> – используется для цифровых подписей.</p>
<h4 id="_30">Плюсы</h4>
<p>✅ <strong>Не нужно передавать секретный ключ</strong>, только публичный.
✅ <strong>Безопаснее</strong>, так как взлом требует вычисления обратного преобразования (например, факторизации больших чисел).</p>
<h4 id="_31">Минусы</h4>
<p>❌ <strong>Медленнее</strong>, чем симметричное шифрование (из-за сложных математических операций).
❌ <strong>Менее эффективно</strong> при обработке больших объемов данных.</p>
<h3 id="_32">Основные отличия</h3>
<table>
<thead>
<tr>
<th></th>
<th><strong>Симметричное шифрование</strong></th>
<th><strong>Асимметричное шифрование</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>🔑 <strong>Ключи</strong></td>
<td>Один общий ключ</td>
<td>Пара ключей (публичный + приватный)</td>
</tr>
<tr>
<td>⚡ <strong>Скорость</strong></td>
<td>Быстрее</td>
<td>Медленнее</td>
</tr>
<tr>
<td>🔐 <strong>Безопасность</strong></td>
<td>Уязвимо при передаче ключа</td>
<td>Более безопасно</td>
</tr>
<tr>
<td>🔁 <strong>Использование</strong></td>
<td>Хорошо для шифрования больших данных</td>
<td>Используется для ключевого обмена и цифровых подписей</td>
</tr>
<tr>
<td>### Когда что использовать?</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>📌 <strong>Симметричное шифрование</strong> – для быстрого и эффективного шифрования больших объемов данных (например, файлов, дисков, VPN).</p>
<p>📌 <strong>Асимметричное шифрование</strong> – для безопасного обмена ключами, цифровых подписей, шифрования электронной почты (PGP), TLS/SSL в интернете.</p>
<p>💡 <strong>Гибридный подход</strong>: в реальных системах часто используется комбинация. Например, в HTTPS клиент и сервер сначала <strong>обмениваются ключами через асимметричное шифрование (RSA)</strong>, а затем используют <strong>симметричное шифрование (AES) для передачи данных</strong>.</p>
<h3 id="_33">Вывод</h3>
<p>• <strong>Симметричное шифрование быстрее</strong>, но требует безопасного обмена ключами.
• <strong>Асимметричное шифрование медленнее</strong>, но решает проблему передачи ключей.
• <strong>В реальных сценариях</strong> они часто используются вместе!</p>
<h3 id="_34">Что такое таблица маршрутизации?</h3>
<p>Это таблица, содержащая маршруты для отправки пакетов в разные подсети и сети. Используется для выбора интерфейса и следующего хопа (gateway).</p>
<p><strong>Проверка маршрута до IP 1.2.3.4:</strong></p>
<pre><code class="language-bash">traceroute 1.2.3.4
ip route get 1.2.3.4
</code></pre>
<h3 id="iptables-snat-dnat">IPTables: SNAT, DNAT, Маскарадинг</h3>
<p><strong>Основные таблицы:</strong></p>
<h4 id="1-filter-table">1. Filter Table</h4>
<ul>
<li>Используется по умолчанию.</li>
<li>Для фильтрации пакетов (DROP, LOG, ACCEPT, REJECT).</li>
<li>Цепочки:</li>
<li>INPUT (пакеты для сервера)</li>
<li>OUTPUT (исходящие локальные)</li>
<li>FORWARD (транзитные)</li>
</ul>
<h4 id="2-nat-table">2. NAT Table</h4>
<ul>
<li>Для преобразования сетевых адресов.</li>
<li>Только первый пакет потока проходит через эту таблицу.</li>
<li>Цепочки:</li>
<li>PREROUTING — DNAT</li>
<li>POSTROUTING — SNAT</li>
<li>OUTPUT — NAT для локально сгенерированных</li>
</ul>
<h4 id="3-mangle-table">3. Mangle Table</h4>
<ul>
<li>Для изменения заголовков: TOS, TTL, MARK и др.</li>
<li>Цепочки:</li>
<li>PREROUTING, INPUT, FORWARD, OUTPUT, POSTROUTING</li>
</ul>
<h4 id="4-raw-table">4. Raw Table</h4>
<ul>
<li>До connection tracking (state machine)</li>
<li>Цепочки: PREROUTING, OUTPUT</li>
</ul>
<h4 id="iptables">Цепочки IPTables:</h4>
<ul>
<li>PREROUTING — до маршрутизации</li>
<li>INPUT — для сервера</li>
<li>FORWARD — транзитные</li>
<li>OUTPUT — локальные исходящие</li>
<li>POSTROUTING — после маршрутизации</li>
</ul>
<h3 id="1012153522">Что означает запись 10.12.15.35/22?</h3>
<p>CIDR-блок <code>/22</code>:
- Маска: <code>255.255.252.0</code>
- Диапазон: <code>10.12.12.0 – 10.12.15.255</code>
- Пример частной сети с 1024 адресами, 64 подсети.</p>
<h3 id="dns">DNS</h3>
<p><strong>Структура записи DNS (RR):</strong></p>
<ul>
<li>
<p>NAME — домен</p>
</li>
<li>
<p>TYPE — тип записи (A, AAAA, MX, CNAME...)</p>
</li>
<li>
<p>CLASS — тип сети (обычно IN)</p>
</li>
<li>
<p>TTL — срок жизни в кэше</p>
</li>
<li>
<p>RDLEN — длина данных</p>
</li>
<li>
<p>RDATA — содержимое</p>
</li>
</ul>
<p><strong>Типы записей:</strong></p>
<ul>
<li>
<p>A — IPv4 адрес  </p>
</li>
<li>
<p>AAAA — IPv6 адрес</p>
</li>
<li>
<p>CNAME — псевдоним (каноническое имя)</p>
</li>
<li>
<p>MX — почтовый обменник</p>
</li>
<li>
<p>NS — DNS сервер зоны</p>
</li>
<li>
<p>PTR — обратная запись IP → имя</p>
</li>
<li>
<p>SOA — начальная запись зоны</p>
</li>
<li>
<p>SRV — серверы сервисов (например, для Jabber, Active Directory)</p>
</li>
</ul>
<h4 id="_35">Рекурсивный и не рекурсивный запрос</h4>
<p>При рекурсивном запросе Вы просто обращаетесь к серверу, а он, если не найдет у себя нужной записи, идет к другим серверам и спрашивает у них.</p>
<p>Нерекурсивный dns сервер в данном случае просто говорит - "я не знаю, но спроси у этого сервера". И клиент будет слать ещё один запрос. Понятное дело, что при медленном интернете первый вариант лучше.</p>
<h3 id="_36">Сетевые утилиты</h3>
<h4 id="_37">Проверка открытых портов и сокетов</h4>
<pre><code class="language-bash">ss -tlpn
</code></pre>
<h4 id="_38">Проверка сетевых интерфейсов</h4>
<pre><code class="language-bash">ip a
</code></pre>
<h4 id="_39">Проверка маршрутов</h4>
<pre><code class="language-bash">ip route
</code></pre>
<h3 id="netcat-nc">NetCat (nc)</h3>
<p><strong>Проверка порта:</strong></p>
<pre><code class="language-bash">nc -vn 192.168.1.100 12345
</code></pre>
<p><strong>Сканирование портов:</strong></p>
<pre><code class="language-bash">nc -vnz 192.168.1.100 20-24
</code></pre>
<p>Источник: https://habr.com/ru/post/336596/</p>
<h3 id="nmap">Nmap</h3>
<p><strong>Поиск всех хостов в подсети:</strong></p>
<pre><code class="language-bash">nmap -sP 192.168.1.0/24
nmap -sn 192.168.1.0/24
</code></pre>
<h3 id="tcpdump">Tcpdump</h3>
<p><strong>Пример:</strong></p>
<pre><code class="language-bash">tcpdump -i any -s0
</code></pre>
<ul>
<li><code>-i</code> — интерфейс</li>
<li><code>-s</code> — размер захвата пакета (0 — весь)</li>
</ul>
<hr />
<h2 id="docker_1">Docker</h2>
<h4 id="docker-docker">Как внутри Docker понять что ты в Docker?</h4>
<h5 id="1-dockerenv">1. Проверка файла /.dockerenv</h5>
<pre><code>test -f /.dockerenv &amp;&amp; echo &quot;Inside Docker&quot;
</code></pre>
<p>• <strong>Плюсы</strong>: Надёжно, этот файл создаёт Docker при запуске контейнера.
• <strong>Минусы</strong>: Некоторые среды (например, Kubernetes) могут не создавать этот файл.</p>
<p>Также, если ты используешь другой runtime (containerd, Podman), файл может отсутствовать.</p>
<hr />
<h5 id="2-cgroup">2. Чтение cgroup</h5>
<pre><code>cat /proc/1/cgroup
</code></pre>
<p>Если ты видишь что-то вроде:</p>
<pre><code>0::/docker/abc123...
</code></pre>
<p>или</p>
<pre><code>1:name=systemd:/docker/abc123
</code></pre>
<p>— то ты, скорее всего, в Docker.</p>
<p><strong>Пример проверки в bash:</strong></p>
<pre><code>grep -qE &quot;/docker/|/kubepods/&quot; /proc/1/cgroup &amp;&amp; echo &quot;Inside container&quot;
</code></pre>
<p>• kubepods → ты внутри Kubernetes.</p>
<p>• docker → в Docker напрямую.</p>
<hr />
<h5 id="3-hostname">3. Проверка hostname</h5>
<p>Иногда можно увидеть, что hostname = короткий случайный hash (Docker генерирует его как container ID). Пример:</p>
<pre><code>hostname
</code></pre>
<p>Может быть что-то вроде 0a1b2c3d4e5f.</p>
<p>📌 Не надёжный способ, но может быть косвенным признаком.</p>
<hr />
<h5 id="4-cgroups">⚠️ 4. Проверка ограничений cgroups</h5>
<p>Если внутри контейнера у тебя:</p>
<pre><code>cat /sys/fs/cgroup/memory/memory.limit_in_bytes
</code></pre>
<p>И значение <strong>сильно меньше</strong>, чем у твоей машины (например, 512MB или 1GB), ты, вероятно, в контейнере с ограничением ресурсов.</p>
<hr />
<h5 id="_40">🧠 Какой способ лучше?</h5>
<table>
<thead>
<tr>
<th><strong>Метод</strong></th>
<th><strong>Надёжность</strong></th>
<th><strong>Комментарий</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>/.dockerenv</td>
<td>✅ Очень высокая</td>
<td>Стандарт для Docker</td>
</tr>
<tr>
<td>/proc/1/cgroup</td>
<td>✅ Очень высокая</td>
<td>Работает и в k8s</td>
</tr>
<tr>
<td>hostname</td>
<td>⚠️ Низкая</td>
<td>Косвенный признак</td>
</tr>
<tr>
<td>cgroup limits</td>
<td>✅</td>
<td>Полезно для анализа, но не строго</td>
</tr>
</tbody>
</table>
<hr />
<p><strong>🛠 Рекомендуемый способ (универсальный скрипт)</strong></p>
<pre><code>if [ -f /.dockerenv ] || grep -qa 'docker\|kubepods' /proc/1/cgroup; then
    echo &quot;Running inside a container&quot;
else
    echo &quot;Not in container&quot;
fi
</code></pre>
<h3 id="cmd-entrypoint">В чем отличие CMD и ENTRYPOINT</h3>
<p>Эти инструкции Dockerfile задают команду, исполняемую при запуске контейнера. При их использовании есть несколько правил, например:</p>
<ul>
<li>Должна быть минимум одна из них, CMD или ENTRYPOINT, в Dockerfile.</li>
<li>Если контейнер используется как исполняемый файл — ENTRYPOINT должна быть определена.</li>
<li>Если контейнер запускается с другими аргументами — CMD будет переопределена.</li>
</ul>
<p>Инструкция RUN позволяет вам установить ваше приложение и необходимые для него пакеты. Он выполняет любые команды поверх текущего изображения и создает новый слой, фиксируя результаты. Часто в Dockerfile вы найдете несколько инструкций RUN.</p>
<p>Хорошей иллюстрацией инструкции RUN может быть установка нескольких пакетов систем контроля версий:</p>
<pre><code>RUN apt-get update &amp;&amp; apt-get install -y \
  bzr \
  cvs \
  git \
  mercurial \
  subversion
</code></pre>
<p>Обратите внимание, что <code>apt-get update</code>и <code>apt-get install</code>выполняются в одной инструкции RUN. Это делается для того, чтобы убедиться, что будут установлены самые последние пакеты. Если бы <code>apt-get install</code>это была отдельная инструкция RUN, то она бы повторно использовала слой, добавленный <code>apt-get update</code>, который мог быть создан давным-давно.</p>
<p>Инструкция CMD позволяет вам установить команду по <em>умолчанию</em> , которая будет выполняться только тогда, когда вы запускаете контейнер без указания команды. Если контейнер Docker запускается с командой, команда по умолчанию будет игнорироваться. Если Dockerfile содержит более одной инструкции CMD, все инструкции CMD, кроме последней, игнорируются.</p>
<p>CMD имеет три формы:</p>
<ul>
<li>
<p><code>CMD ["executable","param1","param2"]</code></p>
<p>(исполнительная форма, предпочтительнее)</p>
</li>
<li>
<p><code>CMD ["param1","param2"]</code><em>exec</em></p>
<p>(устанавливает дополнительные параметры по умолчанию для ENTRYPOINT в форме</p>
</li>
<li>
<p><code>CMD command param1 param2</code></p>
<p>(форма оболочки)</p>
<p><code>docker run -it &lt;image&gt; /bin/bash</code> - тут при наличии CMD он будет проигнорирован, и будет запущен баш</p>
</li>
</ul>
<p>Инструкция ENTRYPOINT позволяет настроить контейнер, который будет работать как исполняемый файл. Он похож на CMD, потому что также позволяет указать команду с параметрами. Разница заключается в том, что команда ENTRYPOINT и параметры не игнорируются, когда контейнер Docker запускается с параметрами командной строки. (Есть способ игнорировать ENTTRYPOINT, но вряд ли вы это сделаете.)</p>
<p>Докерфайл</p>
<pre><code>ENTRYPOINT [&quot;/bin/echo&quot;, &quot;Hello&quot;]
CMD [&quot;world&quot;]
</code></pre>
<p>когда контейнер запускается, как <code>docker run -it &lt;image&gt;</code>будет производиться вывод</p>
<pre><code>Hello world

</code></pre>
<p>но когда контейнер запускается, <code>docker run -it &lt;image&gt; John</code>это приведет к</p>
<pre><code>Hello John
</code></pre>
<ul>
<li>Краткий ответ</li>
</ul>
<p>cmd подставится после entrypoint при запуске. Тем самым можно запускать контейнер с нужными параметрами.</p>
<p>То есть в entrypoint можно передать бинарь, а в cmd передать параметры.</p>
<p>CMD может перетереться просто.</p>
<h3 id="docker_2">Что такое Docker? Как он устроен? На каких технологиях основывается?</h3>
<p>Docker — это платформа контейнеризации, позволяющая запускать приложения в изолированной среде (контейнере).</p>
<p><strong>Технологии:</strong>
- cgroups и namespaces (пространства имён) для изоляции
- union файловые системы (OverlayFS)
- контейнерный движок containerd/runc</p>
<h3 id="docker_3">Пространства имён, используемые Docker:</h3>
<ul>
<li><strong>pid</strong> — изоляция процессов</li>
<li><strong>net</strong> — отдельные сетевые интерфейсы</li>
<li><strong>ipc</strong> — управление IPC-ресурсами (взаимодействие процессов)</li>
<li><strong>mnt</strong> — управление точками монтирования</li>
<li><strong>uts</strong> — имя хоста и домена (hostname)</li>
</ul>
<h3 id="docker-vmware">Разница между Docker и VMware</h3>
<ul>
<li>Docker — уровень ОС (использует ядро хоста, быстрая и лёгкая изоляция)</li>
<li>VMware — полноценная виртуализация (каждая ВМ — своя ОС, медленнее, ресурсоёмко)</li>
</ul>
<h3 id="docker_4">Зачем нужен Docker? Какие проблемы решает?</h3>
<ul>
<li>Решает проблему "работает у меня, не работает у тебя"</li>
<li>Позволяет создавать воспроизводимую среду</li>
<li>Быстрое развёртывание и масштабирование приложений</li>
</ul>
<h3 id="dockerfile">Основные директивы Dockerfile</h3>
<ul>
<li><code>FROM</code> — базовый образ</li>
<li><code>RUN</code> — выполнение команд в контейнере при сборке</li>
<li><code>COPY</code> / <code>ADD</code> — копирование файлов</li>
<li><code>CMD</code> / <code>ENTRYPOINT</code> — команда запуска</li>
<li><code>EXPOSE</code> — открытие портов</li>
<li><code>ENV</code> — переменные окружения</li>
<li><code>WORKDIR</code> — рабочая директория</li>
</ul>
<h3 id="dockerfile-docker-compose">Разница между Dockerfile и docker-compose</h3>
<ul>
<li><strong>Dockerfile</strong> — инструкция для создания образа</li>
<li><strong>docker-compose.yml</strong> — инструмент для описания и запуска многоконтейнерных приложений (описывает сервисы, сети, тома)</li>
</ul>
<h3 id="docker-image-registry">Как перенести docker image с одной машины на другую без registry?</h3>
<pre><code class="language-bash">docker save myimage &gt; image.tar
scp image.tar user@remote:/tmp/
docker load &lt; image.tar
</code></pre>
<p>Или:</p>
<pre><code class="language-bash">docker export &lt;container&gt; &gt; file.tar
# и далее docker import
</code></pre>
<h3 id="best-practices-dockerfile">Best practices по написанию Dockerfile и безопасности контейнеров</h3>
<ul>
<li>Использовать минимальные образы (например, <code>alpine</code>)</li>
<li>Указывать конкретные версии пакетов</li>
<li>Не использовать root внутри контейнера</li>
<li>Минимизировать количество слоёв</li>
<li>Удалять временные файлы после установки пакетов</li>
<li>Не хранить секреты в образах</li>
<li>Использовать <code>USER</code> для запуска приложений</li>
<li>Ограничивать доступ к хосту (AppArmor, seccomp, read-only FS)</li>
</ul>
<h3 id="docker_5">Сетевые драйверы Docker</h3>
<ul>
<li><strong>bridge</strong> — дефолтная сеть, контейнеры в одной подсети, могут общаться между собой через виртуальный bridge-интерфейс</li>
<li><strong>host</strong> — контейнер использует сетевой стек хоста</li>
<li><strong>macvlan</strong> — каждому контейнеру назначается отдельный MAC-адрес, прямой доступ к сети</li>
<li><strong>overlay</strong> — сеть между несколькими хостами (используется в Swarm)</li>
<li><strong>swarm</strong> — кластерная сеть для контейнеров, работающих в Swarm-режиме</li>
</ul>
<h3 id="arg-env">В чем отличие ARG от ENV?</h3>
<p><strong>ENV</strong> позволяет создавать переменные окружения, которые будут работать во время работы контейнера.</p>
<p><strong>ARG</strong> позволяет закинуть переменные, которые будут доступны во время сборки. Но они недоступны в контейнере. Однако через <code>ARG</code> можно задавать значения переменных по умолчанию для <code>ENV</code></p>
<h3 id="docker_6">🧱 Как работают слои в Docker</h3>
<p>Docker использует <strong>многоуровневую файловую систему (Union FS)</strong> — это означает, что каждый RUN, COPY, ADD создаёт <strong>отдельный слой</strong>, который накладывается поверх предыдущих.</p>
<p><strong>✔️ Основные моменты:</strong></p>
<p>• Каждый слой <strong>неизменяемый (immutable)</strong>.
• Новый слой <strong>ссылается на предыдущие</strong> и добавляет или переопределяет файлы.
• Итоговый образ — это <strong>stack слоёв</strong>:</p>
<pre><code>FROM python:3.10      # базовый слой
RUN apt install curl  # + новый слой с curl
COPY . /app           # + слой с приложением
</code></pre>
<hr />
<p><strong>🔗 Где тут хардлинки и симлинки?</strong></p>
<p><strong>⚙️ При сборке Docker образа:</strong></p>
<p>• Docker использует <strong>copy-on-write</strong> и может применять <strong>хардлинки</strong> на уровне хостовой файловой системы (например, OverlayFS).</p>
<p>• Это позволяет <strong>экономить диск</strong> — одинаковые файлы <strong>не дублируются</strong>, а представляются как ссылки на один и тот же inode.</p>
<hr />
<p><strong>🧷 Разница между хардлинками и симлинками:</strong></p>
<table>
<thead>
<tr>
<th><strong>Тип ссылки</strong></th>
<th><strong>Хардлинк</strong></th>
<th><strong>Симлинк</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Что ссылается</td>
<td>На inode (сам файл)</td>
<td>На путь (имя файла)</td>
</tr>
<tr>
<td>После удаления оригинала</td>
<td>Файл остаётся</td>
<td>Ссылка “битая”</td>
</tr>
<tr>
<td>Видна в ls -li</td>
<td>Да, имеет одинаковый inode</td>
<td>Нет, свой inode</td>
</tr>
<tr>
<td>Используется в Docker</td>
<td>Да, но <strong>внутренне</strong>, на уровне слоёв</td>
<td>Иногда в COPY или вручную</td>
</tr>
</tbody>
</table>
<hr />
<p><strong>📁 Пример использования симлинков в Docker</strong></p>
<pre><code>RUN ln -s /usr/bin/python3 /usr/bin/python
</code></pre>
<p>• Создаётся симлинк внутри образа.</p>
<p>• Работает как обычный путь, но при копировании между слоями — это просто символическая ссылка.</p>
<hr />
<h4 id="_41">🧠 Почему это важно на собеседовании</h4>
<p>Ты можешь сказать примерно так:</p>
<blockquote>
<p>Docker использует слоистую файловую систему, где каждый слой строится на предыдущем. Это обеспечивает кэширование и повторное использование слоёв. На уровне системы, Docker может использовать хардлинки между слоями, чтобы экономить диск и ускорить сборку. Симлинки используются внутри образов, но не влияют на кэш слоёв напрямую.</p>
</blockquote>
<hr />
<p><strong>💡 Хинт для оптимизации:</strong></p>
<p>Чтобы <strong>кэш Docker работал эффективно</strong>, нужно:</p>
<p>• Сначала ставить зависимости (requirements.txt) → потом копировать исходники.</p>
<p>• Объединять RUN-команды.</p>
<p>• Удалять ненужные файлы внутри одного слоя.</p>
<p>Хочешь, покажу пример Dockerfile до и после оптимизации с учётом слоёв и кэша?</p>
<hr />
<h2 id="bash">Bash</h2>
<h3 id="access-csv-timestamp-status-url-user-agent">Обработка access логов (CSV): timestamp, status, url, user-agent</h3>
<h4 id="url">Количество уникальных URL:</h4>
<pre><code class="language-bash">cut -d',' -f3 access.csv | sort | uniq | wc -l
</code></pre>
<h4 id="url_1">Количество запросов на каждый URL:</h4>
<pre><code class="language-bash">cut -d',' -f3 access.csv | sort | uniq -c | sort -nr
</code></pre>
<h4 id="400-404-url">Количество 400-404 по каждому URL:</h4>
<pre><code class="language-bash">awk -F',' '$2 ~ /^40[0-4]$/ {print $3}' access.csv | sort | uniq -c | sort -nr
</code></pre>
<h3 id="set-eu-o-pipefail">Что делает <code>set -eu -o pipefail</code>?</h3>
<p>Используется в начале bash-скриптов для надёжности:
- <code>set -e</code> — завершает скрипт, если любая команда завершилась с ошибкой.
- <code>set -u</code> — завершает скрипт, если используется необъявленная переменная.
- <code>set -o pipefail</code> — если одна из команд в пайпе завершилась с ошибкой, скрипт завершится.
- <code>set -x</code> (дополнительно) — выводит команды в stdout перед выполнением (для отладки).</p>
<h3 id="50">Как выполнить одну и ту же команду на 50 серверах?</h3>
<p><strong>Варианты:</strong>
- С помощью <code>ssh</code> в цикле:</p>
<pre><code class="language-bash">for host in $(cat hosts.txt); do
  ssh user@$host 'команда' &amp;
done
wait
</code></pre>
<ul>
<li>Использовать <code>pssh</code> (parallel-ssh):</li>
</ul>
<pre><code class="language-bash">pssh -h hosts.txt -l user -i 'команда'
</code></pre>
<ul>
<li>Использовать Ansible:</li>
</ul>
<pre><code class="language-bash">ansible all -i hosts.ini -m shell -a 'команда'
</code></pre>
<ul>
<li>Использовать <code>tmux</code>, <code>dsh</code>, <code>fabric</code> и другие инструменты массового управления.</li>
</ul>
<h2 id="_42">Балансировщики нагрузки</h2>
<h3 id="_43">Зачем нужны?</h3>
<ul>
<li>Распределение нагрузки между приложениями</li>
<li>Высокая доступность и отказоустойчивость</li>
<li>Масштабируемость приложений</li>
</ul>
<h3 id="nginx">Nginx</h3>
<h4 id="-">Ошибки по статус-кодам</h4>
<ul>
<li><strong>5xx</strong> — ошибка на стороне сервера (например, 500)</li>
<li><strong>4xx</strong> — ошибка на стороне клиента (например, 400, 404, 413 — превышен размер запроса)</li>
</ul>
<h4 id="http-">HTTP-методы, изменяющие состояние</h4>
<ul>
<li><code>POST</code>, <code>PUT</code>, <code>DELETE</code></li>
</ul>
<h4 id="nginx-c10k">Как Nginx решает проблему C10K?</h4>
<p>За счёт событийно-ориентированной архитектуры:
- неблокирующая модель
- master + многопроцессная модель workers
- каждый worker — однопоточный, обрабатывает тысячи соединений
- минимизация переключений контекста (в отличие от Apache)</p>
<h4 id="_44">Важные параметры</h4>
<pre><code class="language-nginx">worker_processes auto;
worker_connections 1024;
# max_clients = worker_processes * worker_connections
</code></pre>
<h4 id="location">Как выбирается location?</h4>
<p>Порядок:
1. <code>=</code> — точное совпадение
2. <code>^~</code> — приоритетный префикс
3. <code>~</code> / <code>~*</code> — регулярные выражения (учитывает/не учитывает регистр)
4. Без модификаторов — префиксные совпадения</p>
<h4 id="location_1">Как дебажить location?</h4>
<ul>
<li>Логи: <code>access.log</code>, <code>error.log</code></li>
<li>Временный вывод переменных через <code>return</code>, <code>add_header</code></li>
<li>Консоль разработчика браузера</li>
<li>Проверка фактического URI и проксируемого пути</li>
</ul>
<h4 id="_45">Что реально приходит на приложение?</h4>
<p>Проверить на стороне приложения (например, на <code>localhost:3000</code>) фактический URL запроса, заголовки и путь (<code>X-Forwarded-For</code>, <code>X-Real-IP</code>, <code>Host</code>)</p>
<h4 id="nginx-apache">Преимущества Nginx перед Apache</h4>
<ul>
<li>Лучшая производительность при отдаче статики (x2.5)</li>
<li>Эффективная архитектура (event loop против процессов)</li>
<li>Меньшее потребление памяти</li>
<li>Часто используется как frontend прокси к Apache/php-fpm и др.</li>
</ul>
<h4 id="_46">Могут ли работать вместе?</h4>
<p>Да. Пример связки:
- Nginx — фронтенд, отдает статику, проксирует
- Apache — бэкенд, генерирует динамику</p>
<h3 id="haproxy">HAProxy</h3>
<ul>
<li>Высокопроизводительный L4/L7-балансировщик</li>
<li>Поддержка TCP и HTTP</li>
<li>Поддержка ACL, health checks, sticky sessions</li>
<li>Часто используется в продакшене как фронтенд балансер</li>
</ul>
<h3 id="envoy">Envoy</h3>
<ul>
<li>Прокси и сервис-меш от Lyft</li>
<li>Поддерживает HTTP/2, gRPC, TLS termination</li>
<li>Используется в Istio</li>
<li>Расширенные возможности маршрутизации и мониторинга</li>
</ul>
<h3 id="google-cloud-load-balancer">Google Cloud Load Balancer</h3>
<ul>
<li>Балансировка на уровне L4 и L7</li>
<li>Автоматическое масштабирование и Anycast IP</li>
<li>Интеграция с Cloud CDN, Cloud Armor</li>
<li>Управляется через GCP Console или <code>gcloud</code></li>
</ul>
<h3 id="aws-load-balancers">AWS Load Balancers</h3>
<h4 id="classic-load-balancer-clb">Classic Load Balancer (CLB)</h4>
<ul>
<li>Устаревший, L4/L7</li>
</ul>
<h4 id="application-load-balancer-alb">Application Load Balancer (ALB)</h4>
<ul>
<li>L7 балансировка (HTTP/HTTPS)</li>
<li>Поддержка path-based, host-based routing</li>
</ul>
<h4 id="network-load-balancer-nlb">Network Load Balancer (NLB)</h4>
<ul>
<li>L4 балансировка (TCP/UDP)</li>
<li>Высокая пропускная способность и низкая задержка</li>
</ul>
<p>Обычно используется вместе с Auto Scaling и ECS/EKS</p>
<h2 id="vs-">Прокси vs Реверс-прокси</h2>
<h3 id="forward-proxy">Что такое прокси (forward proxy)?</h3>
<p>Прокси-сервер действует от имени клиента:
- Клиент отправляет запрос не напрямую к целевому серверу, а через прокси.
- Прокси перенаправляет запрос и возвращает ответ обратно клиенту.
- Пример: сотрудник офиса выходит в интернет через корпоративный прокси-сервер.</p>
<p><strong>Используется для:</strong>
- Контроля доступа (фильтрация)
- Кеширования
- Анонимизации
- Обхода блокировок</p>
<h3 id="-reverse-proxy">Что такое реверс-прокси (reverse proxy)?</h3>
<p>Реверс-прокси действует от имени сервера:
- Клиент делает запрос на один публичный адрес.
- Реверс-прокси принимает запрос и перенаправляет его одному из внутренних серверов.
- Ответ возвращается клиенту от имени прокси.</p>
<p><strong>Используется для:</strong>
- Балансировки нагрузки
- SSL termination
- Кеширования
- Ограничения доступа и аутентификации
- Защиты внутренних сервисов</p>
<h3 id="_47">Сравнение</h3>
<table>
<thead>
<tr>
<th>Характеристика</th>
<th>Прокси</th>
<th>Реверс-прокси</th>
</tr>
</thead>
<tbody>
<tr>
<td>Работает для кого?</td>
<td>От имени клиента</td>
<td>От имени сервера</td>
</tr>
<tr>
<td>Кто знает о нём?</td>
<td>Клиент</td>
<td>Сервер (а клиент — нет)</td>
</tr>
<tr>
<td>Основная задача</td>
<td>Доступ к внешним ресурсам</td>
<td>Защита и маршрутизация к внутренним ресурсам</td>
</tr>
<tr>
<td>Пример</td>
<td>Squid</td>
<td>Nginx, HAProxy, Envoy</td>
</tr>
<tr>
<td>## Kubernetes</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="architecture"><strong>Architecture</strong></h3>
<p>Kubernetes-кластер построен по распределённой архитектуре и состоит из двух основных типов компонентов: <strong>Control Plane</strong> (плоскость управления) и <strong>Worker Nodes</strong> (рабочие узлы). Эти части взаимодействуют между собой, обеспечивая автоматизированное развертывание контейнеров, масштабирование, балансировку нагрузки и восстановление после сбоев.</p>
<ul>
<li>
<p><strong>Control Plane</strong> — отвечает за глобальное управление кластером. Он принимает решения о размещении Pod’ов, отслеживает состояние системы и обеспечивает соответствие текущего состояния — желаемому. Включает в себя несколько ключевых компонентов:</p>
<ul>
<li><strong>kube-apiserver</strong> — центральная точка входа в кластер. Обрабатывает все REST-запросы (kubectl, контроллеры и т.д.), валидирует их и взаимодействует с другими компонентами через API.</li>
<li><strong>etcd</strong> — распределённое key-value хранилище, где сохраняется всё состояние кластера: манифесты объектов, конфигурации, секреты и др.</li>
<li><strong>kube-scheduler</strong> — определяет, на какие ноды размещать новые Pod’ы, основываясь на доступных ресурсах и заданных правилах.</li>
<li><strong>kube-controller-manager</strong> — управляет контроллерами (Deployment, ReplicaSet, Node и др.), следя за тем, чтобы система соответствовала желаемому состоянию.</li>
<li><em>(опционально)</em> <strong>cloud-controller-manager</strong> — взаимодействует с API облачного провайдера (например, AWS или GCP), управляя такими ресурсами, как балансировщики, маршруты и диски.</li>
</ul>
</li>
<li>
<p><strong>Worker Nodes</strong> — это узлы, на которых фактически запускаются контейнеры. Каждый node включает:</p>
<ul>
<li><strong>kubelet</strong> — агент, взаимодействующий с API Server и отвечающий за запуск и мониторинг Pod’ов на узле.</li>
<li><strong>container runtime</strong> (например, containerd, cri-o) — низкоуровневый компонент, запускающий контейнеры.</li>
<li><strong>kube-proxy</strong> — обеспечивает сетевую маршрутизацию между Pod’ами и доступ к сервисам, настраивая правила iptables/ipvs.</li>
</ul>
</li>
</ul>
<p>Таким образом, <strong>Control Plane</strong> управляет кластером как системой, а <strong>Worker Nodes</strong> исполняют рабочие нагрузки (контейнеры), подчиняясь этим правилам и решениям.</p>
<hr />
<h4 id="kubectl-apply">Что происходит при <code>kubectl apply</code></h4>
<ol>
<li>💬 Клиент <code>kubectl</code> считывает манифест:</li>
</ol>
<p><code>bash
   kubectl apply -f my-deployment.yaml</code></p>
<p>Считывается YAML-файл, описывающий желаемое состояние объекта (например, Deployment, Service и т.д.)</p>
<ol>
<li>📤 <code>kubectl</code> отправляет запрос в API Server:</li>
</ol>
<p>Манифест отправляется через HTTP-запрос к <strong>API Server</strong> — это центральная точка взаимодействия в Kubernetes.</p>
<ol>
<li>
<p>🔍 API Server сравнивает текущее и желаемое состояние:</p>
</li>
<li>
<p>API Server проверяет, существует ли объект уже в <code>etcd</code> (через свой внутренний слой хранения).</p>
</li>
<li>Если объект <strong>уже существует</strong> — выполняется <strong>\"patch\"</strong> (обновление), сохраняются только изменения.</li>
<li>Если объекта <strong>ещё нет</strong> — он создаётся с нуля.</li>
</ol>
<blockquote>
<p><code>kubectl apply</code> использует <strong>\"server-side apply\"</strong> или <strong>\"client-side apply\"</strong> (в зависимости от версии и флагов) — это способ вычислить, какие поля нужно обновить.</p>
</blockquote>
<ol>
<li>📦 <code>etcd</code> обновляет хранилище состояния:</li>
</ol>
<p>API Server сохраняет обновлённое состояние объекта в <strong>etcd</strong> — распределённой key-value базе.</p>
<ol>
<li>⚙️ Контроллеры приводят кластер к нужному состоянию:</li>
</ol>
<p>Если применён объект типа <code>Deployment</code>:
   - <strong>Deployment Controller</strong> обнаруживает изменения.
   - Создаёт или удаляет <strong>ReplicaSet</strong>.
   - ReplicaSet создаёт или удаляет <strong>Pod'ы</strong>.</p>
<ol>
<li>🔁 Scheduler размещает новые Pod'ы:</li>
</ol>
<p>Если нужно создать новые Pod'ы:
   - <strong>Scheduler</strong> выбирает подходящий <strong>Worker Node</strong>.
   - Назначает Pod на выбранный узел.</p>
<ol>
<li>🧩 Kubelet запускает контейнеры:</li>
</ol>
<p>На выбранной ноде:
   - <strong>Kubelet</strong> получает инструкции от API Server.
   - Запускает контейнеры через <strong>Container Runtime</strong> (например, containerd, cri-o, Docker).</p>
<ol>
<li>🌐 Kube Proxy настраивает сеть:</li>
</ol>
<p>Если объект включает в себя сервис или взаимодействие по сети:
   - <strong>Kube Proxy</strong> обновляет сетевые правила (iptables/ipvs).
   - Обеспечивает доступ к Pod'ам по сервису.</p>
<h3 id="qos-pod-quality-of-service-classes">QOS (Pod Quality of Service Classes)</h3>
<p>QoS-класс определяет приоритет Pod’а при вытеснении (eviction), а также влияет на поведение в случае давления по CPU/памяти.
(QoS) в Kubernetes — это один из ключевых механизмов, который влияет на то, как kubelet управляет Pod-ами, особенно при нехватке ресурсов.</p>
<p>В Kubernetes есть <strong>три класса QoS</strong>:</p>
<h4 id="1-guaranteed">1. Guaranteed</h4>
<p>✅ <strong>Наивысший приоритет, вытесняется в последнюю очередь.</strong></p>
<p><strong>Условия:</strong></p>
<p>• <strong>Для всех контейнеров в Pod-е заданы requests и limits, и они равны друг другу.</strong></p>
<pre><code>resources:
  requests:
    memory: &quot;512Mi&quot;
    cpu: &quot;500m&quot;
  limits:
    memory: &quot;512Mi&quot;
    cpu: &quot;500m&quot;
</code></pre>
<blockquote>
<p>Такой Pod получает гарантированный кусок ресурсов и защищён от вытеснения при OOM (Out of Memory) до последнего.</p>
</blockquote>
<h4 id="2-burstable">2. Burstable</h4>
<p>⚠️ <strong>Средний приоритет.</strong></p>
<p><strong>Условия:</strong></p>
<p>• У <strong>некоторых контейнеров</strong> заданы requests, и:</p>
<p>• либо они <strong>не равны limits</strong>,</p>
<p>• либо limits не заданы вовсе.</p>
<pre><code>resources:
  requests:
    memory: &quot;256Mi&quot;
    cpu: &quot;250m&quot;
  limits:
    memory: &quot;512Mi&quot;
    cpu: &quot;1&quot;
</code></pre>
<blockquote>
<p>Такой Pod получает доступ к гарантированным ресурсам (requests), но может использовать больше при наличии свободных ресурсов на узле.</p>
</blockquote>
<hr />
<h4 id="3-besteffort">3. BestEffort</h4>
<p>❌ <strong>Наименьший приоритет, вытесняется первым.</strong></p>
<p><strong>Условия:</strong></p>
<p>• У <strong>ни одного контейнера нет requests и limits</strong>.</p>
<pre><code>resources: {}
</code></pre>
<blockquote>
<p>Этот Pod работает «на удачу» — использует то, что осталось на узле. Он первым попадает под OOM killer.</p>
</blockquote>
<hr />
<p><strong>Как проверить QoS класс у уже запущенного Pod?</strong></p>
<pre><code>kubectl get pod &lt;pod-name&gt; -o jsonpath='{.status.qosClass}'
</code></pre>
<h3 id="kubernetes-tolerations-affinity-labels-pod">Управление шедулингом в Kubernetes: Tolerations, Affinity, Labels и назначение Pod'ов на ноды</h3>
<p>В Kubernetes автоматическое размещение Pod'ов на ноды происходит через <strong>scheduler</strong>. Чтобы управлять этим процессом, можно использовать <strong>labels</strong>, <strong>tolerations</strong>, <strong>taints</strong>, <strong>node affinity</strong>, <strong>pod affinity/anti-affinity</strong>.</p>
<h4 id="1-labels">1. Labels (лейблы)</h4>
<p><strong>Лейблы</strong> — это пары ключ/значение, которые можно назначать как Pod'ам, так и нодам. Они служат основой для:
- выбора подходящих нод (через <code>nodeAffinity</code>);
- группировки и фильтрации ресурсов (например, при <code>kubectl get pods -l app=frontend</code>);
- определения соседства между Pod'ами (<code>podAffinity</code>, <code>antiAffinity</code>);
- назначения сервисов (<code>selector</code>).</p>
<pre><code class="language-yaml">metadata:
  labels:
    app: \&quot;frontend\&quot;
    disktype: \&quot;ssd\&quot;
</code></pre>
<h4 id="2-taints-tolerations">2. Taints и Tolerations</h4>
<ul>
<li><strong>Taint</strong> — это метка на ноде, которая <strong>не позволяет</strong> размещать на ней Pod'ы, если только у Pod'а нет соответствующей <strong>toleration</strong>.</li>
<li>Используются для защиты нод, на которых должны работать только определённые приложения (например, GPU-ноды или системные).</li>
</ul>
<pre><code class="language-bash">kubectl taint nodes my-node key=value:NoSchedule
</code></pre>
<ul>
<li>Это значит: не размещай Pod'ы на <code>my-node</code>, если у них нет <code>toleration</code> для <code>key=value</code>.</li>
</ul>
<p><strong>Пример Toleration в Pod-манифесте:</strong></p>
<pre><code class="language-yaml">tolerations:
  - key: \&quot;key\&quot;
    operator: \&quot;Equal\&quot;
    value: \&quot;value\&quot;
    effect: \&quot;NoSchedule\&quot;
</code></pre>
<h4 id="3-node-affinity">3. Node Affinity</h4>
<p>Позволяет <strong>предпочесть</strong> или <strong>требовать</strong> размещение Pod'а на ноде с определёнными лейблами.</p>
<p><strong>Типы Node Affinity:</strong>
- <code>requiredDuringSchedulingIgnoredDuringExecution</code> — <strong>обязательное</strong> условие.
- <code>preferredDuringSchedulingIgnoredDuringExecution</code> — <strong>желательное</strong>, но не строгое.</p>
<p><strong>Пример:</strong></p>
<pre><code class="language-yaml">affinity:
  nodeAffinity:
    requiredDuringSchedulingIgnoredDuringExecution:
      nodeSelectorTerms:
        - matchExpressions:
            - key: \&quot;disktype\&quot;
              operator: \&quot;In\&quot;
              values:
                - \&quot;ssd\&quot;
</code></pre>
<blockquote>
<p>Этот Pod может быть размещён только на нодах с меткой <code>disktype=ssd</code>.</p>
</blockquote>
<h4 id="4-pod-affinity-anti-affinity">4. Pod Affinity / Anti-Affinity</h4>
<p>Управление тем, <strong>рядом с какими Pod'ами</strong> может (или не может) быть размещён новый Pod. Использует лейблы других Pod'ов.</p>
<h5 id="pod-affinity">Pod Affinity (соседство):</h5>
<pre><code class="language-yaml">affinity:
  podAffinity:
    requiredDuringSchedulingIgnoredDuringExecution:
      - labelSelector:
          matchExpressions:
            - key: \&quot;app\&quot;
              operator: \&quot;In\&quot;
              values:
                - \&quot;frontend\&quot;
        topologyKey: \&quot;kubernetes.io/hostname\&quot;
</code></pre>
<blockquote>
<p>Под будет размещён на той же ноде, где уже есть Pod с меткой <code>app=frontend</code>.</p>
</blockquote>
<h5 id="pod-anti-affinity">Pod Anti-Affinity (разделение):</h5>
<pre><code class="language-yaml">affinity:
  podAntiAffinity:
    requiredDuringSchedulingIgnoredDuringExecution:
      - labelSelector:
          matchExpressions:
            - key: \&quot;app\&quot;
              operator: \&quot;In\&quot;
              values:
                - \&quot;frontend\&quot;
        topologyKey: \&quot;kubernetes.io/hostname\&quot;
</code></pre>
<blockquote>
<p>Под не будет размещён на той же ноде, где уже есть другой <code>frontend</code> Pod.</p>
</blockquote>
<p>Kubernetes предоставляет гибкие механизмы управления размещением Pod'ов:
- <strong>Labels</strong> — фундаментальный инструмент для выбора, группировки и фильтрации ресурсов.
- <strong>Taints/Tolerations</strong> — позволяют исключать неподходящие ноды.
- <strong>Affinity/Anti-Affinity</strong> — дают контроль над предпочтениями и ограничениями по нодам и другим Pod'ам.</p>
<p>Грамотная настройка этих параметров позволяет добиться надёжности, предсказуемости и оптимального использования кластера.</p>
<h3 id="pod-lifecycle">Pod Lifecycle</h3>
<p>Жизненный цикл Pod-а. Это основа для понимания, как Pod-ы создаются, переходят между состояниями, завершаются и удаляются.</p>
<h4 id="pod-"><strong>🚦 Жизненный цикл Pod-а</strong></h4>
<h5 id="podphase"><strong>📌 Основные состояния (PodPhase):</strong></h5>
<p>Это высокоуровневые стадии, которые можно увидеть через kubectl get pod.</p>
<ol>
<li><strong>Pending</strong> — Pod был принят API сервером, но <strong>ещё не запущен</strong> (например, ждёт скачивания образов или размещения на ноде).</li>
<li><strong>Running</strong> — хотя бы один контейнер запущен, и Pod успешно размещён.</li>
<li><strong>Succeeded</strong> — все контейнеры завершились успешно (с кодом 0), и Pod не будет перезапускаться.</li>
<li><strong>Failed</strong> — хотя бы один контейнер завершился <strong>неуспешно</strong>, и Pod не может быть перезапущен.</li>
<li><strong>Unknown</strong> — kubelet <strong>не может определить</strong> статус (обычно из-за сетевых проблем).</li>
</ol>
<hr />
<h5 id="containerstate"><strong>📌 Состояния контейнеров (ContainerState)</strong></h5>
<p>Каждый контейнер внутри Pod-а может быть в:</p>
<p>• <strong>Waiting</strong> — ожидает запуска. Причины можно увидеть в .state.waiting.reason (например, CrashLoopBackOff, ImagePullBackOff).</p>
<p>• <strong>Running</strong> — контейнер успешно запущен.</p>
<p>• <strong>Terminated</strong> — контейнер завершил выполнение (по exit code или сигналу).</p>
<p>Пример:</p>
<pre><code>kubectl get pod mypod -o jsonpath='{.status.containerStatuses[*].state}'
</code></pre>
<hr />
<h4 id="restart-policy">🔁 Restart Policy</h4>
<p>Указывается в манифесте Pod-а. Возможные значения:</p>
<p>• Always (по умолчанию, используется в Deployment)</p>
<p>• OnFailure (для Job)</p>
<p>• Never</p>
<blockquote>
<p>Это влияет на то, будет ли kubelet перезапускать контейнер при сбое.</p>
</blockquote>
<hr />
<p><strong>🔄 Container Lifecycle Hooks</strong></p>
<p>Можно задать обработчики событий:</p>
<pre><code>lifecycle:
  postStart:
    exec:
      command: [&quot;/bin/sh&quot;, &quot;-c&quot;, &quot;echo Hello from postStart&quot;]
  preStop:
    exec:
      command: [&quot;/bin/sh&quot;, &quot;-c&quot;, &quot;echo Goodbye from preStop&quot;]
</code></pre>
<p>• <strong>postStart</strong> — вызывается <strong>после запуска контейнера</strong>, но до его marked as Running.
• <strong>preStop</strong> — вызывается <strong>до завершения контейнера</strong> (например, при kubectl delete pod или Scale down).</p>
<hr />
<h4 id="termination-grace-period">⏱ Termination Grace Period</h4>
<p>• По умолчанию: <strong>30 секунд</strong>.</p>
<p>• Kubernetes отправляет SIGTERM, ждёт terminationGracePeriodSeconds, затем — SIGKILL.</p>
<pre><code>terminationGracePeriodSeconds: 10
</code></pre>
<hr />
<p><strong>📉 Final Pod Termination Flow</strong></p>
<ol>
<li>kubelet отправляет SIGTERM контейнерам.</li>
<li>Ждёт terminationGracePeriodSeconds.</li>
<li>Выполняется preStop hook (если есть).</li>
<li>По истечении времени — SIGKILL.</li>
<li>Pod удаляется из etcd (если без finalizer).</li>
</ol>
<h3 id="prestop-finalizer">preStop &amp;&amp; finalizer</h3>
<p>Иногда выполняют похожие задачи (что-то “почистить перед удалением”), но они работают на совершенно разных уровнях. Давай разберёмся по-честному, без воды:</p>
<hr />
<p><strong>🔁 Кратко: разница между preStop и finalizer</strong></p>
<table>
<thead>
<tr>
<th></th>
<th><strong>preStop hook</strong></th>
<th><strong>finalizer</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Уровень</strong></td>
<td>Уровень <strong>контейнера</strong> внутри Pod-а</td>
<td>Уровень <strong>Kubernetes-объекта</strong> (Pod, PVC, CRD и т.п.)</td>
</tr>
<tr>
<td><strong>Когда вызывается</strong></td>
<td>Перед остановкой контейнера (например, SIGTERM)</td>
<td>При удалении объекта, <strong>но до физического удаления</strong></td>
</tr>
<tr>
<td><strong>Кто исполняет</strong></td>
<td><strong>kubelet</strong> на ноде</td>
<td>Контроллер (например, твой оператор/внешний процесс)</td>
</tr>
<tr>
<td><strong>Для чего нужен</strong></td>
<td>Подготовить контейнер к остановке (напр., завершить соединения)</td>
<td>Выполнить финальную логику: удалить ресурсы, почистить связи</td>
</tr>
<tr>
<td><strong>Можно ли “зависнуть”</strong></td>
<td>Нет — ограничен terminationGracePeriod</td>
<td>Да — пока не удалишь finalizer, объект не удалится</td>
</tr>
<tr>
<td><strong>Работает при kill -9?</strong></td>
<td>❌ Нет — SIGKILL игнорирует preStop</td>
<td>✅ Да, потому что finalizer выше по уровню</td>
</tr>
</tbody>
</table>
<hr />
<h4 id="_48">🔍 Примеры сценариев</h4>
<p><strong>preStop:</strong></p>
<p>• Подключено 100 клиентов к веб-серверу. preStop может:</p>
<p>• отправить сигнал приложению: «заверши активные соединения»;</p>
<p>• дождаться 10 секунд;</p>
<p>• завершиться сам.</p>
<pre><code>lifecycle:
  preStop:
    exec:
      command: [&quot;/bin/sh&quot;, &quot;-c&quot;, &quot;echo 'shutting down' &gt;&gt; /log&quot;]
</code></pre>
<blockquote>
<p>Это <strong>выполняется в контейнере</strong>, как скрипт или команда.</p>
</blockquote>
<hr />
<p><strong>finalizer:</strong></p>
<p>• У тебя Pod, при удалении которого нужно <strong>удалить запись из внешней БД</strong>, <strong>освободить IP-адрес</strong>, <strong>уведомить систему логирования</strong>.</p>
<p>• Эти действия нельзя сделать изнутри Pod-а, ты хочешь делать это <strong>в контроллере</strong>.</p>
<pre><code>metadata:
  finalizers:
    - cleanup.mycompany.com
</code></pre>
<blockquote>
<p>Пока контроллер не уберёт этот finalizer — Pod не удалится.</p>
</blockquote>
<hr />
<p><strong>🎯 Ключевые различия в использовании</strong></p>
<table>
<thead>
<tr>
<th><strong>Вопрос</strong></th>
<th><strong>Использовать</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Нужно <strong>что-то сделать внутри контейнера перед его остановкой</strong>?</td>
<td>✅ preStop</td>
</tr>
<tr>
<td>Нужно <strong>удалить внешний ресурс или логически “попрощаться” с объектом на уровне кластера</strong>?</td>
<td>✅ finalizer</td>
</tr>
</tbody>
</table>
<h3 id="probes">🩺 Probes</h3>
<p><strong>Probes</strong> — это специальные проверки, которые Kubernetes выполняет, чтобы понять:</p>
<p>• <strong>жив ли контейнер (livenessProbe)</strong></p>
<p>• <strong>готов ли контейнер принимать трафик (readinessProbe)</strong></p>
<p>• <strong>запустился ли контейнер корректно (startupProbe)</strong></p>
<p>Они помогают kubelet принимать решения:</p>
<p>• Перезапустить ли контейнер?</p>
<p>• Начать ли направлять на него трафик?</p>
<p>• Подождать ли подольше, если сервис стартует долго?</p>
<hr />
<h4 id="1-livenessprobe">🔍 1. livenessProbe</h4>
<blockquote>
<p><strong>“Контейнер завис? Надо перезапустить.”</strong></p>
</blockquote>
<p>Если livenessProbe неудачна — <strong>kubelet перезапускает контейнер</strong>.</p>
<p>Пример:</p>
<pre><code>livenessProbe:
  httpGet:
    path: /healthz
    port: 8080
  initialDelaySeconds: 5
  periodSeconds: 10
</code></pre>
<hr />
<h4 id="2-readinessprobe">🕒 2. readinessProbe</h4>
<blockquote>
<p><strong>“Готов ли контейнер принимать запросы?”</strong></p>
</blockquote>
<p>Если readinessProbe неудачна — Pod <strong>выводится из service endpoints</strong> (на него не будет идти трафик).</p>
<p>Пример:</p>
<pre><code>readinessProbe:
  exec:
    command: [&quot;cat&quot;, &quot;/tmp/ready&quot;]
  initialDelaySeconds: 2
  periodSeconds: 5
</code></pre>
<hr />
<h4 id="3-startupprobe">🐢 3. startupProbe</h4>
<blockquote>
<p><strong>“Дай контейнеру больше времени на запуск — не убивай его раньше времени.”</strong></p>
</blockquote>
<p>Полезно для <strong>медленно стартующих приложений</strong>. До тех пор, пока startupProbe <strong>не прошла</strong>, Kubernetes <strong>не выполняет livenessProbe</strong>. То есть она защищает от ложных срабатываний.</p>
<pre><code>startupProbe:
  httpGet:
    path: /startup
    port: 8080
  failureThreshold: 30
  periodSeconds: 10
</code></pre>
<blockquote>
<p>В этом примере даётся ~5 минут на запуск (30 × 10 секунд).</p>
</blockquote>
<hr />
<p><strong>🔧 Типы probe’ов:</strong></p>
<p>• httpGet — делает HTTP GET-запрос и проверяет код ответа (200-399 — успех).</p>
<p>• exec — выполняет команду внутри контейнера.</p>
<p>• tcpSocket — проверяет TCP-порт на доступность.</p>
<hr />
<p><strong>🧠 Когда использовать что:</strong></p>
<table>
<thead>
<tr>
<th><strong>Задача</strong></th>
<th><strong>Использовать</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Перезапустить зависший контейнер</td>
<td>livenessProbe</td>
</tr>
<tr>
<td>Управлять трафиком к Pod’у</td>
<td>readinessProbe</td>
</tr>
<tr>
<td>Дать приложению время на запуск</td>
<td>startupProbe</td>
</tr>
<tr>
<td>#### В какой последовательности работают пробы (startupProbe, readinessProbe, livenessProbe)</td>
<td></td>
</tr>
</tbody>
</table>
<p><strong>✅ Очередность и логика работы</strong></p>
<ol>
<li><strong>startupProbe — первая запускается</strong></li>
</ol>
<p>• Используется, чтобы дать приложению время “проснуться” (например, если долго стартует).</p>
<p>• Пока startupProbe не <strong>успешна</strong>, <strong>ни liveness, ни readiness не запускаются</strong>.</p>
<p>• Если startupProbe <strong>проваливается</strong>, контейнер считается “неживым” и перезапускается.</p>
<ol>
<li><strong>readinessProbe — включается после startupProbe</strong></li>
</ol>
<p>• <strong>Проверяет, готов ли контейнер обслуживать запросы</strong> (например, подключился к БД, прогрел кэш и т.д.).</p>
<p>• Пока readinessProbe не проходит, <strong>Pod не получает трафик от сервисов</strong>.</p>
<p>• Даже если контейнер <strong>жив</strong>, но не готов — сервис не будет к нему направлять запросы.</p>
<ol>
<li><strong>livenessProbe — также запускается после startupProbe</strong></li>
</ol>
<p>• Проверяет, <strong>жив ли контейнер</strong> (например, не завис ли, не утёк ли в вечную обработку).</p>
<p>• Если livenessProbe проваливается, <strong>контейнер перезапускается</strong>.</p>
<hr />
<p><strong>📌 Важные детали</strong></p>
<p>• После того как startupProbe <strong>прошла</strong>, она <strong>больше не запускается</strong>.</p>
<p>• readinessProbe и livenessProbe <strong>продолжают выполняться периодически</strong> всё время, пока контейнер жив.</p>
<p>• readinessProbe может возвращать “не готов”, например, если БД недоступна — и в это время сервис <strong>перестаёт слать трафик</strong> на этот pod.</p>
<p>• livenessProbe провалилась → kubelet <strong>рестартит контейнер</strong>.</p>
<hr />
<p><strong>🔁 Тайминги</strong></p>
<p>Ты можешь задать параметры для всех проб:</p>
<p>• initialDelaySeconds — сколько подождать перед первой проверкой.</p>
<p>• periodSeconds — интервал между проверками.</p>
<p>• timeoutSeconds — сколько ждать ответа.</p>
<p>• failureThreshold — сколько раз подряд должно не пройти, чтобы считать контейнер неработающим.</p>
<hr />
<p><strong>🧠 На собесе можно сказать:</strong></p>
<blockquote>
<p>Kubernetes запускает startupProbe, чтобы убедиться, что контейнер успеет инициализироваться. Пока она не прошла, readiness и liveness не работают. После успешного старта readinessProbe управляет трафиком, а livenessProbe следит, чтобы контейнер не повис. Это разделение позволяет избегать лишних рестартов при долгом старте приложения.</p>
</blockquote>
<h3 id="initcontainers">InitContainers</h3>
<p>initContainer — это <strong>специальный контейнер</strong>, который выполняется <strong>до основного контейнера</strong> в Pod-е. Он завершает свою работу, и только после этого запускаются обычные containers.</p>
<hr />
<p><strong>🔑 Ключевые особенности:</strong></p>
<p>• Выполняются <strong>последовательно</strong>, в порядке их объявления.
• Каждый должен <strong>успешно завершиться (exit 0)</strong> — иначе Pod остаётся в состоянии Init.
• Имеют <strong>отдельные образы и команды</strong> от основного контейнера.
• Могут <strong>монтировать те же тома</strong>, что и основной контейнер.</p>
<hr />
<p><strong>🧪 Зачем использовать initContainers?</strong></p>
<p>• Задержка старта, пока не готов внешний сервис (БД, Redis).</p>
<p>• Копирование файлов в volume перед стартом приложения.</p>
<p>• Генерация конфигураций, ключей, секретов.</p>
<p>• Прогрев кэша или база данных миграций.</p>
<hr />
<p><strong>🔧 Пример: Ожидание БД перед стартом приложения</strong></p>
<pre><code>apiVersion: v1
kind: Pod
metadata:
  name: app-with-init
spec:
  initContainers:
  - name: wait-for-db
    image: busybox
    command: ['sh', '-c', 'until nc -z db 5432; do echo waiting for db; sleep 2; done']
  containers:
  - name: main-app
    image: myapp:latest
    ports:
    - containerPort: 80
</code></pre>
<blockquote>
<p>Этот initContainer будет проверять доступность базы данных на порту 5432. Как только она станет доступна — приложение стартует.</p>
</blockquote>
<hr />
<p><strong>📁 Пример: копирование файлов в том</strong></p>
<pre><code>spec:
  volumes:
  - name: config-volume
    emptyDir: {}

  initContainers:
  - name: copy-config
    image: busybox
    command: ['sh', '-c', 'cp /etc/config/* /config/']
    volumeMounts:
    - name: config-volume
      mountPath: /config
    - name: config-source
      mountPath: /etc/config

  containers:
  - name: app
    image: myapp
    volumeMounts:
    - name: config-volume
      mountPath: /app/config
</code></pre>
<hr />
<p><strong>🧠 Советы:</strong>
• Лучше использовать initContainers, чем городить логику ожидания или подготовки в основном контейнере.
• Они хорошо сочетаются с emptyDir и другими volume-типами.
• Можно использовать разные образы, в т.ч. alpine, busybox, curlimages/curl для утилит.</p>
<h3 id="service-mesh">Service Mesh</h3>
<p>Это <strong>слой инфраструктуры</strong>, который управляет сетевыми коммуникациями между сервисами в распределённой системе.</p>
<p><strong>Он отвечает за:</strong></p>
<p>• 📦 <strong>Service-to-Service communication</strong> (обмен трафиком)
• 🔒 <strong>Шифрование трафика</strong> (MTLS)
• 🎯 <strong>Routing &amp; Canary</strong> (маршрутизация, A/B, Canary)
• 📊 <strong>Наблюдаемость</strong> (метрики, трассировки, логи)
• 🔁 <strong>Retry, timeout, circuit breaker</strong> (механики надёжности)
• 🚦 <strong>Policy control</strong> (авторизация, ACL)</p>
<hr />
<h4 id="_49">🔧 Как работает?</h4>
<p>Ключевая идея — <strong>Sidecar Proxy</strong>.</p>
<p>Каждому Pod-у автоматически добавляется <strong>прокси-контейнер</strong> (обычно Envoy), через который <strong>весь трафик между сервисами</strong> идёт:</p>
<pre><code>[service A] &lt;=&gt; [Envoy A] &lt;===&gt; [Envoy B] &lt;=&gt; [service B]
</code></pre>
<blockquote>
<p>Управляется централизованно через control-plane (например, Istiod в Istio).</p>
</blockquote>
<hr />
<p><strong>🎯 Зачем нужен?</strong></p>
<table>
<thead>
<tr>
<th><strong>Без Service Mesh</strong></th>
<th><strong>С Service Mesh</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Сам пишешь retry, timeout</td>
<td>Задаёшь в YAML, работает из коробки</td>
</tr>
<tr>
<td>TLS надо встраивать в код</td>
<td>MTLS автоматом между сервисами</td>
</tr>
<tr>
<td>Логика маршрутизации в коде</td>
<td>Traffic shifting через CRD</td>
</tr>
<tr>
<td>Метрики в app</td>
<td>Авто-интеграция с Prometheus/Grafana/Jaeger</td>
</tr>
<tr>
<td>Manual discovery</td>
<td>Встроенное сервис-обнаружение</td>
</tr>
</tbody>
</table>
<hr />
<h4 id="service-mesh_1">🛠 Примеры популярных Service Mesh</h4>
<h5 id="istio-">Istio (де-факто стандарт, мощный, но тяжеловат)</h5>
<p>• Control-plane: istiod</p>
<p>• Data-plane: Envoy</p>
<p>• CRD’ы: VirtualService, DestinationRule, Gateway, AuthorizationPolicy, и др.</p>
<p>• Сильная поддержка MTLS, трассировки, observability.</p>
<hr />
<p><strong>🧪 Пример: управление маршрутом в Istio</strong></p>
<pre><code>apiVersion: networking.istio.io/v1beta1
kind: VirtualService
metadata:
  name: reviews-route
spec:
  hosts:
    - reviews
  http:
    - route:
        - destination:
            host: reviews
            subset: v1
          weight: 90
        - destination:
            host: reviews
            subset: v2
          weight: 10
</code></pre>
<blockquote>
<p>90% трафика пойдёт в v1, 10% — в v2. Это пример <strong>canary deployment</strong> без изменения кода.</p>
</blockquote>
<hr />
<h4 id="mtls">🔐 MTLS — всё шифруется автоматически</h4>
<p>Трафик между Pod-ами <strong>автоматически зашифрован</strong>, и можно <strong>включать политику Zero Trust</strong> — только определённые сервисы могут общаться.</p>
<pre><code>apiVersion: security.istio.io/v1beta1
kind: PeerAuthentication
metadata:
  name: default
spec:
  mtls:
    mode: STRICT
</code></pre>
<hr />
<h4 id="observability">📊 Observability из коробки</h4>
<p>Сбор метрик, логов, трассировок:</p>
<p>• 📈 Prometheus / Grafana</p>
<p>• 🔎 Kiali (визуализация mesh-а)</p>
<p>• 🧵 Jaeger / Zipkin (трассировки)</p>
<h3 id="service">🔧 Service</h3>
<table>
<thead>
<tr>
<th><strong>Тип</strong></th>
<th><strong>Внешний доступ</strong></th>
<th><strong>Где используется</strong></th>
<th><strong>Пример подключения</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ClusterIP</strong></td>
<td>❌ Нет</td>
<td>Внутри кластера</td>
<td>curl my-svc.default.svc.cluster.local</td>
</tr>
<tr>
<td><strong>NodePort</strong></td>
<td>✅ Да</td>
<td>Bare-metal, Minikube</td>
<td>curl http://&lt;\NodeIP&gt;:30080</td>
</tr>
<tr>
<td><strong>LoadBalancer</strong></td>
<td>✅ Да (облако)</td>
<td>GKE, EKS, AKS, MetalLB</td>
<td>curl http://\&lt;\EXTERNAL-IP&gt;</td>
</tr>
<tr>
<td><strong>ExternalName</strong></td>
<td>⚠️ Через DNS</td>
<td>Доступ к внешним сервисам</td>
<td>curl http://external-service.local (CNAME)</td>
</tr>
<tr>
<td><strong>Headless</strong></td>
<td>❌ Нет (IP нет)</td>
<td>StatefulSet, Service Discovery</td>
<td>dig my-svc.default.svc.cluster.local → IP подов</td>
</tr>
</tbody>
</table>
<p>Это <strong>базовый ресурс Kubernetes</strong>, который обеспечивает:</p>
<p>• сервис-дискавери по имени (DNS),
• стабильный IP,
• маршрутизацию трафика на Pod-ы по label’ам.</p>
<pre><code>apiVersion: v1
kind: Service
metadata:
  name: reviews
spec:
  selector:
    app: reviews
  ports:
    - port: 80
      targetPort: 8080
</code></pre>
<blockquote>
<p>Все Pod-ы с app=reviews получат трафик через этот Service.</p>
</blockquote>
<hr />
<h4 id="clusterip">🧱 ClusterIP (по умолчанию)</h4>
<pre><code>apiVersion: v1
kind: Service
metadata:
  name: my-svc
spec:
  selector:
    app: my-app
  ports:
    - port: 80        # Внутри кластера
      targetPort: 8080
</code></pre>
<ul>
<li><strong>Описание</strong>: Доступен только внутри кластера.</li>
<li><strong>Применение</strong>: Для связи между подами разных приложений.</li>
<li><strong>Пример использования</strong>: Бэкенд-сервис, к которому обращается фронтенд.</li>
</ul>
<pre><code>spec:
  type: ClusterIP
</code></pre>
<h4 id="nodeport">🌐 NodePort</h4>
<pre><code>apiVersion: v1
kind: Service
metadata:
  name: my-nodeport-svc
spec:
  type: NodePort
  selector:
    app: my-app
  ports:
    - port: 80
      targetPort: 8080
      nodePort: 30080
</code></pre>
<blockquote>
<p>Доступ: http://&lt;NodeIP&gt;:30080</p>
</blockquote>
<ul>
<li><strong>Описание</strong>: Открывает порт на всех нодах кластера.</li>
<li><strong>Доступ извне</strong>: Да, по IP-адресу ноды и указанному порту.</li>
<li><strong>Диапазон портов</strong>: 30000–32767 (по умолчанию).</li>
<li><strong>Применение</strong>: Простой способ опубликовать приложение наружу без Ingress.</li>
</ul>
<h4 id="loadbalancer">🌎 LoadBalancer</h4>
<pre><code>apiVersion: v1
kind: Service
metadata:
  name: my-lb-svc
spec:
  type: LoadBalancer
  selector:
    app: my-app
  ports:
    - port: 80
      targetPort: 8080
</code></pre>
<blockquote>
<p>В облаках — выдаст EXTERNAL-IP через kubectl get svc</p>
</blockquote>
<ul>
<li><strong>Описание</strong>: Создает внешний балансировщик нагрузки (обычно в облаке).</li>
<li><strong>Применение</strong>: Доступ к сервису из интернета, production-ready подход.</li>
<li><strong>Зависимость</strong>: Работает при наличии интеграции с облачным провайдером (GKE, EKS, AKS и др).</li>
</ul>
<h4 id="externalname">🔗 ExternalName</h4>
<pre><code>spec:
  type: ExternalName
  externalName: my.external.service.com
</code></pre>
<ul>
<li><strong>Описание</strong>: Проксирует запросы к внешнему DNS-имени.</li>
<li><strong>Применение</strong>: Используется для обращения к внешним сервисам через DNS, как будто это обычный сервис в кластере.</li>
<li><strong>Особенность</strong>: Не создает собственный IP, работает через CNAME.</li>
</ul>
<h4 id="headless-service">🧪 Headless Service</h4>
<pre><code>spec:
  clusterIP: None
</code></pre>
<ul>
<li><strong>Описание</strong>: Не назначает IP-адрес; возвращает список IP подов.</li>
<li><strong>Применение</strong>: Используется для сервисов, где важен прямой доступ к подам, например, StatefulSet, сервис discovery.</li>
<li><strong>Особенность</strong>: Вместо баланса — полное управление с клиентской стороны.</li>
</ul>
<h4 id="_50">🔧 <strong>Дополнительные сценарии</strong></h4>
<p>Не являются новыми типами, но часто используются</p>
<ul>
<li><strong>Ingress</strong> — <em>не сервис, а контроллер маршрутизации</em>. Используется для HTTP/HTTPS входа и более гибкого роутинга.</li>
<li><strong>Service Mesh (например, Istio, Linkerd)</strong> — добавляют абстракции над сервисами, например, виртуальные сервисы, маршруты на уровне L7.</li>
<li><strong>MetalLB / Kube-vip</strong> — расширяют возможности LoadBalancer в on-premise кластерах, где нет встроенного облачного балансировщика.</li>
</ul>
<h3 id="istio-virtualservice">🕹 Istio VirtualService</h3>
<p>Это <strong>ресурс уровня Istio</strong>, который определяет:</p>
<p>• <strong>Как именно маршрутизировать трафик</strong> внутри Service
• Делать canary, A/B, header-based routing и т.д.
• Управлять retry, timeout, fault injection и т.п.</p>
<pre><code>apiVersion: networking.istio.io/v1beta1
kind: VirtualService
metadata:
  name: reviews-routing
spec:
  hosts:
    - reviews
  http:
    - match:
        - headers:
            end-user:
              exact: test-user
      route:
        - destination:
            host: reviews
            subset: v2
    - route:
        - destination:
            host: reviews
            subset: v1
</code></pre>
<blockquote>
<p>Это правило: если юзер — test-user, отдать reviews:v2, иначе — v1.</p>
</blockquote>
<hr />
<p><strong>🔄 Как они работают вместе</strong></p>
<p>• Service — отвечает за <strong>“куда”</strong>: набор Pod-ов (endpoints)</p>
<p>• VirtualService — отвечает за <strong>“как”</strong>: правила маршрутизации, версии, условия</p>
<p><strong>Трафик идёт так:</strong></p>
<pre><code>Client → Kubernetes Service → Istio Proxy (Envoy) → VirtualService → Target Pod
</code></pre>
<hr />
<p><strong>📦 А что такое subset?</strong></p>
<p>Чтобы VirtualService мог выбрать v1, v2, ты должен создать DestinationRule:</p>
<pre><code>apiVersion: networking.istio.io/v1beta1
kind: DestinationRule
metadata:
  name: reviews-dest
spec:
  host: reviews
  subsets:
    - name: v1
      labels:
        version: v1
    - name: v2
      labels:
        version: v2
</code></pre>
<blockquote>
<p>Теперь Istio сможет направлять трафик только на те Pod-ы, у которых version: v1 или v2.</p>
</blockquote>
<hr />
<h3 id="ingress">Ingress</h3>
<p>Kubernetes ресурс, который описывает <strong>правила входа HTTP/HTTPS-трафика</strong> в кластер и маршрутизацию к сервисам.</p>
<p><strong>Пример:</strong></p>
<pre><code>apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: my-ingress
spec:
  rules:
    - host: mysite.local
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: my-service
                port:
                  number: 80
</code></pre>
<p>📌 Но сам Ingress ничего не делает без контроллера!</p>
<h4 id="ingress-controller">🎮 Ingress Controller — что это?</h4>
<blockquote>
<p><strong>Приложение (под/деплоймент)</strong>, которое <strong>читает ресурсы Ingress</strong> и <strong>настраивает прокси-сервер</strong> (например, NGINX) для обработки внешнего трафика.</p>
</blockquote>
<p><strong>Популярные контроллеры:</strong></p>
<p>• nginx-ingress ✅ (де-факто стандарт)</p>
<p>• traefik</p>
<p>• HAProxy</p>
<p>• Istio Gateway (в рамках Istio)</p>
<p>• AWS ALB Controller (в AWS)</p>
<hr />
<p><strong>🔁 Как это работает:</strong></p>
<pre><code>[Браузер] 
  ↓ HTTP/HTTPS
[Ingress Controller Pod (например, NGINX)]
  ↓
[Ingress rules → Service → Pod]
</code></pre>
<hr />
<h4 id="ingress_1">📌 Что делает Ingress:</h4>
<p>• Правила маршрутизации (host + path)</p>
<p>• Поддержка HTTPS (через TLS-секреты)</p>
<p>• Может использовать аннотации для настроек (timeouts, redirects и т.д.)</p>
<h4 id="ingress-controller_1">📌 Что делает Ingress Controller:</h4>
<p>• Слушает порт (80/443)</p>
<p>• Считывает Ingress-объекты</p>
<p>• Настраивает внутренний прокси (например, nginx.conf)</p>
<p>• Обрабатывает входящие соединения</p>
<hr />
<h4 id="_51">🧠 Кратко:</h4>
<table>
<thead>
<tr>
<th><strong>Компонент</strong></th>
<th><strong>Роль</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Ingress</td>
<td>Правила маршрутизации</td>
</tr>
<tr>
<td>Ingress Controller</td>
<td>Прокси, который эти правила реализует</td>
</tr>
</tbody>
</table>
<h3 id="replicaset">ReplicaSet (низкоуровневый)</h3>
<blockquote>
<p>Поддерживает <strong>заданное количество Pod-ов</strong>. Сам по себе редко используется напрямую.</p>
</blockquote>
<pre><code>apiVersion: apps/v1
kind: ReplicaSet
spec:
  replicas: 3
</code></pre>
<p>• Обеспечивает: <em>N реплик</em>
• Не поддерживает обновления, стратегии, rollback
• Используется <strong>внутри Deployment</strong></p>
<p>📌 Не используй напрямую — почти всегда используешь Deployment.</p>
<hr />
<h3 id="deployment-stateless">Deployment (стандарт для stateless приложений)</h3>
<blockquote>
<p>Самый популярный контроллер. Обеспечивает <strong>масштабируемость</strong>, <strong>обновления</strong>, <strong>откат</strong>.</p>
</blockquote>
<pre><code>apiVersion: apps/v1
kind: Deployment
spec:
  replicas: 3
  strategy:
    type: RollingUpdate
</code></pre>
<p>• Позволяет <strong>обновлять версии без даунтайма</strong></p>
<p>• Есть стратегии обновления (RollingUpdate, Recreate)</p>
<p>• Поддерживает rollback, pause, resume</p>
<p>📌 Используется для web-приложений, API, сервисов.</p>
<hr />
<h3 id="daemonset">DaemonSet</h3>
<blockquote>
<p>Запускает <strong>по одному Pod-у на каждой Node</strong>.</p>
</blockquote>
<pre><code>apiVersion: apps/v1
kind: DaemonSet
</code></pre>
<p>• Полезен для: логгера, мониторинга, агента (Prometheus, Fluentd)</p>
<p>• Новые ноды автоматически получают Pod</p>
<p>• Без replicas — он сам знает, сколько нод</p>
<p>📌 Используется для инфраструктурных компонентов.</p>
<hr />
<h3 id="statefulset">StatefulSet</h3>
<blockquote>
<p>Используется для <strong>stateful-приложений</strong> (БД, кэш, очереди), где <strong>важен порядок и имена Pod-ов</strong>.</p>
</blockquote>
<pre><code>apiVersion: apps/v1
kind: StatefulSet
spec:
  serviceName: my-headless
</code></pre>
<p>• Поддерживает стабильные имена Pod-ов: mongo-0, mongo-1</p>
<p>• Использует <strong>PersistentVolumeClaim templates</strong></p>
<p>• Запускает/удаляет Pod’ы поочерёдно</p>
<p>📌 Используется для: PostgreSQL, Cassandra, Kafka, Redis Cluster</p>
<hr />
<h3 id="job">Job</h3>
<blockquote>
<p>Выполняет <strong>одиночную задачу</strong>, дожидается завершения.</p>
</blockquote>
<pre><code>apiVersion: batch/v1
kind: Job
spec:
  completions: 1
</code></pre>
<p>• Создаёт Pod для выполнения задачи</p>
<p>• Повторяет, если задача неуспешна</p>
<p>• Сам удаляется по завершении (или можно сохранить логи)</p>
<p>📌 Используется для: миграций, импортов, аналитических задач</p>
<hr />
<h3 id="cronjob">CronJob</h3>
<blockquote>
<p>Периодически запускает Job по расписанию (cron-выражение)</p>
</blockquote>
<pre><code>apiVersion: batch/v1
kind: CronJob
spec:
  schedule: &quot;*/5 * * * *&quot;
</code></pre>
<p>📌 Используется для: бэкапов, проверок, периодических отчётов</p>
<hr />
<h3 id="pod-controllers-comparation">Pod controllers comparation</h3>
<table>
<thead>
<tr>
<th><strong>Контроллер</strong></th>
<th><strong>Масштабируемость</strong></th>
<th><strong>Хранит стейт</strong></th>
<th><strong>Периодичность</strong></th>
<th><strong>Одна задача</strong></th>
<th><strong>Пример использования</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Deployment</td>
<td>✅ Да</td>
<td>❌ Нет</td>
<td>❌ Нет</td>
<td>❌ Нет</td>
<td>web-app, API, worker</td>
</tr>
<tr>
<td>ReplicaSet</td>
<td>✅ Да</td>
<td>❌ Нет</td>
<td>❌ Нет</td>
<td>❌ Нет</td>
<td>(внутри Deployment)</td>
</tr>
<tr>
<td>DaemonSet</td>
<td>❌ 1 на Node</td>
<td>❌ Нет</td>
<td>❌ Нет</td>
<td>❌ Нет</td>
<td>node exporter, log-агенты</td>
</tr>
<tr>
<td>StatefulSet</td>
<td>✅ Да</td>
<td>✅ Да</td>
<td>❌ Нет</td>
<td>❌ Нет</td>
<td>PostgreSQL, Redis cluster</td>
</tr>
<tr>
<td>Job</td>
<td>❌ (один запуск)</td>
<td>❌ Нет</td>
<td>❌ Нет</td>
<td>✅ Да</td>
<td>миграция, ETL, init-task</td>
</tr>
<tr>
<td>CronJob</td>
<td>❌</td>
<td>❌ Нет</td>
<td>✅ Да</td>
<td>✅ Да</td>
<td>бэкап каждые N минут</td>
</tr>
</tbody>
</table>
<h3 id="pvc">PVC</h3>
<p><strong>PVC (PersistentVolumeClaim)</strong> — это <strong>заявка от Pod-а на хранилище</strong>. Это как “бронирование диска”: ты говоришь, какой объём и доступ тебе нужен — а Kubernetes сам выделяет подходящее хранилище (PersistentVolume) или создаёт его (в случае dynamic provisioning).</p>
<hr />
<p><strong>🧱 Компоненты хранения в Kubernetes</strong></p>
<ol>
<li><strong>PersistentVolume (PV)</strong> — физический или логический диск (долговечный том).</li>
<li><strong>PersistentVolumeClaim (PVC)</strong> — запрос от Pod-а: “дай мне диск на 1Gi, с RW доступом”.</li>
<li><strong>StorageClass</strong> — шаблон, описывающий, <strong>как именно создавать PV</strong> (например, тип диска в облаке: SSD, HDD, reclaim policy и т.п.).</li>
</ol>
<hr />
<p><strong>🔄 Жизненный цикл: как всё связано</strong></p>
<pre><code>Pod → PersistentVolumeClaim (PVC) → PersistentVolume (PV) → Physical disk (GCE, EBS, NFS, Ceph, etc)
</code></pre>
<hr />
<p><strong>🔧 Пример 1: Простой PVC + Pod</strong>  </p>
<p><strong>📄 PVC:</strong></p>
<pre><code>apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: my-pvc
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 1Gi
</code></pre>
<p><strong>📄 Под, использующий этот PVC:</strong></p>
<pre><code>apiVersion: v1
kind: Pod
metadata:
  name: my-pod
spec:
  containers:
    - name: app
      image: nginx
      volumeMounts:
        - name: my-storage
          mountPath: /usr/share/nginx/html
  volumes:
    - name: my-storage
      persistentVolumeClaim:
        claimName: my-pvc
</code></pre>
<blockquote>
<p>📦 Контейнер получает <strong>путь /usr/share/nginx/html</strong>, примонтированный из PVC.</p>
</blockquote>
<hr />
<p><strong>📚 Ключевые параметры PVC</strong></p>
<table>
<thead>
<tr>
<th><strong>Параметр</strong></th>
<th><strong>Значение</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>storage</td>
<td>Сколько нужно (например, 1Gi)</td>
</tr>
<tr>
<td>accessModes</td>
<td>ReadWriteOnce, ReadOnlyMany, ReadWriteMany</td>
</tr>
<tr>
<td>volumeMode</td>
<td>Filesystem (по умолчанию) или Block</td>
</tr>
<tr>
<td>storageClassName</td>
<td>Какой StorageClass использовать</td>
</tr>
</tbody>
</table>
<hr />
<p><strong>🔁 Static vs Dynamic provisioning</strong></p>
<table>
<thead>
<tr>
<th><strong>Тип</strong></th>
<th><strong>Что происходит</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Static</strong></td>
<td>Админ заранее создаёт PV, ты делаешь PVC и ждёшь совпадения по параметрам</td>
</tr>
<tr>
<td><strong>Dynamic</strong> ✅</td>
<td>PVC автоматически вызывает StorageClass, который создаёт PV на лету (например, EBS в AWS, Persistent Disk в GCP)</td>
</tr>
</tbody>
</table>
<hr />
<p><strong>📄 Пример: PVC с StorageClass</strong></p>
<pre><code>apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: fast-storage
spec:
  storageClassName: &quot;fast-ssd&quot;
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 5Gi
</code></pre>
<hr />
<p><strong>🧠 Как посмотреть:</strong></p>
<pre><code>kubectl get pvc
kubectl describe pvc my-pvc
kubectl get pv
</code></pre>
<blockquote>
<p>Статус PVC должен быть Bound, если всё ок.</p>
</blockquote>
<hr />
<p><strong>🗑 Reclaim Policy (что делать после удаления PVC)</strong></p>
<p>• Delete — PV будет удалён вместе с PVC (часто в динамическом сценарии)</p>
<p>• Retain — диск останется, нужно очищать вручную</p>
<p>• Recycle (устаревший)</p>
<hr />
<p><strong>📦 Где используются PVC?</strong></p>
<p>• Базы данных (PostgreSQL, MongoDB)</p>
<p>• CMS (WordPress)</p>
<p>• Кэш (Redis с persistence)</p>
<p>• Хостинг статики в Nginx</p>
<p>• Kafka, MinIO, Ceph, и т.д.</p>
<hr />
<h3 id="gitops-vs-helm">GitOps vs Helm</h3>
<p><strong>🎯 Суть обоих подходов:</strong></p>
<table>
<thead>
<tr>
<th><strong>Подход</strong></th>
<th><strong>Что делает</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Helm CLI</strong></td>
<td>Ты <strong>вручную применяешь Helm чарты</strong> с локальной машины или CI/CD</td>
</tr>
<tr>
<td><strong>GitOps</strong></td>
<td>Ты <strong>хранишь всё в Git</strong>, а оператор в кластере <strong>сам синхронизирует состояние</strong></td>
</tr>
</tbody>
</table>
<hr />
<p><strong>⚙️ Как работает каждый подход</strong></p>
<p><strong>📦 1. Helm deployment (классический)</strong></p>
<p>• Ты запускаешь команду:</p>
<pre><code>helm upgrade --install my-app ./chart --values values.yaml
</code></pre>
<p>• Или через CI (например, GitLab CI).</p>
<p>• Helm устанавливает/обновляет всё напрямую в кластер.</p>
<p>• <strong>Состояние — в Helm и в кластере</strong>, не обязательно в Git.</p>
<p>🔻 Проблемы:</p>
<p>• Нет 100% гарантий, что Git = кластер.</p>
<p>• Нужно самому следить за порядком обновлений.</p>
<p>• Можно “вмешаться вручную” и не зафиксировать в Git.</p>
<hr />
<p><strong>🔁 2. GitOps (ArgoCD, FluxCD)</strong></p>
<p>• Ты <strong>кладёшь манифесты или Helm values в Git</strong>.</p>
<p>• Git = источник правды.</p>
<p>• В кластере работает <strong>оператор (ArgoCD/Flux)</strong>, который:</p>
<p>• Смотрит в Git</p>
<p>• Применяет манифесты/Helm чарты в кластер</p>
<p>• Следит, чтобы кластер всегда соответствовал Git</p>
<blockquote>
<p>Git → автосинхронизация → кластер</p>
</blockquote>
<hr />
<p><strong>📊 Сравнение по ключевым аспектам:</strong></p>
<table>
<thead>
<tr>
<th><strong>Категория</strong></th>
<th><strong>GitOps</strong></th>
<th><strong>Helm (ручной)</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>🧠 Источник правды</td>
<td>Git</td>
<td>Helm state / CI конфигурация / память</td>
</tr>
<tr>
<td>🔁 Автоматичность</td>
<td>Да (pull model)</td>
<td>Нет (push model)</td>
</tr>
<tr>
<td>🔒 Безопасность доступа</td>
<td>Не нужен доступ к кластеру — только Git</td>
<td>Требуется доступ к кластеру</td>
</tr>
<tr>
<td>🛠 Откат изменений</td>
<td>Git revert → автооткат</td>
<td>Надо вручную запускать helm rollback</td>
</tr>
<tr>
<td>👀 Observability</td>
<td>UI (ArgoCD/Flux) с дифами и статусами</td>
<td>helm status, logs</td>
</tr>
<tr>
<td>✍️ Изменения вне Git</td>
<td><strong>Автоматически возвращаются к Git-состоянию</strong></td>
<td>Сохраняются (drift!)</td>
</tr>
<tr>
<td>🔁 Частота обновлений</td>
<td>Постоянная синхронизация</td>
<td>Только по запуску команды</td>
</tr>
</tbody>
</table>
<hr />
<p><strong>🤖 ArgoCD + Helm = ❤️</strong></p>
<p>Ты можешь <strong>использовать Helm внутри GitOps</strong>, просто зафиксировав чарты и values в Git:</p>
<pre><code>apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: my-app
spec:
  source:
    repoURL: https://github.com/my-org/my-repo
    targetRevision: main
    path: charts/my-app
    helm:
      valueFiles:
        - values-prod.yaml
</code></pre>
<blockquote>
<p>Таким образом, ты <strong>не теряешь гибкость Helm</strong>, но получаешь <strong>автоматизацию GitOps</strong>.</p>
</blockquote>
<hr />
<p><strong>💡 Когда использовать что?</strong></p>
<table>
<thead>
<tr>
<th><strong>Сценарий</strong></th>
<th><strong>Подход</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Маленький pet-проект</td>
<td>Helm CLI</td>
</tr>
<tr>
<td>Команда/прод/много окружений</td>
<td>GitOps</td>
</tr>
<tr>
<td>Требуется аудит, откат, видимость</td>
<td>GitOps</td>
</tr>
<tr>
<td>Развёртывание из CI (ручной контроль)</td>
<td>Helm CLI</td>
</tr>
<tr>
<td>Много компонентов, инфраструктура как код</td>
<td>GitOps</td>
</tr>
</tbody>
</table>
<h3 id="rbac">RBAC</h3>
<p><strong>RBAC (Role-Based Access Control)</strong> — это система контроля доступа в Kubernetes, основанная на ролях. Она позволяет <strong>разграничить, кто что может делать в кластере</strong>.</p>
<p>RBAC управляется через <strong>четыре основных ресурса</strong>:</p>
<p>• Role
• ClusterRole
• RoleBinding
• ClusterRoleBinding</p>
<p>!!!
rolebinding можно применить на clusterrole binding и дать права конкретному юзеру в рамках неймспейса
!!!</p>
<h4 id="_52">🧱 Основные сущности</h4>
<table>
<thead>
<tr>
<th><strong>Объект</strong></th>
<th><strong>Где действует</strong></th>
<th><strong>Что делает</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Role</td>
<td>в пределах <strong>namespace</strong></td>
<td>Определяет разрешения на действия</td>
</tr>
<tr>
<td>ClusterRole</td>
<td>действует <strong>кластерно</strong></td>
<td>Может применяться глобально или к namespace</td>
</tr>
<tr>
<td>RoleBinding</td>
<td><strong>в пределах namespace</strong></td>
<td>Назначает Role пользователю/группе</td>
</tr>
<tr>
<td>ClusterRoleBinding</td>
<td><strong>глобально</strong></td>
<td>Назначает ClusterRole пользователю/группе на весь кластер или несколько NS</td>
</tr>
</tbody>
</table>
<hr />
<h5 id="1-role-rolebinding">📌 Пример 1: Простой Role и RoleBinding</h5>
<pre><code># role.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  namespace: dev
  name: pod-reader
rules:
- apiGroups: [&quot;&quot;]
  resources: [&quot;pods&quot;]
  verbs: [&quot;get&quot;, &quot;watch&quot;, &quot;list&quot;]
</code></pre>
<pre><code># rolebinding.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: read-pods
  namespace: dev
subjects:
- kind: User
  name: alice
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: Role
  name: pod-reader
  apiGroup: rbac.authorization.k8s.io
</code></pre>
<p>📌 Это даёт пользователю alice доступ на <strong>чтение подов в namespace dev</strong>.</p>
<hr />
<h5 id="2-clusterrole-clusterrolebinding">📌 Пример 2: ClusterRole + ClusterRoleBinding</h5>
<pre><code>apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: node-reader
rules:
- apiGroups: [&quot;&quot;]
  resources: [&quot;nodes&quot;]
  verbs: [&quot;get&quot;, &quot;watch&quot;, &quot;list&quot;]
</code></pre>
<pre><code>apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: read-nodes
subjects:
- kind: User
  name: bob
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: ClusterRole
  name: node-reader
  apiGroup: rbac.authorization.k8s.io
</code></pre>
<p>📌 Пользователь bob получает доступ на чтение нод <strong>во всём кластере</strong>.</p>
<hr />
<h5 id="rules">🧠 Что можно указывать в rules?</h5>
<pre><code>rules:
- apiGroups: [&quot;&quot;, &quot;apps&quot;, &quot;batch&quot;]
  resources: [&quot;pods&quot;, &quot;deployments&quot;, &quot;jobs&quot;]
  verbs: [&quot;get&quot;, &quot;list&quot;, &quot;watch&quot;, &quot;create&quot;, &quot;update&quot;, &quot;patch&quot;, &quot;delete&quot;]
</code></pre>
<p>• apiGroups: например, "" — core, "apps" — для deployments и т.д.</p>
<p>• resources: "pods", "services", "configmaps" и т.д.</p>
<p>• verbs: "get", "list", "create", "delete", "update", "patch"…</p>
<hr />
<p><strong>🔍 Проверка доступа</strong></p>
<p>Хочешь понять, имеет ли пользователь/сервис-аккаунт доступ?</p>
<pre><code>kubectl auth can-i get pods --as alice --namespace=dev
</code></pre>
<p>или для сервис-аккаунта:</p>
<pre><code>kubectl auth can-i create deployments --as=system:serviceaccount:dev:sa-name
</code></pre>
<hr />
<h5 id="rbac-">⚠️ RBAC и сервис-аккаунты</h5>
<p>Для pod’ов, которые взаимодействуют с Kubernetes API, используется сервис-аккаунт (SA).</p>
<p>📌 Назначение ClusterRole на SA:</p>
<pre><code>subjects:
- kind: ServiceAccount
  name: my-sa
  namespace: dev
</code></pre>
<p>🔐 Используется, например, для Prometheus, ArgoCD, Jenkins, etc.</p>
<hr />
<h4 id="_53"><strong>🎯 Частые паттерны:</strong></h4>
<p>• view, edit, admin — встроенные ClusterRole
• Least Privilege — даём <strong>только то, что нужно</strong>
• aggregated ClusterRole — сборка нескольких прав в одну роль
• Используй <strong>kubectl auth reconcile</strong> для безопасного обновления RBAC</p>
<h5 id="1-view-edit-admin">🔐 1. Предустановленные роли: view, edit, admin</h5>
<p>Kubernetes из коробки предоставляет несколько <strong>встроенных ClusterRole</strong>, которые ты можешь сразу привязать:</p>
<table>
<thead>
<tr>
<th><strong>Роль</strong></th>
<th><strong>Что умеет?</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>view</td>
<td>Только чтение (get, list, watch)</td>
</tr>
<tr>
<td>edit</td>
<td>Чтение и изменение всех ресурсов (кроме RBAC, NS, finalizers)</td>
</tr>
<tr>
<td>admin</td>
<td>Всё в пределах namespace, включая RBAC (но <strong>не ClusterRole</strong>)</td>
</tr>
</tbody>
</table>
<p><strong>Пример:</strong></p>
<pre><code>kind: RoleBinding
metadata:
  name: give-access
  namespace: dev
subjects:
- kind: User
  name: alice
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: ClusterRole
  name: view
  apiGroup: rbac.authorization.k8s.io
</code></pre>
<p>📌 Очень удобно давать людям или бэку доступ “на посмотреть”.</p>
<hr />
<h5 id="2-least-privilege">🧃 2. Least Privilege (минимально необходимые права)</h5>
<p>⚠️ <strong>Золотое правило безопасности</strong>: давай минимум, что нужно.</p>
<p>Никаких * в verbs, resources, apiGroups без острой необходимости!</p>
<p><strong>Плохой пример:</strong></p>
<pre><code>verbs: [&quot;*&quot;]
resources: [&quot;*&quot;]
apiGroups: [&quot;*&quot;]
</code></pre>
<p><strong>Хороший пример:</strong></p>
<pre><code>verbs: [&quot;get&quot;, &quot;list&quot;]
resources: [&quot;pods&quot;]
apiGroups: [&quot;&quot;]
</code></pre>
<p>📌 Принцип “чем меньше — тем лучше” особенно важен для сервис-аккаунтов CI/CD, мониторинга и автоматизации.</p>
<hr />
<h5 id="3-serviceaccount-rolebinding-pod">🧬 3. ServiceAccount + RoleBinding: доступ только Pod’ам</h5>
<p>Часто сервис в кластере (например, Prometheus, Argo, Karpenter) нуждается в доступе к API. Вместо привязки прав к пользователю — создаём <strong>ServiceAccount + RoleBinding</strong>.</p>
<pre><code>apiVersion: v1
kind: ServiceAccount
metadata:
  name: my-agent
  namespace: monitoring
</code></pre>
<pre><code>kind: RoleBinding
metadata:
  name: my-agent-binding
  namespace: monitoring
subjects:
- kind: ServiceAccount
  name: my-agent
  namespace: monitoring
roleRef:
  kind: Role
  name: pod-reader
  apiGroup: rbac.authorization.k8s.io
</code></pre>
<p>📌 Затем у pod’а в spec.serviceAccountName: my-agent.</p>
<hr />
<h5 id="4-aggregated-clusterroles">🧩 4. Aggregated ClusterRoles — комбинация нескольких</h5>
<p>Можно <strong>объединять несколько ClusterRole через метки</strong>, а не писать одну большую.</p>
<pre><code>apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: my-viewer
  labels:
    rbac.authorization.k8s.io/aggregate-to-view: &quot;true&quot;
rules:
- apiGroups: [&quot;batch&quot;]
  resources: [&quot;jobs&quot;]
  verbs: [&quot;get&quot;, &quot;list&quot;, &quot;watch&quot;]
</code></pre>
<p>Если в другом месте уже есть ClusterRole с меткой aggregate-to-view=true, то твоя роль <strong>автоматически добавится</strong>.</p>
<p>Используется во встроенных admin / edit / view.</p>
<hr />
<h5 id="5-dynamic-access-gitops">🧪 5. Dynamic access (например, через GitOps)</h5>
<p>Когда используешь ArgoCD, Flux или Helm — можно <strong>генерировать RBAC через шаблоны</strong> или Git-папки:</p>
<p>• Сервис argo-server использует SA с ClusterRole admin</p>
<p>• Helm chart устанавливает нужные Role/RoleBinding через values.yaml</p>
<hr />
<h5 id="6-namespace-rbac">📁 6. Мульти-Namespace RBAC</h5>
<p>Role работает только внутри одного NS. Чтобы дать доступ в несколько NS — <strong>используй ClusterRole + несколько RoleBinding</strong>:</p>
<pre><code># reusable ClusterRole
kind: ClusterRole
metadata:
  name: read-pods
rules:
- apiGroups: [&quot;&quot;]
  resources: [&quot;pods&quot;]
  verbs: [&quot;get&quot;, &quot;list&quot;]

# в dev
kind: RoleBinding
metadata:
  name: bind-in-dev
  namespace: dev
subjects:
- kind: User
  name: alice
roleRef:
  kind: ClusterRole
  name: read-pods

# в staging
kind: RoleBinding
metadata:
  name: bind-in-staging
  namespace: staging
subjects:
- kind: User
  name: alice
roleRef:
  kind: ClusterRole
  name: read-pods
</code></pre>
<hr />
<h5 id="_54">🧠 Финальные советы:</h5>
<p>• kubectl auth can-i — твой друг.</p>
<p>• Смотри kubectl describe rolebinding и clusterrolebinding — видно, кто к чему привязан.</p>
<p>• Всегда проверяй права через dry-run или в dev-NS.</p>
<p>• GitOps-friendly подход: все роли и биндинги — в yaml и под версионным контролем.</p>
<hr />
<h2 id="terraform">Terraform</h2>
<h3 id="ansible-terraform">Отличие ansible и terraform</h3>
<p><strong>Terraform</strong> - Предназначен для представления инфраструктуры как код и автоматизации ее развертывания.</p>
<p><strong>Ansible</strong> - Предназначен для автоматизации развертывания и конфигурации приложений.</p>
<p>То есть Terraform используется что бы разворачивать инфраструктуру (виртуальные машины, сети, диски, и тп.). Ansible предназначен для работы с существующими ресурсами, чтобы устанавливать и настраивать окружение (программы, операционные системы) на этих виртуалках.</p>
<p>Нюансы: Terraform отслеживает состояние и делает инкрементные изменения, что особенно полезно при работе с облачной инфраструктурой. Ansible не управляет состоянием, и каждая задача считается независимой.</p>
<p>Нужно понимать, что это инструменты. И в ряде случаев с помощью Ansible равзвернуть инфраструктуру всё таки можно. Как и для терраформа написать провайдер, который будет делать что-то свое. Вопрос лишь в применимости инструментов.</p>
<h4 id="terraform-state">Что такое Terraform state?</h4>
<p>• State-файл (terraform.tfstate) хранит текущее состояние инфраструктуры и сопоставляет описанные в HCL ресурсы с реальными объектами в облаке.</p>
<p>• Это позволяет Terraform определять, какие изменения нужно внести при terraform apply.</p>
<ol>
<li><strong>Где его хранят?</strong></li>
</ol>
<p>• <strong>Локально</strong> (terraform.tfstate в рабочей директории) → не подходит для командной работы.</p>
<p>• <strong>Удаленно</strong> (S3, GCS, Azure Blob, Terraform Cloud) → позволяет совместную работу и контроль версий.</p>
<ol>
<li><strong>Какие проблемы могут возникнуть?</strong></li>
</ol>
<p>• <strong>Конфликты при одновременной работе</strong> → решается блокировками (dynamodb для S3 backend).</p>
<p>• <strong>Компрометация чувствительных данных</strong> → решается с terraform state encrypt, terraform_remote_state, использование vault.</p>
<p>• <strong>Потеря state-файла</strong> → если удален без бэкапа, теряется возможность управлять ресурсами Terraform.
    • Если state <strong>удален</strong>, но инфраструктура еще есть → <strong>terraform import</strong> поможет.
    • Если state удален <strong>и инфраструктуры нет</strong> → <strong>потеряно безвозвратно</strong>.
    • <strong>Вывод:</strong> <strong>Обязательно настраивай бэкапы state-файлов!</strong> (S3 + DynamoDB, GCS, Azure Blob).</p>
<h4 id="terraform_1">Что такое провайдер в terraform</h4>
<p>Это утилита, прослойка, которая позволяет Terraform взаимодействовать с определенным API облачного провадйера.</p>
<p>Провайдеры используются для настройки и управления ресурсами, которые разворачиваются в облаке этого провайдера.</p>
<h3 id="terraform_2">Что такое ресурс в terraform</h3>
<p>Это какой то блок кода, который описывает объект в инфраструктуре. Каждый ресурс имеет свои какие то аргументы, свои параметры, свою конфигурацию. Ресурс имеет свой какой то уникальный идентификатор (ID, ARN и тд).</p>
<p>Виртуальная машина, сеть, диск, порт, балансировщик и тд.</p>
<h2 id="ansible">Ansible</h2>
<h3 id="ansible_1">Основные примитивы Ansible</h3>
<h4 id="inventory">Инвентарь (Inventory)</h4>
<ul>
<li>cписок хостов, может быть статичным в виде текcтового файла в формате <code>.ini</code> или динамическим в виде скрипта или плагина, который подгружает структуру данных из стороннего источника, например, Openstack API или база LDAP.</li>
</ul>
<pre><code>$ cat hosts
[web]
nginx01
nginx02
nginx03

[mysql]
mysql01
mysql02
mysql03

[prod:children]
web
mysql

[devel]
dev-nginx01
dev-mysql01
</code></pre>
<p>Данный пример описывает группы хостов web, mysql, prod и devel, группа prod наследует содержимое групп web и mysql.</p>
<h4 id="task">Задание (Task)</h4>
<ul>
<li>атомарная операция, выполняемая на управляемом хосте, например:</li>
</ul>
<pre><code class="language-yaml">apt:
package: nginx
state: present
</code></pre>
<p>Данный пример аналогичен команде <code>apt install nginx</code></p>
<h4 id="play-playbook">Сценарий (Play или Плейбук (Playbook)</h4>
<ul>
<li>сценарий или скрипт, содержащий одно или несколько заданий на выполнение, например:</li>
</ul>
<pre><code class="language-yaml">$ cat prod-playbook.yml
---
- hosts: nginx
tasks:
- apt:
    package: nginx
    state: present
- shell: whoami
</code></pre>
<h4 id="role">Роль (Role)</h4>
<ul>
<li>более сложная абстракция, выглядит как структура директорий и файлов, которые описывают набор дефолтных переменных, зависимостей от других ролей, может содержать файлы и темплейты, содержит задания(Tasks).</li>
</ul>
<h4 id="facts">Факты (Facts)</h4>
<ul>
<li>структура данных, которая содержит информацию о хосте, например, версию дистрибутива, IP адреса и файловые системы. Ansible забирает эту информацию с хоста, и на нее можно ссылаться в коде плейбуков и ролей.</li>
</ul>
<p>Сбор фактов хоста занимает некоторое время, поэтому их можно кэшировать или отключить их сбор при выполнении плейбука.</p>
<h3 id="ansible_2">Порядок приоритета переменных в Ansible</h3>
<p>В Ansible переменные можно задавать в разных местах: в инвентаре, в ролях, через <code>set_fact</code>, в playbook, через командную строку и т.д. Если одна и та же переменная определена в нескольких местах — Ansible использует <strong>значение с наивысшим приоритетом</strong>.</p>
<h4 id="_55">📊 Порядок от низшего к высшему:</h4>
<ol>
<li><strong><code>defaults</code> в ролях</strong> — значения по умолчанию (<code>roles/myrole/defaults/main.yml</code>)</li>
<li><strong>Инвентарь</strong>:</li>
<li>переменные в <code>inventory.ini</code> (<code>host var</code>, <code>group:vars</code>)</li>
<li><strong><code>group_vars/</code></strong> — переменные для групп</li>
<li><strong><code>host_vars/</code></strong> — переменные для конкретных хостов</li>
<li><strong><code>ansible_facts</code></strong> — автоматически собранные или заданы через <code>set_fact</code></li>
<li><strong><code>vars</code> в playbook</strong> — переменные внутри <code>vars:</code> блока</li>
<li><strong><code>vars</code> в task</strong> — локальные переменные в задаче</li>
<li><strong><code>register</code></strong> — результат выполнения задач</li>
<li><strong><code>--extra-vars</code></strong> — переменные из CLI (самый высокий приоритет)</li>
</ol>
<h4 id="_56">🧩 Примеры по уровням</h4>
<h5 id="1-defaults">1. <code>defaults</code> в ролях (самый низкий приоритет)</h5>
<pre><code class="language-yaml"># roles/myrole/defaults/main.yml
app_port: 5000
env: \&quot;dev\&quot;
</code></pre>
<h5 id="2_1">2. Инвентарь</h5>
<pre><code class="language-ini">[web]
web01 ansible_host=192.168.0.10 app_port=8081

[web:vars]
region=eu
</code></pre>
<h5 id="3-group_vars-host_vars">3. <code>group_vars/</code> и <code>host_vars/</code></h5>
<p>Файлы:</p>
<ul>
<li><code>group_vars/web.yml</code></li>
<li><code>host_vars/web01.yml</code></li>
</ul>
<p>Пример:</p>
<pre><code class="language-yaml"># group_vars/web.yml
app_port: 8080
env: \&quot;staging\&quot;
</code></pre>
<pre><code class="language-yaml"># host_vars/web01.yml
app_port: 9090
</code></pre>
<p>→ Значение из <code>host_vars</code> переопределит <code>group_vars</code>.</p>
<h5 id="4-ansible_facts-set_fact">4. <code>ansible_facts</code> (в том числе <code>set_fact</code>)</h5>
<pre><code class="language-yaml">- name: Set fact
  set_fact:
    app_port: 7070
</code></pre>
<h5 id="5-vars-playbook">5. <code>vars</code> в playbook</h5>
<pre><code class="language-yaml">- hosts: all
  vars:
    app_port: 6060
</code></pre>
<h5 id="6-vars-task">6. <code>vars</code> в task</h5>
<pre><code class="language-yaml">- name: Show port
  debug:
    msg: \&quot;Port is {{ app_port }}\&quot;
  vars:
    app_port: 5050
</code></pre>
<h5 id="7-register">7. <code>register</code></h5>
<pre><code class="language-yaml">- name: Get hostname
  command: hostname
  register: hostname_output
</code></pre>
<p>→ Используется как <code>{{ hostname_output.stdout }}</code>.</p>
<h5 id="8-extra-vars">8. <code>--extra-vars</code> (наивысший приоритет)</h5>
<pre><code class="language-bash">ansible-playbook site.yml --extra-vars \&quot;app_port=4040 env=prod\&quot;
</code></pre>
<h3 id="_57">🧠 Заключение</h3>
<p>Ansible позволяет гибко управлять переменными, и понимание порядка приоритетов критично для предсказуемости поведения плейбуков.</p>
<p><strong>Рекомендации:</strong></p>
<ul>
<li>Используй <code>defaults</code> в ролях для значений по умолчанию.</li>
<li>Задавай хост-специфичные данные в <code>host_vars/</code> и <code>group_vars/</code>.</li>
<li>Для временных и приоритетных значений — используй <code>--extra-vars</code>.</li>
</ul>
<hr />
<h3 id="handlers">Для чего нужны хендлеры, handlers?</h3>
<p>Задачу можно дополнить обработчиками, которые будут срабатывать, если задача была выполнена успешно.</p>
<p>Например, мы установили nginx и хотим его запустить</p>
<pre><code class="language-yaml">---
- hosts: testbox
  sudo: yes
  tasks:
   - name: Install Nginx
     yum: pkg=nginx state=latest
     notify:
         - NGINX start

  handlers:
    - name: NGINX start
      service: name=nginx state=started
</code></pre>
<h3 id="iac-and">IAC and Идемпотентность</h3>
<p><strong>Идемпотентность</strong> - это такая характеристика действия, согласно которой повторное выполнение этого действия будет давать тот же результат, что и первый запуск.</p>
<p>В контексте систем управления конфигурациями это означает, что сценарии, написанные с соблюдением такого подхода, не изменят, не сломают и не выдадут ошибок на управляемом хосте при повторном запуске.</p>
<p>Например, нам нужно добавить пользователя на хост, для bash это будет выглядеть так:</p>
<pre><code class="language-yaml">useradd newuser -ms /bin/bash
</code></pre>
<p>Но если мы запустим команду второй раз, то получим ошибку</p>
<pre><code class="language-yaml">useradd newuser -ms /bin/bash
useradd: user 'newuser' already exists
</code></pre>
<p>Поэтому нам нужно дополнительно добавлять проверку, например так:</p>
<pre><code class="language-yaml">id newuser || useradd newuser -ms /bin/bash
</code></pre>
<p>В случае Ansible мы только декларируем состояние, например:</p>
<pre><code class="language-yaml">- hosts: localhost
  gather_facts: no
  tasks:
    - user:
        name: newuser
        shell: /bin/bash
        state: present
</code></pre>
<p>При первом запуске плейбук Ansible ответит:</p>
<pre><code class="language-yaml">TASK [user] ***
changed: [localhost] =&gt; {
  &quot;ansible_facts&quot;: {
    &quot;discovered_interpreter_python&quot;: &quot;/usr/bin/python3&quot;
  },
  &quot;changed&quot;: true,
  &quot;comment&quot;: &quot;&quot;,
  &quot;create_home&quot;: true,
  &quot;group&quot;: 1001,
  &quot;home&quot;: &quot;/home/newuser&quot;,
  &quot;name&quot;: &quot;newuser&quot;,
  &quot;shell&quot;: &quot;/bin/bash&quot;,
  &quot;state&quot;: &quot;present&quot;,
  &quot;system&quot;: false,
  &quot;uid&quot;: 1001
}
</code></pre>
<p>При повторном:</p>
<pre><code class="language-yaml">TASK [user] ***
ok: [localhost] =&gt; {
  &quot;ansible_facts&quot;: {
    &quot;discovered_interpreter_python&quot;: &quot;/usr/bin/python3&quot;
  },
  &quot;append&quot;: false,
  &quot;changed&quot;: false,
  &quot;comment&quot;: &quot;&quot;,
  &quot;group&quot;: 1001,
  &quot;home&quot;: &quot;/home/newuser&quot;,
  &quot;move_home&quot;: false,
  &quot;name&quot;: &quot;newuser&quot;,
  &quot;shell&quot;: &quot;/bin/bash&quot;,
  &quot;state&quot;:
  &quot;present&quot;,
  &quot;uid&quot;: 1001
}
</code></pre>
<p>Обратите внимание, что статус задания сменился с <code>changed</code> на <code>ok</code> и повторный запуск вернул значение <code>"changed": false</code></p>
<p>Таким образом, сценарии, написанные с учетом идемпотентности, реализуют ту самую декларативность в описании состояния инфраструктуры, а инфраструктура соответствует состоянию, описанному в коде нашего скрипта.</p>
<p>Это и есть <strong>IaС - Infrastructure as Code - инфраструктура как код</strong></p>
<h3 id="ad-hoc-ansible">Для чего нужен ad hoc в ansible?</h3>
<p>Это режим работы ансибл когда запрос к серверу выполняется напрямую из командной строки, без создания дополнительных файлов.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>